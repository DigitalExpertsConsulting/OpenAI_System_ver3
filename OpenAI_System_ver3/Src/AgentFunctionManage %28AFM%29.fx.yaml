"'AgentFunctionManage (AFM)' As screen":
    Fill: =RGBA(245, 245, 245, 1)
    LoadingSpinner: =LoadingSpinner.Data
    LoadingSpinnerColor: =RGBA(105, 121, 126, 1)
    OnVisible: |
        =//============================== << Agent Function Manage 화면 접속 시 >> ==============================
        // 1. 로딩 이미지 활성화
        Concurrent(   
            UpdateContext({locLoadingSpinner:true}), // 로딩 스피너 이미지 비활성
            UpdateContext({locLoadingSpinnerBackground:true})); // 로딩 스피너 배경 이미지 비활성 );
            
        // 2. 초기화
        
        Concurrent(   
            Refresh(똑실이_AgentFunction_table​),//DB REFRESH
            
            UpdateContext({locAgentFunctionAddPopup:false}),// Agent 기능 추가 팝업 비활성화
            UpdateContext({locAgentFunctionDeletePopup:false}),// Agent 기능 삭제 팝업 비활성화
            UpdateContext({locPopupBackground:false}),// 팝업 배경 이미지 비활성화
            Set(gblSelectedAgentFunctionItemID,0), // gblSelectedAgentFunctionItemID 변수 초기화
            Clear(colAssignedTeamsInfo),// 컬렉션 초기화 (이전 컬렉션명 testDost) 
            Clear(colUserAssignedTeamsEmail)); // 컬렉션 초기화 (이전 컬렉션명 offGroe)
        
        // 3. 유저가 속한 Teams 이메일 컬렉션 생성 -> colUserAssignedTeamsEmail
        
        ForAll( // Teams 칼럼의 모든 그룹 정보를 colAssignedTeamsInfo 컬렉션에 할당
            똑실이_Category_table,
            Collect(
                colAssignedTeamsInfo,
                ThisRecord.Teams
            )
        );
        ForAll( // 사용자의 이메일이 그룹에 존제 시 그룹 이메일을 colUserAssignedTeamsEmail 컬렉션에 할당
            colAssignedTeamsInfo,
            If(
                CountRows(
                    Filter(
                        Office365그룹.ListGroupMembers(
                            Mid(
                                ThisRecord.Claims,
                                40
                            )
                        ).value,
                        User().Email in mail 
                    )
                ) > 0,
                Collect(
                    colUserAssignedTeamsEmail,
                    {Email: ThisRecord.Email}
                )
            )
        );
        Distinct( //colUserAssignedTeamsEmail 컬렉션 중복 제거
            colUserAssignedTeamsEmail,
            ThisRecord
        );
        
        
        
        
        
        //============================== << SuperAdmin 권한에 따라 카테고리 LV1 항목 분류 >> ==============================
        
        If( 
            User().Email in LookUp( 
                똑실이_SuperAdmin_table,
                User().Email in SuperUsers.Email
            ).SuperUsers.Email, // SuperAdmin 권한 확인
        
            // 1. SuperAdmin인 경우
        
            ClearCollect( 
                colAgentManageDistLV1,
                Distinct(
                    SortByColumns(
                        똑실이_Category_table,
                        "LV1Order",
                        SortOrder.Ascending
                    ),
                    Category_LV1
                )
            ); // 슈퍼 어드민에 본인 계정 정보가 있을 경우, 모든 카테고리 LV1 로드
            ClearCollect(
                colAgentManageLV1,
                RenameColumns(
                    colAgentManageDistLV1,
                    "Value",
                    "Category_LV1"
                )
            ); //칼럼명 Rename하여 colAgentManageLV1 컬렉션에 할당
            Collect(
                colAgentManageLV1,
                {Category_LV1: "전체"}
            ); //colAgentManageLV1 컬렉션에 전체 항목 추가
            ,
        
            // 2. SuperAdmin이 아닌 경우
        
            ClearCollect( //슈퍼 어드민에 본인 계정 정보가 없을 경우, 권한 있는 카테고리만 LV1 로드
                colAgentManageDistLV1,
                Distinct(
                    Filter(
                        똑실이_Category_table,
                        Office365사용자.MyProfile().Mail in Users.Email || LookUp(
                            Teams,
                            Email <> Blank()
                        ).Email in Filter(
                            colUserAssignedTeamsEmail,
                            Email <> ""
                        ).Email || LookUp(
                            colUserAssignedTeamsEmail,
                            Email <> Blank()
                        ).Email in Filter(
                            Teams,
                            Email <> ""
                        ).Email
                    ),
                    Category_LV1
                )
             ); //접근가능한 유저의 카테고리 LV1(중복 제거) colAgentManageDistLV1 컬렉션에 할당
            ClearCollect( 
                colAgentManageLV1,
                RenameColumns(
                    colAgentManageDistLV1,
                    "Value",
                    "Category_LV1"
                )
            ); //칼럼명 Rename하여 colAgentManageLV1 컬렉션에 할당
            Collect(
                colAgentManageLV1,
                {Category_LV1: "전체"}
            ); //colAgentManageLV1 컬렉션에 전체 항목 추가
            
        );
        
        //============================== << SuperAdmin 권한에 따라 카테고리 LV2 항목 분류 >> ==============================
        
        If(
            User().Email in LookUp(
                똑실이_SuperAdmin_table,
                User().Email in SuperUsers.Email
            ).SuperUsers.Email, // SuperAdmin 권한 확인
        
           // 1. SuperAdmin인 경우
        
            ClearCollect(
                colAgentManageDistLV2,
                Distinct(
                    SortByColumns(
                        똑실이_Category_table,
                        "ID",
                        SortOrder.Ascending
                    ),
                    Category_LV2
                )
            );// 슈퍼 어드민에 본인 계정 정보가 있을 경우, 모든 카테고리 LV2 로드
            ClearCollect(
                colAgentManageLV2,
                RenameColumns(
                    colAgentManageDistLV2,
                    "Value",
                    "Category_LV2"
                )
            );//칼럼명 Rename하여 colAgentManageLV2 컬렉션에 할당
            Collect(
                colAgentManageLV2,
                {Category_LV2: "전체"}
            );//colAgentManageLV2 컬렉션에 전체 항목 추가
            ,
        
            // 2. SuperAdmin이 아닌 경우
            
            ClearCollect( //슈퍼 어드민에 본인 계정 정보가 없을 경우, 권한 있는 카테고리만 LV2 로드
                colAgentManageDistLV2,
                Distinct(
                    Filter(
                        똑실이_Category_table,
                        Office365사용자.MyProfile().Mail in Users.Email || LookUp(
                            Teams,
                            Email <> Blank()
                        ).Email in Filter(
                            colUserAssignedTeamsEmail,
                            Email <> ""
                        ).Email || LookUp(
                            colUserAssignedTeamsEmail,
                            Email <> Blank()
                        ).Email in Filter(
                            Teams,
                            Email <> ""
                        ).Email
                    ),
                    Category_LV2
                )
            ); //접근가능한 유저의 카테고리 LV2(중복 제거) colAgentManageDistLV1 컬렉션에 할당    
            ClearCollect(
                colAgentManageLV2,
                RenameColumns(
                    colAgentManageDistLV2,
                    "Value",
                    "Category_LV2"
                )
            ); //칼럼명 Rename하여 colAgentManageLV2 컬렉션에 할당
            Collect(
                colAgentManageLV2,
                {Category_LV2: "전체"}
            ); //colAgentManageLV1 컬렉션에 전체 항목 추가
            
        );
        
        //============================== << Agent 기능 필터 초기화 및 로딩이미지 비활성화 >> ==============================
        
        Concurrent(
        
            Reset(TextInput_GalleryFilter_Name_AFM),  // 기능명 InputText 리셋(Agent 기능 필터)
            Reset(Dropdown_GalleryFilter_CategoryLV1_AFM),  // 카테고리lv1 Dropbox 리셋(Agent 기능 필터)
            Reset(Dropdown_GalleryFilter_CategoryLV2_AFM),  // 카테고리lv2 Dropbox 리셋(Agent 기능 필터)
            Reset(Dropdown_GalleryFilter_Type_AFM),  // 유형 Dropbox 리셋(Agent 기능 필터)
            Reset(Gallery_AgentFunction_AFM), // 겔러리 리셋
            UpdateContext({locLoadingSpinner:false}), // 로딩 스피너 이미지 비활성
            UpdateContext({locLoadingSpinnerBackground:false}); // 로딩 스피너 배경 이미지 비활성
           
        );

    Window_GalleryAgentFuntion_AFM As rectangle:
        BorderColor: =RGBA(112, 112, 112, 1)
        DisabledFill: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(255, 255, 255, 1)
        FocusedBorderThickness: =4
        Height: =752
        HoverFill: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(255, 255, 255, 1)
        Width: =1540
        X: =Window_GalleryFilter_AFM.X
        Y: =220
        ZIndex: =1

    Label_ScreenTitle_AFM As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        FontWeight: =FontWeight.Bold
        Height: =64
        Size: =30
        Text: ="Agent 기능 관리"
        Width: =691
        X: =329
        Y: =47
        ZIndex: =2

    "Gallery_AgentFunction_AFM As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
        BorderColor: =RGBA(166, 166, 166, 1)
        DelayItemLoading: =true
        Height: =659
        Items: |+
            =Search(   
                Search(               
                    Search(        
                        Search(   
                            Filter(똑실이_AgentFunction_table​, 
                                ThisRecord.Category_LV1 in colAgentManageLV1.Category_LV1 && 
                                ThisRecord.Category_LV2 in colAgentManageLV2.Category_LV2),
                        TextInput_GalleryFilter_Name_AFM.Text, "Name"), 
                    If(  //유형 드롭다운 필터
                    Dropdown_GalleryFilter_Type_AFM.SelectedText.Value = "전체", 
                    "",
                    Dropdown_GalleryFilter_Type_AFM.SelectedText.Value),
                    "Type"), 
                If(  // 카테고리 lv1 필터
                Dropdown_GalleryFilter_CategoryLV1_AFM.Selected.Category_LV1 = "전체",
                "",
                Dropdown_GalleryFilter_CategoryLV1_AFM.Selected.Category_LV1),
                "Category_LV1"),
            If(  // 카테고리 lv2 필터
            Dropdown_GalleryFilter_CategoryLV2_AFM.Selected.Category_LV2 = "전체",
            "",
            Dropdown_GalleryFilter_CategoryLV2_AFM.Selected.Category_LV2),
            "Category_LV2")
            
            
        Layout: =Layout.Vertical
        LoadingSpinnerColor: =RGBA(0, 18, 107, 1)
        ShowScrollbar: =false
        TemplatePadding: =0
        TemplateSize: =58
        Width: =1410
        WrapCount: =0
        X: =391
        Y: =291
        ZIndex: =3

        Separator_GalleryAGentFunction_AFM As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(219, 219, 219, 1)
            Height: =0
            OnSelect: =Select(Parent)
            Width: =1349
            X: =26
            Y: =59
            ZIndex: =1

        Label_GalleryAgentFunction_FunctionID_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            OnSelect: =Select(Parent)
            Size: =13
            Text: =ThisItem.Function_ID
            Width: =233
            X: =29
            Y: =10
            ZIndex: =2

        Label_GalleryAgentFunction_Category_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =Label_GalleryAgentFunction_FunctionID_AFM.Height
            OnSelect: =Select(Parent)
            Size: =13
            Text: =ThisItem.Category_LV1 & "  >  " & ThisItem.Category_LV2
            Width: =307
            X: =665
            Y: =Label_GalleryAgentFunction_FunctionID_AFM.Y
            ZIndex: =3

        Label_GalleryAgentFunction_Type_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =Label_GalleryAgentFunction_FunctionID_AFM.Height
            OnSelect: =Select(Parent)
            Size: =13
            Text: =ThisItem.Type
            Width: =205
            X: =1007
            Y: =Label_GalleryAgentFunction_FunctionID_AFM.Y
            ZIndex: =5

        Label_GalleryAgentFunction_Name_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =Label_GalleryAgentFunction_FunctionID_AFM.Height
            OnSelect: =Select(Parent)
            Size: =13
            Text: =ThisItem.Name
            Width: =307
            X: =339
            Y: =Label_GalleryAgentFunction_FunctionID_AFM.Y
            ZIndex: =11

        Image_CategroyRemarks_CategoryMenu_1 As image:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: |-
                =ColorValue("#FFFFFF")
            FocusedBorderThickness: =4
            Height: =32
            HoverBorderColor: |-
                =ColorValue("#D1D1D1")
            HoverFill: |-
                =ColorValue("#F5F5F5")
            Image: =Remarks
            OnSelect: |-
                =Set(gblSelectedAgentFunctionItemID,ThisItem.ID); //선택한 Agent 기능 ID값 gblSelectedAgentFunctionItemID 변수에 할당
                
                
                Navigate('AgentFunctionManageDetail (AFMD)')
            PaddingBottom: =3
            PaddingLeft: =3
            PaddingRight: =3
            PaddingTop: =3
            PressedBorderColor: |-
                =ColorValue("#D1D1D1")
            PressedFill: |-
                =ColorValue("#E0E0E0")
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Width: =32
            X: =1257
            Y: =10
            ZIndex: =12

        Icon_DeleteSubMenu_CategoryMenu_1 As image:
            BorderColor: =RGBA(224, 224, 224, 1)
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            DisplayMode: |-
                =If(Office365사용자.MyProfile().Mail in LookUp(똑실이_SuperAdmin_table,  Office365사용자.MyProfile().Mail in SuperUsers.Email).SuperUsers.Email, DisplayMode.Edit,
                If(Office365사용자.MyProfile().Mail in ThisItem.'만든 사람'.Email ,DisplayMode.Edit,
                DisplayMode.Disabled))
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =32
            HoverBorderColor: =RGBA(224, 224, 224, 1)
            HoverFill: |-
                =ColorValue("#F5F5F5")
            Image: =Delete
            OnSelect: |
                =Concurrent(
                    UpdateContext({locAgentFunctionDeletePopup:true}),// Agent 기능 삭제 팝업 활성화
                    UpdateContext({locPopupBackground:true}),// 팝업 배경 이미지 활성화
                    Set(gblSelectedAgentFunctionItemID,ThisItem.ID) //선택한 Agent 기능 ID값 gblSelectedAgentFunctionItemID 변수에 할당
                );
            PaddingBottom: =05
            PaddingLeft: =05
            PaddingRight: =05
            PaddingTop: =05
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: |-
                =ColorValue("#E0E0E0")
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Transparency: =If(Icon_DeleteSubMenu_CategoryMenu_1.DisplayMode = DisplayMode.Disabled,0.5,0)
            Width: =32
            X: =1321
            Y: =10
            ZIndex: =13

    Button_Refresh_AFM As button:
        BorderColor: |-
            =ColorValue("#D1D1D1")
        BorderThickness: =1
        Color: =RGBA(0, 0, 0, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: |-
            =ColorValue("#FFFFFF")
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FocusedBorderThickness: =2
        FontWeight: =FontWeight.Semibold
        HoverBorderColor: |-
            =ColorValue("#C7C7C7")
        HoverColor: |-
            =ColorValue("#242424")
        HoverFill: |-
            =ColorValue("#F5F5F5")
        OnSelect: |-
            =Concurrent(
                Refresh(똑실이_Agent_table),
                Refresh(똑실이_AgentFunction_table​),     //DB Refresh
                Set(gblSelectedAgentFunctionItemID,0)    // gblSelectedAgentFunctionItemID 변수 초기화
                );
        PaddingLeft: =30
        PressedBorderColor: |-
            =ColorValue("#B3B3B3")
        PressedColor: =Color.Black
        PressedFill: |-
            =ColorValue("#E0E0E0")
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Size: =11
        Text: ="새로고침"
        Width: =121
        X: =1746
        Y: =47
        ZIndex: =7

    New_Component_GNB_AFM As New_Component_GNB:
        ZIndex: =9

    Image_Refresh_AFM As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =20
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =TokenMenuRefresh
        OnSelect: =Select(Button_Refresh_AFM)
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =20
        X: =1763
        Y: =58
        ZIndex: =10

    Icon_AddAgentFunction_AFM As icon.AddLibrary:
        BorderColor: =RGBA(166, 166, 166, 1)
        Color: =RGBA(105, 121, 126, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =28
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.AddLibrary
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =23
        X: =980
        Y: =1008
        ZIndex: =21

    Button_AddAgentFunction_AFM As button:
        BorderColor: =RGBA(166, 166, 166, 1)
        BorderThickness: |
            =1
        Color: =RGBA(166, 166, 166, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: |-
            =ColorValue("#FFFFFF")
        DisabledFill: |-
            =ColorValue("#FFFFFF")
        Fill: =RGBA(0, 0, 0, 0)
        FocusedBorderColor: |-
            =ColorValue("#0F6CBD")
        FocusedBorderThickness: =2
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =56
        HoverBorderColor: =RGBA(128, 128, 128, 1)
        HoverColor: =RGBA(128, 128, 128, 1)
        HoverFill: =RGBA(166, 166, 166, 0.1)
        OnSelect: |-
            =Concurrent(
                UpdateContext({locAgentFunctionAddPopup:true}),// Agent 기능 추가 팝업 활성화
                UpdateContext({locPopupBackground:true})// Agent 기능 추가 팝업 배경 이미지 활성화
            );
        PressedBorderColor: =RGBA(74, 85, 88, 1)
        PressedColor: =RGBA(74, 85, 88, 1)
        PressedFill: =RGBA(166, 166, 166, 0.2)
        Size: =15
        Text: ="Agent 기능 추가"
        Width: =1540
        X: =327
        Y: =994
        ZIndex: =22

    testuser_erase As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Size: =13
        Text: |-
            =If( 
                User().Email in LookUp( 
                    똑실이_SuperAdmin_table,
                    User().Email in SuperUsers.Email
                ).SuperUsers.Email,"수퍼어드민","일반유저")
        X: =1570
        Y: =48
        ZIndex: =23

    Background_Popup_AFM As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledFill: =
        Fill: =RGBA(0, 0, 0, 0.2)
        FocusedBorderThickness: =4
        Height: =1080
        HoverFill: =
        OnSelect: =
        PressedFill: =
        Visible: =locPopupBackground
        Width: =1920
        ZIndex: =24

    GalleryHeader_AFM As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =27

        Label_GalleryHeader_FunctionID_AFM As label:
            Color: |-
                =ColorValue("#BDBDBD")
            DisabledColor: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Bold
            Height: =35
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =13
            Text: ="기능ID"
            Width: =80
            X: =418
            Y: =236
            ZIndex: =4

        Label_GalleryHeader_Type_AFM As label:
            Color: |-
                =ColorValue("#BDBDBD")
            DisabledColor: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Bold
            Height: =35
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =13
            Text: ="유형"
            Width: =109
            X: =1387
            Y: =Label_GalleryHeader_FunctionID_AFM.Y
            ZIndex: =5

        Label_GalleryHeader_Category_AFM As label:
            Align: =Align.Center
            Color: |-
                =ColorValue("#BDBDBD")
            DisabledColor: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Bold
            Height: =35
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =13
            Text: ="카테고리"
            Width: =82
            X: =1049
            Y: =Label_GalleryHeader_FunctionID_AFM.Y
            ZIndex: =6

        Separator_GalleryHeader_AFM As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            Height: =1
            OnSelect: =
            Width: =1401
            X: =401
            Y: =280
            ZIndex: =8

        Label_GalleryHeader_Name_AFM As label:
            Align: =Align.Center
            Color: |-
                =ColorValue("#BDBDBD")
            DisabledColor: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Bold
            Height: =Label_GalleryHeader_FunctionID_AFM.Height
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =13
            Text: ="기능명"
            Width: =82
            X: =721
            Y: =Label_GalleryHeader_FunctionID_AFM.Y
            ZIndex: =20

    GalleryFilter_AFM As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =27

        Window_GalleryFilter_AFM As rectangle:
            BorderColor: =RGBA(204, 204, 204, 1)
            BorderStyle: =BorderStyle.None
            DisabledFill: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =67
            HoverFill: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            Width: =1540
            X: =327
            Y: =129
            ZIndex: =11

        TextInput_GalleryFilter_Name_AFM As text:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(0, 0, 0, 1)
            Default: =""
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            FocusedBorderThickness: =4
            Height: =27
            HintText: ="기능명을 입력하세요."
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            PressedBorderColor: =RGBA(105, 121, 126, 1)
            PressedColor: =
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Tooltip: ="기능명을 입력해주세요"
            Width: =297
            X: =468
            Y: =148
            ZIndex: =12

        Label_GalleryFilter_Name_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =28
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: ="기능명"
            Width: =70
            X: =388
            Y: =148
            ZIndex: =13

        Label_GalleryFilter_Category_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =28
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: ="카테고리"
            Width: =90
            X: =813
            Y: =148
            ZIndex: =14

        Dropdown_GalleryFilter_CategoryLV1_AFM As dropdown:
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderThickness: =1
            ChevronBackground: =RGBA(255, 255, 255, 1)
            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
            ChevronFill: =RGBA(33, 33, 33, 1)
            ChevronHoverBackground: =RGBA(212, 212, 212, 1)
            ChevronHoverFill: =RGBA(33, 33, 33, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: ="전체"
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Font: =Font.'Segoe UI'
            Height: =27
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(212, 212, 212, 1)
            Items: =colAgentManageLV1
            OnChange: |-
                =If(!Dropdown_GalleryFilter_CategoryLV1_AFM.Selected.Category_LV1="전체",
                colAgentManageLV2
                ,
                
                //============================== << SuperAdmin 권한에 따라 카테고리 LV2 항목 분류 >> ==============================
                
                If(
                    User().Email in LookUp(
                        똑실이_SuperAdmin_table,
                        User().Email in SuperUsers.Email
                    ).SuperUsers.Email, // SuperAdmin 권한 확인
                
                   // 1. SuperAdmin인 경우
                
                    ClearCollect(
                        colAgentManageDistLV2_OnChange,
                        Distinct(
                            SortByColumns( Filter(
                                똑실이_Category_table,Category_LV1=Dropdown_GalleryFilter_CategoryLV1_AFM.Selected.Category_LV1),
                                "LV2Order",
                                SortOrder.Ascending
                            ),
                            Category_LV2
                        )
                    );// 슈퍼 어드민에 본인 계정 정보가 있을 경우, 모든 카테고리 LV2 로드
                    ClearCollect(
                        colAgentManageLV2_OnChange,
                        RenameColumns(
                            colAgentManageDistLV2_OnChange,
                            "Value",
                            "Category_LV2"
                        )
                    );//칼럼명 Rename하여 colAgentManageLV2 컬렉션에 할당
                    Collect(
                        colAgentManageLV2_OnChange,
                        {Category_LV2: "전체"}
                    );//colAgentManageLV2 컬렉션에 전체 항목 추가
                    ,
                
                    // 2. SuperAdmin이 아닌 경우
                    
                    ClearCollect( //슈퍼 어드민에 본인 계정 정보가 없을 경우, 권한 있는 카테고리만 LV2 로드
                        colAgentManageDistLV2_OnChange,
                        Distinct(
                            Filter(
                                똑실이_Category_table,
                                Category_LV1 = Dropdown_GalleryFilter_CategoryLV1_AFM.Selected.Category_LV1,
                                Office365사용자.MyProfile().Mail in Users.Email || LookUp(
                                    Teams,
                                    Email <> Blank()
                                ).Email in Filter(
                                    colUserAssignedTeamsEmail,
                                    Email <> ""
                                ).Email || LookUp(
                                    colUserAssignedTeamsEmail,
                                    Email <> Blank()
                                ).Email in Filter(
                                    Teams,
                                    Email <> ""
                                ).Email
                            ),
                            Category_LV2
                        )
                    ); //접근가능한 유저의 카테고리 LV2(중복 제거) colAgentManageDistLV1 컬렉션에 할당    
                    ClearCollect(
                        colAgentManageLV2_OnChange,
                        RenameColumns(
                            colAgentManageDistLV2_OnChange,
                            "Value",
                            "Category_LV2"
                        )
                    ); //칼럼명 Rename하여 colAgentManageLV2 컬렉션에 할당
                    Collect(
                        colAgentManageLV2_OnChange,
                        {Category_LV2: "전체"}
                    ); //colAgentManageLV1 컬렉션에 전체 항목 추가
                    
                ));
                
                //============================== << Agent 기능 필터 초기화 >> ==============================
                
                Reset(Dropdown_GalleryFilter_CategoryLV2_AFM);  // 카테고리lv2 Dropbox 리셋(Agent 기능 필터)
            PaddingBottom: =5
            PaddingLeft: =12
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(105, 121, 126, 1)
            SelectionFill: =RGBA(105, 121, 126, 1)
            Size: =13
            Tooltip: ="카테고리 LV1을 선택해주세요"
            Width: =240
            X: =916
            Y: =148
            ZIndex: =15

        Dropdown_GalleryFilter_CategoryLV2_AFM As dropdown:
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderThickness: =1
            ChevronBackground: =RGBA(255, 255, 255, 1)
            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
            ChevronFill: =RGBA(33, 33, 33, 1)
            ChevronHoverBackground: =RGBA(212, 212, 212, 1)
            ChevronHoverFill: =RGBA(33, 33, 33, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: ="전체"
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Font: =Font.'Segoe UI'
            Height: =27
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(212, 212, 212, 1)
            Items: |-
                =
                If(Dropdown_GalleryFilter_CategoryLV1_AFM.Selected.Category_LV1="전체",
                colAgentManageLV2
                ,
                colAgentManageLV2_OnChange
                )
            PaddingBottom: =5
            PaddingLeft: =12
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(105, 121, 126, 1)
            SelectionFill: =RGBA(105, 121, 126, 1)
            Size: =13
            Tooltip: ="카테고리 LV2을 선택해주세요"
            Width: =240
            X: =1213
            Y: =148
            ZIndex: =16

        "'Label_GalleryFilter_>_AFM' As label":
            Align: =Align.Center
            BorderColor: =RGBA(0, 18, 107, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Font: =Font.'Segoe UI'
            Height: =39
            PaddingLeft: =0
            PaddingRight: =0
            Text: =">"
            Width: =43
            X: =1165
            Y: =140
            ZIndex: =17

        Label_GalleryFilter_Type_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =28
            Text: ="유형"
            Width: =52
            X: =1493
            Y: =148
            ZIndex: =18

        Dropdown_GalleryFilter_Type_AFM As dropdown:
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderThickness: =1
            ChevronBackground: =RGBA(255, 255, 255, 1)
            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
            ChevronFill: =RGBA(33, 33, 33, 1)
            ChevronHoverBackground: =RGBA(212, 212, 212, 1)
            ChevronHoverFill: =RGBA(33, 33, 33, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: ="전체"
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Font: =Font.'Segoe UI'
            Height: =27
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(212, 212, 212, 1)
            Items: |-
                =["전체","deny", "const_text_data", "system_instruction", 
                "api_call", "document_search"]
            OnChange: |-
                =If(
                    User().Email in LookUp(
                        똑실이_SuperAdmin_table,
                        User().Email in SuperUsers.Email
                    ).SuperUsers.Email,
                
                    ClearCollect(
                        colCategoryLV2_FM,
                        {Value: "전체"},
                        If(
                        // 첫 번째 드롭다운이 "전체"일 때
                            Dropdown_GalleryFilter_Type_AFM.Selected.Value = "전체",
                            Distinct(
                                SortByColumns(
                                    똑실이_Category_table,
                                    "LV2Order",
                                    SortOrder.Ascending
                                ),
                                //Category_LV1 = Dropdown_SearchCategoryLV1_FM.Selected.Value
                                Category_LV2
                            ),
                        // 첫 번째 드롭다운이 특정 카테고리를 선택했을 때
                            Distinct(
                                Filter(
                                    SortByColumns(
                                        똑실이_Category_table,
                                        "LV2Order",
                                        SortOrder.Ascending
                                    ),
                                    Category_LV1 = Dropdown_GalleryFilter_Type_AFM.Selected.Value
                                ),
                                Category_LV2
                            )
                        )
                    ),
                    ClearCollect(
                        colCategoryLV2_FM,
                        {Value: "전체"},
                        If(
                        // 첫 번째 드롭다운이 "전체"일 때
                            Dropdown_GalleryFilter_Type_AFM.Selected.Value = "전체",
                            Distinct(
                                Filter(
                                    SortByColumns(
                                        똑실이_Category_table,
                                        "LV2Order",
                                        SortOrder.Ascending
                                    ),
                                    User().Email in Users.Email
                                //Category_LV1 = Dropdown_SearchCategoryLV1_FM.Selected.Value
                                ),
                                Category_LV2
                            ),
                        // 첫 번째 드롭다운이 특정 카테고리를 선택했을 때
                            Distinct(
                                Filter(
                                    Filter(
                                        SortByColumns(
                                            똑실이_Category_table,
                                            "LV2Order",
                                            SortOrder.Ascending
                                        ),
                                        Category_LV1 = Dropdown_GalleryFilter_Type_AFM.Selected.Value
                                    ),
                                    User().Email in Users.Email
                                ),
                                Category_LV2
                            )
                        )
                    )
                )
                
                
                /*// 해당 드롭다운이 바뀔 때, 선택한 카테고리 LV1에 따라 카테고리 LV2의 드롭다운 속 아이템을 바꿈
                
                ClearCollect(
                    colCategoryLV2_FM,
                    {Value: "전체"},
                    
                    If(
                        // 첫 번째 드롭다운이 "전체"일 때
                        Dropdown_SearchCategoryLV1_FM.Selected.Value = "전체",
                        Distinct(
                            SortByColumns(
                                똑실이_Category_table,
                                "LV2Order",
                                SortOrder.Ascending
                            ),
                            Category_LV2
                        ),
                
                        // 첫 번째 드롭다운이 특정 카테고리를 선택했을 때
                         Distinct(
                            Filter(
                                SortByColumns(
                                    똑실이_Category_table,
                                    "LV2Order",
                                    SortOrder.Ascending
                                ),
                                
                                Category_LV1 = Dropdown_SearchCategoryLV1_FM.Selected.Value 
                            ),
                            Category_LV2
                         )
                    )
                
                )*/
            PaddingBottom: =5
            PaddingLeft: =12
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(105, 121, 126, 1)
            SelectionFill: =RGBA(105, 121, 126, 1)
            Size: =13
            Tooltip: ="유형을 선택해주세요"
            Width: =240
            X: =1562
            Y: =148
            ZIndex: =19

    Background_LoadingSpinner_AFM As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledFill: =
        Fill: =RGBA(0, 0, 0, 0.2)
        FocusedBorderThickness: =4
        Height: =1080
        HoverFill: =
        PressedFill: =
        Visible: =locLoadingSpinnerBackground
        Width: =1620
        X: =300
        ZIndex: =51

    Image_LoadingSpinner_AFM As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: ='6-dots-rotate'
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Visible: =locLoadingSpinner
        X: =957
        Y: =454
        ZIndex: =52

    testuser_erase_1 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Size: =13
        Text: =gblSelectedAgentFunctionItemID
        X: =1369
        Y: =38
        ZIndex: =53

    Popup_AgentFunction_Delete_AFM As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =55

        Window_Button_PopupAgentFunctionDelete_AFM As button:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: |-
                =ColorValue("#FFFFFF")
            DisplayMode: =DisplayMode.View
            Fill: |-
                =ColorValue("#FFFFFF")
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =160
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: |-
                =ColorValue("#FFFFFF")
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: |-
                =ColorValue("#FFFFFF")
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Size: =15
            Text: =""
            Visible: =locAgentFunctionDeletePopup
            Width: =600
            X: =801
            Y: =428
            ZIndex: =25

        Button_PopupAgentFunctionDelete_Cancel_AFM As button:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            Color: |-
                =ColorValue("#242424")
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: |-
                =ColorValue("#FFFFFF")
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =32
            HoverBorderColor: |-
                =ColorValue("#C7C7C7")
            HoverColor: |-
                =ColorValue("#242424")
            HoverFill: |-
                =ColorValue("#F5F5F5")
            OnSelect: |-
                =Concurrent(
                    UpdateContext({locAgentFunctionDeletePopup:false}),// Agent 기능 삭제 팝업 비활성화
                    UpdateContext({locPopupBackground:false})// 팝업 배경 이미지 비활성화
                );
            PressedBorderColor: |-
                =ColorValue("#B3B3B3")
            PressedColor: |-
                =ColorValue("#242424")
            PressedFill: |-
                =ColorValue("#E0E0E0")
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Size: =11
            Text: ="취소"
            Visible: =locAgentFunctionDeletePopup
            Width: =50
            X: =1326
            Y: =532
            ZIndex: =26

        Label_PopupAgentFunctionDelete_TitleText_AFM As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =34
            Size: =16
            Text: ="삭제하시겠습니까?"
            Visible: =locAgentFunctionDeletePopup
            Width: =193
            X: =818
            Y: =449
            ZIndex: =27

        Label_PopupAgentFunctionDelete_SubTitleText_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =24
            Size: =10
            Text: ="삭제할 경우 해당 항목을 영구적으로 사용할 수 없습니다. 삭제하시겠습니까?"
            Visible: =locAgentFunctionDeletePopup
            Width: =562
            X: =820
            Y: =490
            ZIndex: =28

        Image_PopupAgentFunctionDelete_Cancel_AFM As image:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =20
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            Image: =Exit
            OnSelect: |-
                =Concurrent(
                    UpdateContext({locAgentFunctionDeletePopup:false}),// Agent 기능 삭제 팝업 비활성화
                    UpdateContext({locPopupBackground:false})// 팝업 배경 이미지 비활성화
                );
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =locAgentFunctionDeletePopup
            Width: =20
            X: =1358
            Y: =452
            ZIndex: =29

        Button_PopupAgentFunctionDelete_Delete_AFM As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: |-
                =ColorValue("#0F6CBD")
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =32
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: |-
                =ColorValue("#115EA3")
            OnSelect: |
                =RemoveIf(똑실이_AgentFunction_table​,ID=gblSelectedAgentFunctionItemID); // Agent 기능 삭제
                
                Refresh(똑실이_AgentFunction_table​); //DB Refresh
                
                Concurrent(
                    UpdateContext({locAgentFunctionDeletePopup:false}), // Agent 기능 삭제 팝업 비활성화
                    UpdateContext({locPopupBackground:false})// 팝업 배경 이미지 비활성화
                );
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: |-
                =ColorValue("#0C3B5E")
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Size: =11
            Text: ="삭제"
            Visible: =locAgentFunctionDeletePopup
            Width: =50
            X: =1268
            Y: =532
            ZIndex: =49

    Popup_AgentFunction_Add_AFM As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =55

        Window_PopupAgentFunctionAdd_AFM As button:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: |-
                =ColorValue("#FFFFFF")
            DisplayMode: =DisplayMode.View
            Fill: |-
                =ColorValue("#FFFFFF")
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =621
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: |-
                =ColorValue("#FFFFFF")
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: |-
                =ColorValue("#FFFFFF")
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Size: =15
            Text: =""
            Visible: =locAgentFunctionAddPopup
            Width: =1052
            X: =591
            Y: =271
            ZIndex: =30

        Window_PopupAgentFunctionAdd_Item_AFM As button:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            Color: =
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0,0,0,0)
            FocusedBorderColor: |-
                =ColorValue("#D1D1D1")
            FocusedBorderThickness: =1
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =339
            HoverBorderColor: |-
                =ColorValue("#D1D1D1")
            HoverColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            OnSelect: =
            PressedBorderColor: |-
                =ColorValue("#D1D1D1")
            PressedColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            Size: =11
            Text: =""
            Visible: =locAgentFunctionAddPopup
            Width: =838
            X: =681
            Y: =405
            ZIndex: =31

        Button_PopupAgentFunctionAdd_Cancel_AFM As button:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            Color: |-
                =ColorValue("#242424")
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: |-
                =ColorValue("#FFFFFF")
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =35
            HoverBorderColor: |-
                =ColorValue("#C7C7C7")
            HoverColor: |-
                =ColorValue("#242424")
            HoverFill: |-
                =ColorValue("#F5F5F5")
            OnSelect: |
                =
                // ========================= <<컨트롤 리셋 및 비활성화>> =========================
                
                Concurrent(
                    Reset(Dropdown_PopupAgentFunctionAdd_CategoryLV1_AFM);, // Agent 기능 추가 입력 컨트롤 리셋
                    Reset(Dropdown_PopupAgentFunctionAdd_CategoryLV2_AFM);,
                    Reset(Dropdown__PopupAgentFunctionAdd_Type_AFM);,
                    Reset(TextInput__PopupAgentFunctionAdd_FunctionID_AFM);,
                    Reset(TextInput_PopupAgentFunctionAdd_Name_AFM);,
                    Reset(TextInput_PopupAgentFunctionAdd_Description_AFM);,
                    Reset(TextInput_PopupAgentFunctionAdd_Config_AFM);,
                    UpdateContext({locAgentFunctionAddPopup:false}),// Agent 기능 추가 팝업 비활성화
                    UpdateContext({locPopupBackground:false})// Agent 기능 추가 팝업 배경 이미지 비활성화
                );
            PressedBorderColor: |-
                =ColorValue("#B3B3B3")
            PressedColor: |-
                =ColorValue("#242424")
            PressedFill: |-
                =ColorValue("#E0E0E0")
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Size: =11
            Text: ="취소"
            Visible: =locAgentFunctionAddPopup
            Width: =100
            X: =1419
            Y: =760
            ZIndex: =32

        Label_PopupAgentFunctionAdd_Title_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =57
            Size: =16
            Text: ="Agent 기능 추가"
            Visible: =locAgentFunctionAddPopup
            Width: =388
            X: =681
            Y: =342
            ZIndex: =33

        Label_PopupAgentFunctionAdd_Header_Category_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =33
            Size: =10
            Text: ="카테고리"
            Visible: =locAgentFunctionAddPopup
            Width: =90
            X: =784
            Y: =436
            ZIndex: =34

        Image_PopupAgentFunctionAdd_Delete_AFM As image:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =51
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            Image: =Exit
            OnSelect: |
                =
                // ========================= <<컨트롤 리셋 및 비활성화>> =========================
                
                Concurrent(
                    Reset(Dropdown_PopupAgentFunctionAdd_CategoryLV1_AFM);, // Agent 기능 추가 입력 컨트롤 리셋
                    Reset(Dropdown_PopupAgentFunctionAdd_CategoryLV2_AFM);,
                    Reset(Dropdown__PopupAgentFunctionAdd_Type_AFM);,
                    Reset(TextInput__PopupAgentFunctionAdd_FunctionID_AFM);,
                    Reset(TextInput_PopupAgentFunctionAdd_Name_AFM);,
                    Reset(TextInput_PopupAgentFunctionAdd_Description_AFM);,
                    Reset(TextInput_PopupAgentFunctionAdd_Config_AFM);,
                    UpdateContext({locAgentFunctionAddPopup:false}),// Agent 기능 추가 팝업 비활성화
                    UpdateContext({locPopupBackground:false})// Agent 기능 추가 팝업 배경 이미지 비활성화
                );
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =locAgentFunctionAddPopup
            Width: =40
            X: =1583
            Y: =284
            ZIndex: =35

        Label_PopupAgentFunctionAdd_Header_Type_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =33
            Size: =10
            Text: ="기능유형"
            Visible: =locAgentFunctionAddPopup
            Width: =90
            X: =784
            Y: =481
            ZIndex: =36

        Label_PopupAgentFunctionAdd_Header_FunctionID_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =33
            Size: =10
            Text: ="기능ID"
            Visible: =locAgentFunctionAddPopup
            Width: =90
            X: =784
            Y: =521
            ZIndex: =37

        Label_PopupAgentFunctionAdd_Header_Name_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =33
            Size: =10
            Text: ="기능명"
            Visible: =locAgentFunctionAddPopup
            Width: =90
            X: =784
            Y: =561
            ZIndex: =38

        Label_PopupAgentFunctionAdd_Header_Description_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =33
            Size: =10
            Text: ="기능설명"
            Visible: =locAgentFunctionAddPopup
            Width: =90
            X: =781
            Y: =604
            ZIndex: =39

        Label_PopupAgentFunctionAdd_Header_Config_AFM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =33
            Size: =10
            Text: ="Config"
            Visible: =locAgentFunctionAddPopup
            Width: =90
            X: =781
            Y: =650
            ZIndex: =40

        TextInput_PopupAgentFunctionAdd_Name_AFM As text:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            Color: =RGBA(0, 0, 0, 1)
            Default: =""
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            FocusedBorderThickness: =1.5
            Height: =27
            HintText: ="기능명을 입력하세요."
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            PressedBorderColor: =RGBA(105, 121, 126, 1)
            PressedColor: =
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Tooltip: ="기능명을 입력해주세요"
            Visible: =locAgentFunctionAddPopup
            Width: =297
            X: =875
            Y: =565
            ZIndex: =41

        Dropdown_PopupAgentFunctionAdd_CategoryLV1_AFM As dropdown:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            ChevronBackground: =RGBA(255, 255, 255, 1)
            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
            ChevronFill: =RGBA(33, 33, 33, 1)
            ChevronHoverBackground: =RGBA(212, 212, 212, 1)
            ChevronHoverFill: =RGBA(33, 33, 33, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: ="전체"
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            FocusedBorderThickness: =1.5
            Font: =Font.'Segoe UI'
            Height: =27
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(212, 212, 212, 1)
            Items: =colAgentManageLV1
            OnChange: |-
                =If(!Dropdown_PopupAgentFunctionAdd_CategoryLV1_AFM.Selected.Category_LV1="전체",
                colAgentManageLV2
                ,
                
                //============================== << SuperAdmin 권한에 따라 카테고리 LV2 항목 분류 >> ==============================
                
                If(
                    User().Email in LookUp(
                        똑실이_SuperAdmin_table,
                        User().Email in SuperUsers.Email
                    ).SuperUsers.Email, // SuperAdmin 권한 확인
                
                   // 1. SuperAdmin인 경우
                
                    ClearCollect(
                        colAgentManageDistLV2_OnChange,
                        Distinct(
                            SortByColumns( Filter(
                                똑실이_Category_table,Category_LV1=Dropdown_PopupAgentFunctionAdd_CategoryLV1_AFM.Selected.Category_LV1),
                                "LV2Order",
                                SortOrder.Ascending
                            ),
                            Category_LV2
                        )
                    );// 슈퍼 어드민에 본인 계정 정보가 있을 경우, 모든 카테고리 LV2 로드
                    ClearCollect(
                        colAgentManageLV2_OnChange,
                        RenameColumns(
                            colAgentManageDistLV2_OnChange,
                            "Value",
                            "Category_LV2"
                        )
                    );//칼럼명 Rename하여 colAgentManageLV2 컬렉션에 할당
                    Collect(
                        colAgentManageLV2_OnChange,
                        {Category_LV2: "전체"}
                    );//colAgentManageLV2 컬렉션에 전체 항목 추가
                    ,
                
                    // 2. SuperAdmin이 아닌 경우
                    
                    ClearCollect( //슈퍼 어드민에 본인 계정 정보가 없을 경우, 권한 있는 카테고리만 LV2 로드
                        colAgentManageDistLV2_OnChange,
                        Distinct(
                            Filter(
                                똑실이_Category_table,
                                Category_LV1 = Dropdown_PopupAgentFunctionAdd_CategoryLV1_AFM.Selected.Category_LV1,
                                Office365사용자.MyProfile().Mail in Users.Email || LookUp(
                                    Teams,
                                    Email <> Blank()
                                ).Email in Filter(
                                    colUserAssignedTeamsEmail,
                                    Email <> ""
                                ).Email || LookUp(
                                    colUserAssignedTeamsEmail,
                                    Email <> Blank()
                                ).Email in Filter(
                                    Teams,
                                    Email <> ""
                                ).Email
                            ),
                            Category_LV2
                        )
                    ); //접근가능한 유저의 카테고리 LV2(중복 제거) colAgentManageDistLV1 컬렉션에 할당    
                    ClearCollect(
                        colAgentManageLV2_OnChange,
                        RenameColumns(
                            colAgentManageDistLV2_OnChange,
                            "Value",
                            "Category_LV2"
                        )
                    ); //칼럼명 Rename하여 colAgentManageLV2 컬렉션에 할당
                    Collect(
                        colAgentManageLV2_OnChange,
                        {Category_LV2: "전체"}
                    ); //colAgentManageLV1 컬렉션에 전체 항목 추가
                    
                ));
                
                //============================== << Agent 기능 필터 초기화 >> ==============================
                
                Reset(Dropdown_PopupAgentFunctionAdd_CategoryLV2_AFM);  // 카테고리lv2 Dropbox 리셋(Agent 기능 필터)
            PaddingBottom: =5
            PaddingLeft: =12
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(105, 121, 126, 1)
            SelectionFill: =RGBA(105, 121, 126, 1)
            Size: =13
            Tooltip: ="카테고리 LV1을 선택해주세요"
            Visible: =locAgentFunctionAddPopup
            Width: =240
            X: =875
            Y: =440
            ZIndex: =42

        Dropdown_PopupAgentFunctionAdd_CategoryLV2_AFM As dropdown:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            ChevronBackground: =RGBA(255, 255, 255, 1)
            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
            ChevronFill: =RGBA(33, 33, 33, 1)
            ChevronHoverBackground: =RGBA(212, 212, 212, 1)
            ChevronHoverFill: =RGBA(33, 33, 33, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: ="전체"
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            FocusedBorderThickness: =1.5
            Font: =Font.'Segoe UI'
            Height: =27
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(212, 212, 212, 1)
            Items: |-
                =
                If(Dropdown_PopupAgentFunctionAdd_CategoryLV1_AFM.Selected.Category_LV1="전체",
                colAgentManageLV2
                ,
                colAgentManageLV2_OnChange
                )
            PaddingBottom: =5
            PaddingLeft: =12
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(105, 121, 126, 1)
            SelectionFill: =RGBA(105, 121, 126, 1)
            Size: =13
            Tooltip: ="카테고리 LV2을 선택해주세요"
            Visible: =locAgentFunctionAddPopup
            Width: =240
            X: =1164
            Y: =440
            ZIndex: =43

        Dropdown__PopupAgentFunctionAdd_Type_AFM As dropdown:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            ChevronBackground: =RGBA(255, 255, 255, 1)
            ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
            ChevronDisabledFill: =RGBA(166, 166, 166, 1)
            ChevronFill: =RGBA(33, 33, 33, 1)
            ChevronHoverBackground: =RGBA(212, 212, 212, 1)
            ChevronHoverFill: =RGBA(33, 33, 33, 1)
            Color: =RGBA(51, 51, 51, 1)
            Default: ="전체"
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            FocusedBorderThickness: =1.5
            Font: =Font.'Segoe UI'
            Height: =27
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(212, 212, 212, 1)
            Items: |-
                =["전체","deny", "const_text_data", "system_instruction", 
                "api_call", "document_search"]
            OnChange: |-
                =If(
                    User().Email in LookUp(
                        똑실이_SuperAdmin_table,
                        User().Email in SuperUsers.Email
                    ).SuperUsers.Email,
                
                    ClearCollect(
                        colCategoryLV2_FM,
                        {Value: "전체"},
                        If(
                        // 첫 번째 드롭다운이 "전체"일 때
                            Dropdown__PopupAgentFunctionAdd_Type_AFM.Selected.Value = "전체",
                            Distinct(
                                SortByColumns(
                                    똑실이_Category_table,
                                    "LV2Order",
                                    SortOrder.Ascending
                                ),
                                //Category_LV1 = Dropdown_SearchCategoryLV1_FM.Selected.Value
                                Category_LV2
                            ),
                        // 첫 번째 드롭다운이 특정 카테고리를 선택했을 때
                            Distinct(
                                Filter(
                                    SortByColumns(
                                        똑실이_Category_table,
                                        "LV2Order",
                                        SortOrder.Ascending
                                    ),
                                    Category_LV1 = Dropdown__PopupAgentFunctionAdd_Type_AFM.Selected.Value
                                ),
                                Category_LV2
                            )
                        )
                    ),
                    ClearCollect(
                        colCategoryLV2_FM,
                        {Value: "전체"},
                        If(
                        // 첫 번째 드롭다운이 "전체"일 때
                            Dropdown__PopupAgentFunctionAdd_Type_AFM.Selected.Value = "전체",
                            Distinct(
                                Filter(
                                    SortByColumns(
                                        똑실이_Category_table,
                                        "LV2Order",
                                        SortOrder.Ascending
                                    ),
                                    User().Email in Users.Email
                                //Category_LV1 = Dropdown_SearchCategoryLV1_FM.Selected.Value
                                ),
                                Category_LV2
                            ),
                        // 첫 번째 드롭다운이 특정 카테고리를 선택했을 때
                            Distinct(
                                Filter(
                                    Filter(
                                        SortByColumns(
                                            똑실이_Category_table,
                                            "LV2Order",
                                            SortOrder.Ascending
                                        ),
                                        Category_LV1 = Dropdown__PopupAgentFunctionAdd_Type_AFM.Selected.Value
                                    ),
                                    User().Email in Users.Email
                                ),
                                Category_LV2
                            )
                        )
                    )
                )
                
                
                /*// 해당 드롭다운이 바뀔 때, 선택한 카테고리 LV1에 따라 카테고리 LV2의 드롭다운 속 아이템을 바꿈
                
                ClearCollect(
                    colCategoryLV2_FM,
                    {Value: "전체"},
                    
                    If(
                        // 첫 번째 드롭다운이 "전체"일 때
                        Dropdown_SearchCategoryLV1_FM.Selected.Value = "전체",
                        Distinct(
                            SortByColumns(
                                똑실이_Category_table,
                                "LV2Order",
                                SortOrder.Ascending
                            ),
                            Category_LV2
                        ),
                
                        // 첫 번째 드롭다운이 특정 카테고리를 선택했을 때
                         Distinct(
                            Filter(
                                SortByColumns(
                                    똑실이_Category_table,
                                    "LV2Order",
                                    SortOrder.Ascending
                                ),
                                
                                Category_LV1 = Dropdown_SearchCategoryLV1_FM.Selected.Value 
                            ),
                            Category_LV2
                         )
                    )
                
                )*/
            PaddingBottom: =5
            PaddingLeft: =12
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(105, 121, 126, 1)
            SelectionFill: =RGBA(105, 121, 126, 1)
            Size: =13
            Tooltip: ="유형을 선택해주세요"
            Visible: =locAgentFunctionAddPopup
            Width: =240
            X: =875
            Y: =483
            ZIndex: =44

        "'Label_PopupAgentFunctionAdd__>_AFM' As label":
            Align: =Align.Center
            BorderColor: =RGBA(0, 18, 107, 1)
            BorderStyle: =BorderStyle.None
            BorderThickness: =1
            Color: =RGBA(0, 0, 0, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =1.5
            Font: =Font.'Segoe UI'
            Height: =39
            PaddingLeft: =0
            PaddingRight: =0
            Text: =">"
            Visible: =locAgentFunctionAddPopup
            Width: =43
            X: =1117
            Y: =436
            ZIndex: =45

        TextInput__PopupAgentFunctionAdd_FunctionID_AFM As text:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            Color: =RGBA(0, 0, 0, 1)
            Default: =""
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            FocusedBorderThickness: =1.5
            Height: =27
            HintText: ="기능ID를 입력하세요."
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            PressedBorderColor: =RGBA(105, 121, 126, 1)
            PressedColor: =
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Tooltip: ="기능ID를 입력하세요."
            Visible: =locAgentFunctionAddPopup
            Width: =297
            X: =875
            Y: =524
            ZIndex: =46

        TextInput_PopupAgentFunctionAdd_Description_AFM As text:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            Color: =RGBA(0, 0, 0, 1)
            Default: =""
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            FocusedBorderThickness: =1.5
            Height: =27
            HintText: ="기능설명을 입력하세요."
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            PressedBorderColor: =RGBA(105, 121, 126, 1)
            PressedColor: =
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Tooltip: ="기능설명을 입력하세요."
            Visible: =locAgentFunctionAddPopup
            Width: =297
            X: =875
            Y: =606
            ZIndex: =47

        TextInput_PopupAgentFunctionAdd_Config_AFM As text:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            Color: =RGBA(0, 0, 0, 1)
            Default: =""
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            FocusedBorderThickness: =1.5
            Height: =71
            HintText: ="Config 텍스트를 입력해주세요"
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            Mode: =TextMode.MultiLine
            PressedBorderColor: =RGBA(105, 121, 126, 1)
            PressedColor: =
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Tooltip: ="Config 텍스트를 입력해주세요"
            Visible: =locAgentFunctionAddPopup
            Width: =532
            X: =875
            Y: =649
            ZIndex: =48

        Button_PopupAgentFunctionAdd_Add_AFM As button:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: |-
                =ColorValue("#0F6CBD")
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =35
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: |-
                =ColorValue("#115EA3")
            OnSelect: |+
                =
                
                // ========================= << Agent 기능 추가 >> =========================
                
                If(
                    // 조건1: 모든 항목이 비어있지 않음
                    !IsBlank(Dropdown_PopupAgentFunctionAdd_CategoryLV1_AFM.Selected.Category_LV1)&&
                    !IsBlank(Dropdown_PopupAgentFunctionAdd_CategoryLV2_AFM.Selected.Category_LV2)&&
                    !IsBlank(Dropdown__PopupAgentFunctionAdd_Type_AFM.Selected.Value)&&
                    !IsBlank(TextInput__PopupAgentFunctionAdd_FunctionID_AFM.Text)&&
                    !IsBlank(TextInput_PopupAgentFunctionAdd_Name_AFM.Text)&&
                    !IsBlank(TextInput_PopupAgentFunctionAdd_Description_AFM.Text)&&
                    !IsBlank(TextInput_PopupAgentFunctionAdd_Config_AFM.Text)&&
                
                    // 조건2: 드롭다운 컨트롤 값이 "전체"가 아님
                    And(Dropdown_PopupAgentFunctionAdd_CategoryLV1_AFM.Selected.Category_LV1<>"전체",
                    Dropdown_PopupAgentFunctionAdd_CategoryLV2_AFM.Selected.Category_LV2<>"전체",
                    Dropdown__PopupAgentFunctionAdd_Type_AFM.Selected.Value<>"전체")
                    ,
                    
                    // 조건을 모두 만족할 경우  
                    Patch(똑실이_AgentFunction_table​, 
                        {
                        제목:"""""",
                        Category_LV1:Dropdown_PopupAgentFunctionAdd_CategoryLV1_AFM.Selected.Category_LV1,
                        Category_LV2:Dropdown_PopupAgentFunctionAdd_CategoryLV2_AFM.Selected.Category_LV2,
                        Type:Dropdown__PopupAgentFunctionAdd_Type_AFM.Selected.Value,
                        Function_ID:TextInput__PopupAgentFunctionAdd_FunctionID_AFM.Text,
                        Name:TextInput_PopupAgentFunctionAdd_Name_AFM.Text,
                        Description:TextInput_PopupAgentFunctionAdd_Description_AFM.Text,
                        Config:TextInput_PopupAgentFunctionAdd_Config_AFM.Text
                        }
                    );
                    
                    // ============== 패치 후 컨트롤 리셋 및 팝업 창 비활성화 ==================
                
                    Concurrent(
                        Reset(Dropdown_PopupAgentFunctionAdd_CategoryLV1_AFM);, // Agent 기능 추가 입력 컨트롤 리셋
                        Reset(Dropdown_PopupAgentFunctionAdd_CategoryLV2_AFM);,
                        Reset(Dropdown__PopupAgentFunctionAdd_Type_AFM);,
                        Reset(TextInput__PopupAgentFunctionAdd_FunctionID_AFM);,
                        Reset(TextInput_PopupAgentFunctionAdd_Name_AFM);,
                        Reset(TextInput_PopupAgentFunctionAdd_Description_AFM);,
                        Reset(TextInput_PopupAgentFunctionAdd_Config_AFM);,
                        UpdateContext({locAgentFunctionAddPopup:false}),// Agent 기능 추가 팝업 비활성화
                        UpdateContext({locPopupBackground:false})// Agent 기능 추가 팝업 배경 이미지 비활성화
                    );
                ,
                
                    // 조건을 모두 만족하지 않을 경우 안내 문구 출력
                    Notify("비어있는 항목 또는 선택하지 않은 항목이 존재합니다.",NotificationType.Error)
                    
                );
                
                
                Refresh(똑실이_AgentFunction_table​); //DB Refresh
                
                
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: |-
                =ColorValue("#0C3B5E")
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Size: =11
            Text: ="추가"
            Tooltip: ="버튼 클릭 시 입력하신 Agent 기능이 추가됩니다"
            Visible: =locAgentFunctionAddPopup
            Width: =100
            X: =1308
            Y: =760
            ZIndex: =50

