CategoryMenu As screen:
    BackgroundImage: =                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
    Fill: =RGBA(245, 245, 245, 1)
    LoadingSpinnerColor: =RGBA(105, 121, 126, 1)
    OnVisible: |-
        =
        ForAll(
            Sequence(CountRows(Filter(Category_table, IsNumeric(LV1) || IsBlank(LV1)))),
            Remove(Category_table, First(Filter(Category_table, IsNumeric(LV1) || IsBlank(LV1))))
        );
        ForAll(
            Sequence(CountRows(Filter(Category_table, IsNumeric(제목) || IsBlank(제목)))),
            Remove(Category_table, First(Filter(Category_table, IsNumeric(제목) || IsBlank(제목))))
        );
        
           Sequence(CountRows(Filter(Category_table, IsNumeric(LV1) || IsBlank(LV1))));
            Sequence(CountRows(Filter(Category_table, IsNumeric(제목) || IsBlank(제목))));
        
        Refresh(Category_table);
        UpdateContext({testHight:CountRows(
            ForAll(Distinct(SortByColumns(Filter(Category_table, LV1<>Blank()), "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
        ) * 80});
        
        Concurrent(
        Set(ZoomLV1, "");,
        Set(testVisible, "");,
        Set(SelectedLV1, "");,
        Set(SelectedLV2, "");,
        ClearCollect(CategoryMenuCollect, ShowColumns(Category_table,"Title","OData__x004c_V1","LV1Order","LV2Order","Users","ID","Department","Team_ID"));,
        
        //Clear(CategoryMenuCollect);
        
        ClearCollect(
            Namelist,
            Filter(
                Office365사용자.SearchUser(
                    {
                        searchTerm: TextInput_AddUserSearch_CategoryMenu.Text,
                        top: 999
                    }
                ),
                AccountEnabled = true
            )
        );,
        
        ClearCollect(
            Departmentlist,
            Distinct(
                ShowColumns(
                    'Office365사용자'.SearchUser(
                        {
                            searchTerm2: TextInput_ShearchTeam_CategoryMenu.Text,
                            top: 999
                        }
                    )
                    ,
                    "Department"
                ),
                Department
            )
        );
        );
        UpdateContext({LV01_Category:""});
        UpdateContext({LV02_Category:""});
        //Refresh(Category_table);

    Rectangle_CategoryMenuBody_CategoryMenu As rectangle:
        BorderColor: =RGBA(112, 112, 112, 1)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledFill: =RGBA(0, 0, 0, 0)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =674
        HoverFill: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =Parent.Width - New_Component_GNB_CategoryMenu.Width - 104
        X: =New_Component_GNB_CategoryMenu.Width + 56
        Y: =350
        ZIndex: =2

    Label_CategoryMenuTitle_CategoryMenu As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        FontWeight: =FontWeight.Bold
        Height: =64
        Size: =30
        Text: ="카테고리 관리"
        Width: =393
        X: =343
        Y: =23
        ZIndex: =3

    Label_MemberAddCompleteName_CategoryMenu As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: =Last(Filter(MyPeople,DisplayName = DisplayName,DisplayName)).DisplayName
        Visible: |-
            =If(
                TextInput_AddUserSearch_CategoryMenu.Visible = true,
                true,
                false
            )
        Width: =81
        X: =965
        Y: =685
        ZIndex: =4

    Label_MemberAddComplete_CategoryMenu As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: ="님 추가 완료"
        Visible: |-
            =If(
                Label_MemberAddCompleteName_CategoryMenu.Visible = true 
            && !IsBlank(Last(Filter(MyPeople, DisplayName = DisplayName, DisplayName)).DisplayName),
                true,
                false
            )
        X: =Label_MemberAddCompleteName_CategoryMenu.X + 70
        Y: =Label_MemberAddCompleteName_CategoryMenu.Y
        ZIndex: =5

    Button_ViewTeamMembers_CategoryMenu As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(105, 121, 126, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
        OnSelect: |
            =Clear(
                        LookUp(
                        CategoryMenuCollect,
                        ID = CheckedID,
                        Department
                    )
                );
            
            Set(Ok, false);
            Set(AddTeamPopup, false);
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =15
        Text: ="확인"
        Visible: =Ok
        X: =854
        Y: =723
        ZIndex: =6

    Button_CategoryMenuSAVEPatch_CategoryMenu As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: |-
            =ColorValue("#0F6CBD")
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FocusedBorderThickness: =2
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: |-
            =ColorValue("#115EA3")
        OnSelect: |-
            =Patch(
                Category_table,
                CategoryMenuCollect
            );
            Notify(
                    "저장완료.",
                    NotificationType.Success,
                    1000
                );
            
            
            ClearCollect(CategoryMenuCollect, ShowColumns(Category_table,"Title","OData__x004c_V1","LV1Order","LV2Order","Users","ID","Department","Team_ID"));
            
            UpdateContext({ testHight:
                CountRows(
                ForAll(Distinct(SortByColumns(Category_table, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
            ) * 80 });
            //Select(TextInput4)
            Set(ZoomLV1, "");
            Set(testVisible, "");
            Set(SelectedLV1, "");
            Set(SelectedLV2, "");
            
            
            ClearCollect(testPA3, AddColumns(Filter(문서, 이름 in Category_table.제목), "Test",LookUp(Category_table, 제목=이름, LookUp(Category_table, 제목= 이름).Users)));
            ClearCollect(test11, {ID:Blank(), User:Blank(), LV2:Blank() });
            Clear(test11);
            
            ClearCollect(test11, ForAll(
              testPA3,
              {
                ID: ID,
                User: LookUp(Category_table, 제목 = testPA3[@이름], Users).Email,
                LV2: 이름
              }
            ));
            
            
            '똑실이-폴더별액세스권한부여'.Run("[" & Concat(test11, "{'ID':'" & ID & "','User':" & JSON(User, JSONFormat.IncludeBinaryData) & ",'LV2':'" & LV2 &"'}" , ",") & "]");
            
            '똑실이-카테고리추가시폴더생성'.Run(LV01_Category, LV02_Category);
            
            UpdateContext({LV01_Category:""});
            UpdateContext({LV02_Category:""});
            
            
            '똑실이-폴더별액세스권한삭제'.Run("[" & Concat(RemoveUserCollection, "{'LV01_Category':'" & LV01_Category & "','LV02_Category':'" & LV02_Category & "','Name':'" & Name & "','Email':'" & Email & "'}" , ",") & "]");
            Clear(RemoveUserCollection);
        PaddingLeft: =40
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: |-
            =ColorValue("#0C3B5E")
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Size: =14
        Text: ="저장"
        Width: =121
        X: =1759
        Y: =41
        ZIndex: =7

    Image_CategoryMenuSAVEPatch_CategoryMenu As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =30
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =IconSave
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =30
        X: =1774
        Y: =45
        ZIndex: =8

    Gallery_Main_CategoryMenu As gallery.variableTemplateHeightGallery:
        BorderColor: =RGBA(166, 166, 166, 1)
        Height: |-
            =If(
                testHight >= 690,
                650,
                testHight
            )//635
        Items: |-
            =ForAll(Distinct(SortByColumns(Category_table, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
            //SortByColumns(GNB_MENU, "LV1Order", Ascending)
        Layout: =Layout.Vertical
        OnSelect: |-
            =Set(SelectedLV2,"");
            Set(SelectedLV1, ThisItem.Result);
            
            If(ThisItem.Result=SelectedLV1, //Checkbox1.Value,
            Set(CheckedLV1, ThisItem.Result);
            Set(CheckedLV1Order, LookUp(Category_table, LV1=ThisItem.Result, LV1Order));
            Set(CheckedID, LookUp(Category_table, LV1=ThisItem.Result, ID));,
            
            Set(CheckedLV1, Blank());
            Set(CheckedLV2, Blank());
            Set(CheckedLV1Order, Blank());
            Set(CheckedLV2Order, Blank());
            Set(CheckedID, Blank());
            );
            
            Set(FirstLV1Order, First(SortByColumns(Category_table,"LV1Order")).LV1Order);
            Set(PrevLV1Order, CheckedLV1Order-1);
            Set(NextLV1Order, CheckedLV1Order+1);
            Set(LastLV1Order, Last(SortByColumns(Category_table,"LV1Order")).LV1Order);
            Set(BlankLV1Order, LastLV1Order +1);
        ShowScrollbar: =false
        TemplatePadding: =15
        TemplateSize: =1000
        Width: =Rectangle_CategoryMenuBody_CategoryMenu.Width
        X: =361
        Y: =372
        ZIndex: =9

        Button_BackgroundGallery_CategoryMenu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =Color.White
            DisabledFill: |-
                =ColorValue("#FFFFFF")
            DisplayMode: =DisplayMode.Disabled
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =70
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: =Select(Parent)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =010
            RadiusBottomRight: =010
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="버튼"
            Visible: =Gallery_Sub_CategoryMenu.Visible
            Width: =Gallery_Sub_CategoryMenu.Width -2
            X: =Gallery_Sub_CategoryMenu.X +1
            Y: =Gallery_Sub_CategoryMenu.Y +Gallery_Sub_CategoryMenu.Height
            ZIndex: =1

        Button_SubAddMainMenu_CategoryMenu As button:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            Color: =Color.Black
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: |-
                =ColorValue("#FFFFFF")
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: |-
                =ColorValue("#D1D1D1")
            HoverColor: =Color.Black
            HoverFill: |-
                =ColorValue("#F5F5F5")
            OnSelect: |-
                =//Set(LastLV2Order, Last(SortByColumns(Category_table,"LV2Order", SortOrder.Ascending)).LV2Order);
                Set(LastLV2Order, Last(Filter(Category_table,LV1=ThisItem.Result)).LV2Order);
                
                If(
                    IsBlank(LastLV2Order),
                    Set(LastLV2Order, 0)
                );
                Set(SelectedLV1, ThisItem.Result);
                
                Patch(
                    Category_table, 
                    Defaults(Category_table), 
                    { 제목:LastLV2Order+1, LV1:ZoomLV1, LV1Order:LookUp(Category_table,LV1=ZoomLV1,LV1Order), LV2Order:LastLV2Order+1 }
                );
                
                ClearCollect(
                    CategoryMenuCollect,
                    ShowColumns(
                        SortByColumns(Category_table, "LV1Order", SortOrder.Ascending),
                        "Title",
                        "OData__x004c_V1",
                        "LV1Order",
                        "LV2Order",
                        "Department",
                        "ID",
                        "Users" // 06-23 추가(상의 필요)
                    )
                );
                
                /*UpdateContext({ testHight:
                    CountRows(
                    ForAll(Distinct(SortByColumns(Category_table, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                ) * 80 });*/
                If(testVisible="",
                If(ThisItem.IsSelected, UpdateContext({ testHight: 
                CountRows(
                    ForAll(Distinct(SortByColumns(Category_table, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                ) * 80})),
                
                UpdateContext({ testHight:
                    CountRows(
                        ForAll(Distinct(SortByColumns(Category_table, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                    ) * 80 + 
                    CountRows(
                        Filter(
                            Category_table, LV1=ZoomLV1
                        )
                    ) * 80 + 75}));
                //Select(TextInput4)
                
                
                /*Concurrent(
                Set(ZoomLV1, "");,
                Set(testVisible, "");,
                Set(SelectedLV1, "");,
                Set(SelectedLV2, "");
                );*/
                Refresh(Category_table);
                Set(LastLV1Order, Last(SortByColumns(Category_table,"LV1Order")).LV1Order);
            PressedBorderColor: |-
                =ColorValue("#D1D1D1")
            PressedColor: =Color.Black
            PressedFill: |-
                =ColorValue("#E0E0E0")
            RadiusBottomLeft: =010
            RadiusBottomRight: =010
            RadiusTopLeft: =010
            RadiusTopRight: =010
            Size: =15
            Text: ="서브 카테고리 추가"
            Visible: =Gallery_Sub_CategoryMenu.Visible
            Width: =Button_SubGalleryBody_CategoryMenu.Width
            X: =45
            Y: =Gallery_Sub_CategoryMenu.Y +Gallery_Sub_CategoryMenu.Height +5
            ZIndex: =2

        Gallery_Sub_CategoryMenu As gallery.variableTemplateHeightGallery:
            BorderColor: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: |-
                =If(
                    testVisible=ThisItem.Result,
                    CountRows(
                        Filter(
                            Category_table,
                            LV1 = ThisItem.Result
                        )
                    ) * 80,
                    0
                )
                
                
                /*CountRows(
                    Filter(
                        GNB_MENU,
                        LV1 = ThisItem.Result
                    )
                ) * 75.835
                */
                
                /*If(
                    testVisible=ThisItem.Result,
                    CountRows(
                        Filter(
                            GNB_MENU,
                            LV1 = ThisItem.Result
                        )
                    ) * 75,
                    0
                )*/
                
                
                
                /*ForAll(
                    Sequence(CountRows(Filter(CategoryMenuCollect, OData__x004c_V1=ThisItem.Result))),
                    Sum(
                );*/
            Items: =SortByColumns(Filter(Category_table, LV1=ThisItem.Result), "LV2Order", SortOrder.Ascending)
            Layout: =Layout.Vertical
            OnSelect: |
                =Set(SelectedLV2,ThisItem.제목);
                Set(SelectedLV1, "");
                
                If(ThisItem.제목=SelectedLV2, //Checkbox5.Value,
                Set(CheckedLV1, ThisItem.LV1);
                Set(CheckedLV2, ThisItem.제목);
                Set(CheckedLV1Order, ThisItem.LV1Order);
                Set(CheckedLV2Order, ThisItem.LV2Order);
                Set(CheckedID, ThisItem.ID);,
                
                Set(CheckedLV1, Blank());
                Set(CheckedLV2, Blank());
                Set(CheckedLV1Order, Blank());
                Set(CheckedLV2Order, Blank());
                Set(CheckedID, Blank());
                );
                
                Set(FirstLV2Order, First(SortByColumns(Filter(Category_table, LV1=CheckedLV1),"LV2Order")).LV2Order);
                Set(PrevLV2Order, CheckedLV2Order-1);
                Set(NextLV2Order, CheckedLV2Order+1);
                Set(LastLV2Order, Last(SortByColumns(Filter(Category_table, LV1=CheckedLV1),"LV2Order")).LV2Order);
                Set(BlankLV2Order, LastLV2Order +1);
            ShowScrollbar: =false
            TemplateSize: =87
            Visible: =If(testVisible=ThisItem.Result, true, false)
            Width: =1485
            X: =1
            Y: =68
            ZIndex: =3

            Button_SubGalleryBody_CategoryMenu As button:
                BorderColor: =Color.Blue
                DisabledBorderColor: |-
                    =ColorValue("#D1D1D1")
                DisabledColor: |-
                    =ColorValue("#FFFFFF")
                DisabledFill: |-
                    =ColorValue("#FFFFFF")
                DisplayMode: =DisplayMode.Disabled
                Fill: |-
                    =ColorValue("#FFFFFF")
                FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =64
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
                OnSelect: |-
                    =Set(SelectedLV2,ThisItem.제목);
                    Set(SelectedLV1, "");
                    Select(Parent)
                PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                Size: =15
                Text: =""
                Width: =1400
                X: =40
                Y: =4
                ZIndex: =1

            TextInput_UserList_CategoryMenu As text:
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                Default: =""
                DisabledBorderColor: |-
                    =ColorValue("#D1D1D1")
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =Color.White
                DisplayMode: =DisplayMode.Disabled
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =Label_ComplateUsersName_CategoryMenu.Height
                HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverColor: =RGBA(51, 51, 51, 1)
                HoverFill: =RGBA(255, 255, 255, 1)
                OnSelect: =Select(Parent)
                PressedBorderColor: =RGBA(105, 121, 126, 1)
                PressedColor: =RGBA(51, 51, 51, 1)
                PressedFill: =RGBA(255, 255, 255, 1)
                RadiusBottomLeft: =010
                RadiusBottomRight: =010
                RadiusTopLeft: =010
                RadiusTopRight: =010
                Size: =13
                Width: =Label_ComplateUsersName_CategoryMenu.Width
                X: =Label_ComplateUsersName_CategoryMenu.X
                Y: =Label_ComplateUsersName_CategoryMenu.Y
                ZIndex: =2

            TextInput_SubMenuName_CategoryMenu As text:
                BorderColor: =Color.White
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                Default: |-
                    =If(
                        ThisItem.제목=LookUp(Category_table, LV1=ThisItem.제목, LV1Order) || IsNumeric(ThisItem.제목),
                        Blank(),
                        ThisItem.제목
                    )
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(0, 0,0, 1)
                DisabledFill: =RGBA(255, 255, 255, 1)
                DisplayMode: |-
                    =If(
                        IsNumeric(ThisItem.Title),
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                FocusedBorderThickness: =2
                HintText: |-
                    =If(
                        IsNumeric(ThisItem.LV1),
                        "새 메뉴",
                        ThisItem.LV1
                    )
                HoverBorderColor: |-
                    =ColorValue("#D1D1D1")
                HoverColor: =RGBA(51, 51, 51, 1)
                HoverFill: =RGBA(255, 255, 255, 1)
                Mode: =TextMode.MultiLine
                OnChange: |-
                    =Patch(
                        CategoryMenuCollect,
                        LookUp(CategoryMenuCollect, ID=CheckedID), //ThisItem.ID = __CheckedID
                        { 
                            OData__x004c_V1:TextInput_MenuName_CategoryMenu.Text, 
                            Title:TextInput_SubMenuName_CategoryMenu.Text,
                            LV1Order: CheckedLV1Order, 
                            LV2Order: CheckedLV2Order
                        }
                    );
                    
                    UpdateContext({LV02_Category:Self.Text});
                OnSelect: |-
                    =//If(SelectedLV2<>ThisItem.Title, Set(SelectedLV2,ThisItem.Title), Set(SelectedLV2, ""));
                    Set(SelectedLV2,ThisItem.제목);
                    Set(SelectedLV1, "");
                    Select(Parent)
                PaddingLeft: =24
                PaddingRight: =10
                PaddingTop: =10
                PressedBorderColor: |-
                    =ColorValue("#D1D1D1")
                PressedColor: =RGBA(51, 51, 51, 1)
                PressedFill: =RGBA(255, 255, 255, 1)
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                Size: =13
                Width: =259
                X: =51
                Y: =18
                ZIndex: =3

            Label_ComplateUsersName_CategoryMenu As label:
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Height: |
                    =32
                OnSelect: =Select(Parent)
                PaddingLeft: =24
                Size: =13
                Text: |-
                    =//Concat(ThisItem.'Users (Users0)', DisplayName & " ( " & Email & " ) ", ",                                                  ")
                    //Concat(MyPeople, DisplayName & " ( " & Mail & " ) ", ",                                                                    ")
                    //Concat(LookUp(CategoryMenuCollect, Title=If(__CheckedLV2<>ThisItem.Title, ThisItem.Title, __CheckedLV2), Users0), DisplayName & " (" & Email & ")", ",                     ")
                    If(
                        CountRows(
                            LookUp(
                                CategoryMenuCollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Users
                            )
                        ) > 1,
                        First(
                            LookUp(
                                CategoryMenuCollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Users
                            )
                        ).DisplayName & " 외" & Int(
                            CountRows(
                                LookUp(
                                    CategoryMenuCollect,
                                    Title = If(
                                        CheckedLV2 <> ThisItem.제목,
                                        ThisItem.제목,
                                        CheckedLV2
                                    ),
                                    Users
                                )
                            )
                        ) - 1 & "명",
                        First(
                            LookUp(
                                CategoryMenuCollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Users
                            )
                        ).DisplayName
                    )
                Width: =330
                Wrap: =false
                X: =939
                Y: =20
                ZIndex: =4

            Icon_DeleteSubMenu_CategoryMenu As icon.Share:
                BorderColor: =RGBA(166, 166, 166, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                DisplayMode: |-
                    =If(
                        ThisItem.ID = CheckedID,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                FocusedBorderThickness: =4
                Height: =32
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Cancel
                OnSelect: |-
                    =
                    Select(Parent);
                    /*
                    Remove(
                        GNB_MENU,
                        First(
                            Filter(
                                GNB_MENU,
                                ID=CheckedID
                            )
                        )
                    );
                    UpdateContext({ ShowHeight:
                        CountRows(
                        ForAll(SortByColumns(Filter(GNB_MENU, LV1<>Blank()), "LV1Order", SortOrder.Ascending), {Result: ThisRecord.LV1})
                    ) * 80 + 
                        CountRows(
                            Filter(
                                GNB_MENU, LV1=ZoomLV1
                            )
                        ) * 80 + 75}
                    );
                    */
                    Set(DelPopUp,true)
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Tooltip: ="선택한 메뉴 삭제"
                Width: =32
                X: =1392
                Y: =18
                ZIndex: =5

            TextInput_TeamList_CategoryMenu As text:
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                Default: =""
                DisabledBorderColor: |-
                    =ColorValue("#D1D1D1")
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =Color.White
                DisplayMode: =DisplayMode.Disabled
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =Label_ComplateTeamName_CategoryMenu.Height
                HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverColor: =RGBA(51, 51, 51, 1)
                HoverFill: =RGBA(255, 255, 255, 1)
                OnSelect: =Select(Parent)
                PressedBorderColor: =RGBA(105, 121, 126, 1)
                PressedColor: =RGBA(51, 51, 51, 1)
                PressedFill: =RGBA(255, 255, 255, 1)
                RadiusBottomLeft: =010
                RadiusBottomRight: =010
                RadiusTopLeft: =010
                RadiusTopRight: =010
                Size: =13
                Width: =Label_ComplateTeamName_CategoryMenu.Width
                X: =Label_ComplateTeamName_CategoryMenu.X
                Y: =Label_ComplateTeamName_CategoryMenu.Y
                ZIndex: =8

            Label_ComplateTeamName_CategoryMenu As label:
                BorderColor: =RGBA(179, 179, 179, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Height: =32
                OnSelect: =Select(Parent)
                Overflow: =Overflow.Scroll
                PaddingLeft: =24
                Size: =13
                Text: |-
                    =//IfError(AzureAD.GetGroup(ThisItem.Value).description,""
                    If(
                        CountRows(
                            Split(
                                LookUp(
                                    CategoryMenuCollect,
                                    ID = ThisItem.ID
                                ).Team_ID,
                                ","
                            )
                        ) > 1,
                        AzureAD.GetGroup(
                            First(
                                Split(
                                    LookUp(
                                        CategoryMenuCollect,
                                        ID = ThisItem.ID
                                    ).Team_ID,
                                    ","
                                )
                            ).Value
                        ).description & " 외" & CountRows(
                            Split(
                                LookUp(
                                    CategoryMenuCollect,
                                    ID = ThisItem.ID
                                ).Team_ID,
                                ","
                            )
                        ) - 1 & "팀",
                        IfError(
                        AzureAD.GetGroup(
                            First(
                                Split(
                                    LookUp(
                                        CategoryMenuCollect,
                                        ID = ThisItem.ID,
                                        Team_ID
                                    ),
                                    ","
                                )
                            ).Value
                        ).description,"")
                    )
                    /*IfError(
                            AzureAD.GetGroup(
                                First(
                                    Split(
                                        LookUp(
                                            CategoryMenuCollect,
                                            ID = ThisItem.ID,
                                            Team_ID
                                        ),
                                        ","
                                    )
                                ).Value
                            ).description,
                            ""
                        ),*/
                    /*If(
                        CountRows(
                            LookUp(
                                CategoryMenuCollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Distinct(
                                    Department,
                                    Department
                                )
                            )
                        ) > 1,
                        First(
                            LookUp(
                                CategoryMenuCollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Department
                            )
                        ).Department & " 외" & Int(
                            CountRows(
                                LookUp(
                                    CategoryMenuCollect,
                                    Title = If(
                                        CheckedLV2 <> ThisItem.제목,
                                        ThisItem.제목,
                                        CheckedLV2
                                    ),
                                    Distinct(
                                        Department,
                                        Department
                                    )
                                )
                            )
                        ) - 1 & "개의 팀",
                        If(
                            CountRows(
                                LookUp(
                                    CategoryMenuCollect,
                                    Title = If(
                                        CheckedLV2 <> ThisItem.제목,
                                        ThisItem.제목,
                                        CheckedLV2
                                    ),
                                    Distinct(
                                        Department,
                                        Department
                                    )
                                )
                            ) = 0,
                            "할당된 팀이 없습니다.",
                            First(
                                LookUp(
                                    CategoryMenuCollect,
                                    Title = If(
                                        CheckedLV2 <> ThisItem.제목,
                                        ThisItem.제목,
                                        CheckedLV2
                                    ),
                                    Department
                                )
                            ).Department
                        )
                    )*/
                    /*
                    If(
                        CountRows(
                            LookUp(
                                CategoryMenuCollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Distinct(Teams,Department)
                            )
                        ) > 1,
                        First(
                            LookUp(
                                CategoryMenuCollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Teams
                            )
                        ).Department & " 외" & Int(
                            CountRows(
                                LookUp(
                                    CategoryMenuCollect,
                                    Title = If(
                                        CheckedLV2 <> ThisItem.제목,
                                        ThisItem.제목,
                                        CheckedLV2
                                    ),
                                    Distinct(Teams,Department)
                                )
                            )
                        ) - 1 & "개의 팀",
                        First(
                            LookUp(
                                CategoryMenuCollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Teams
                            )
                        ).Department
                    )
                    */
                Width: =512
                X: =325
                Y: =20
                ZIndex: =9

            Image_TeamSerch_CategoryMenu As image:
                BorderColor: |-
                    =ColorValue("#D1D1D1")
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =32
                HoverBorderColor: |-
                    =ColorValue("#D1D1D1")
                HoverFill: |-
                    =ColorValue("#F5F5F5")
                Image: =Icon_AddTeamCheck
                OnSelect: |-
                    =Select(Parent);
                    //ClearCollect(MyPeople2,RenameColumns( LookUp(CategoryMenuCollect, Title=ThisItem.제목, Teams), "Email", "UserPrincipalName"));
                    ClearCollect(MyPeople2,Split(
                        LookUp(
                            CategoryMenuCollect,
                            ID = CheckedID
                        ).Team_ID,
                        ","
                    ));
                    
                    Set(MAMode, "Search");
                    Set(AddTeamPopup, true);
                    Set(Ok, true);
                    //ClearCollect(MyPeople,RenameColumns( ThisItem.'Users (Users0)', "Email", "UserPrincipalName"));
                    //ClearCollect(MyPeople, ThisItem.'Users (Users0)');
                PressedBorderColor: |-
                    =ColorValue("#D1D1D1")
                PressedFill: |-
                    =ColorValue("#E0E0E0")
                RadiusBottomLeft: =010
                RadiusBottomRight: =010
                RadiusTopLeft: =010
                RadiusTopRight: =010
                Width: =32
                X: =846
                Y: =20
                ZIndex: =10

            Image_Addteam_CategoryMenu As image:
                BorderColor: |-
                    =ColorValue("#D1D1D1")
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                DisplayMode: |-
                    =If(
                        ThisItem.ID = CheckedID,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                FocusedBorderThickness: =4
                Height: =32
                HoverBorderColor: |-
                    =ColorValue("#D1D1D1")
                HoverFill: |-
                    =ColorValue("#F5F5F5")
                Image: =Icon_AddTeam
                OnSelect: |
                    =Select(Parent);
                    Set(SelectedLV1, ThisItem.LV1);
                    Set(SelectedLV2, "");
                    Set(CheckedID, LookUp(Category_table, LV1=ThisItem.LV1, ID));
                    Set(MAMode , "TeamAdd");
                    Set(AddTeamPopup, true);
                    Clear(MyPeople)
                PressedBorderColor: |-
                    =ColorValue("#D1D1D1")
                PressedFill: |-
                    =ColorValue("#E0E0E0")
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                Transparency: |-
                    =If(
                        ThisItem.ID = CheckedID,
                        0,
                        0.7
                    )
                Width: =32
                X: =886
                Y: =20
                ZIndex: =11

            Icon_ComplateUserList_CategoryMenu As image:
                BorderColor: |-
                    =ColorValue("#D1D1D1")
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =32
                HoverBorderColor: |-
                    =ColorValue("#D1D1D1")
                HoverFill: |-
                    =ColorValue("#F5F5F5")
                Image: =Icon_AddTeamCheck
                OnSelect: |-
                    =Select(Parent);
                    ClearCollect(MyPeople,RenameColumns(LookUp(CategoryMenuCollect, Title=ThisItem.제목, Users), "Email", "UserPrincipalName"));
                    Set(MAMode, "Search");
                    Set(EditUserVisibleVal, true);
                    //ClearCollect(MyPeople,RenameColumns( ThisItem.'Users (Users0)', "Email", "UserPrincipalName"));
                    //ClearCollect(MyPeople, ThisItem.'Users (Users0)');
                PressedBorderColor: |-
                    =ColorValue("#D1D1D1")
                PressedFill: |-
                    =ColorValue("#E0E0E0")
                RadiusBottomLeft: =010
                RadiusBottomRight: =010
                RadiusTopLeft: =010
                RadiusTopRight: =010
                Width: =32
                X: =1276
                Y: =18
                ZIndex: =12

            Icon_AddUserButton_CategoryMenu As image:
                BorderColor: |-
                    =ColorValue("#D1D1D1")
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                DisplayMode: |-
                    =If(
                        ThisItem.ID = CheckedID,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                FocusedBorderThickness: =4
                Height: =32
                HoverBorderColor: |-
                    =ColorValue("#D1D1D1")
                HoverFill: |-
                    =ColorValue("#F5F5F5")
                Image: =Icon_AddTeam
                OnSelect: |-
                    =Select(Parent);
                    Clear(MyPeople);
                    //ClearCollect(MyPeople,RenameColumns( LookUp(CategoryMenuCollect, Title=ThisItem.Title, Users0), "Email", "UserPrincipalName"));
                    Set(MAMode, "Add");
                    Set(EditUserVisibleVal, true);
                    //ClearCollect(MyPeople,RenameColumns( ThisItem.'Users (Users0)', "Email", "UserPrincipalName"));
                    //ClearCollect(MyPeople, ThisItem.'Users (Users0)');
                PressedBorderColor: |-
                    =ColorValue("#D1D1D1")
                PressedFill: |-
                    =ColorValue("#E0E0E0")
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                Transparency: |-
                    =If(
                        ThisItem.ID = CheckedID,
                        0,
                        0.7
                    )
                Width: =32
                X: =1316
                Y: =18
                ZIndex: =13

        Button_MainUsersName_CategoryMenu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderThickness: =0
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            FocusedBorderThickness: =0
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =64
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: |-
                =ColorValue("#FFFFFF")
            OnSelect: |-
                =
                Select(Parent);
                
                
                
                If(ZoomLV1<>ThisItem.Result, Set(ZoomLV1,ThisItem.Result), Set(ZoomLV1, ""));
                If(testVisible<>ThisItem.Result ,Set(testVisible,ThisItem.Result), Set(testVisible,""));
                
                If(testVisible="",
                If(ThisItem.IsSelected, UpdateContext({ testHight: 
                CountRows(
                    ForAll(Distinct(SortByColumns(Category_table, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                ) * 80})),
                
                UpdateContext({ testHight:
                    CountRows(
                        ForAll(Distinct(SortByColumns(Category_table, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                    ) * 80 + 
                    CountRows(
                        Filter(
                            Category_table, LV1=ZoomLV1
                        )
                    ) * 80 + 75}));
                //Select(TextInput4)
                Set(SelectedLV1, "");
                Set(SelectedLV2, "");
                Select(Parent);
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: |-
                =ColorValue("#FFFFFF")
            PressedColor: |-
                =ColorValue("#FFFFFF")
            PressedFill: |-
                =ColorValue("#E0E0E0")
            RadiusBottomLeft: =If(Gallery_Sub_CategoryMenu.Visible= true, 0,10)
            RadiusBottomRight: =If(Gallery_Sub_CategoryMenu.Visible= true, 0,10)
            Size: =15
            Text: =""
            Width: =1485
            Y: =1
            ZIndex: =5

        TextInput_MenuName_CategoryMenu As text:
            BorderColor: =RGBA(0,0,0,0)
            BorderThickness: =2
            Color: =RGBA(0, 0, 0, 1)
            Default: |-
                =If(
                    ThisItem.Result=Text(LookUp(Category_table, LV1=Text(ThisItem.Result), LV1Order)),
                    Blank(),
                    ThisItem.Result
                )
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(0, 0, 0, 1)
            DisabledFill: =RGBA(0,0,0,0)
            DisplayMode: |-
                =If(
                    IsNumeric(ThisItem.Result),
                    DisplayMode.Edit,
                    DisplayMode.Disabled
                )
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =2
            FontWeight: =FontWeight.Semibold
            HintText: |-
                =If(
                    IsNumeric(ThisItem.Result),
                    "새 메뉴",
                    ThisItem.Result
                )
            HoverBorderColor: |-
                =ColorValue("#D1D1D1")
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            Mode: =TextMode.MultiLine
            OnChange: |-
                =ForAll(
                    Sequence(CountRows(Filter(CategoryMenuCollect, OData__x004c_V1=ThisItem.Result))),
                    Patch(
                        CategoryMenuCollect, LookUp(CategoryMenuCollect, OData__x004c_V1=ThisItem.Result), 
                        { 
                            OData__x004c_V1:TextInput_MenuName_CategoryMenu.Text 
                            }
                    )
                );
                /*
                If(
                    IsBlank(LookUp(NewPortalCollect, OData__x004c_V1=ThisItem.Result, LV1Order)),
                    Notify("Admin 메뉴는 편집할 수 없습니다.")
                )*/
                
                UpdateContext({LV01_Category:Self.Text});
            OnSelect: |-
                =//If(SelectedLV1<>ThisItem.Result, Set(SelectedLV1,ThisItem.Result), Set(SelectedLV1, ""));
                Set(SelectedLV1, ThisItem.Result);
                Set(SelectedLV2, "");
                Select(Parent)
            PaddingLeft: =
            PaddingTop: =10
            PressedBorderColor: =RGBA(105, 121, 126, 1)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =010
            RadiusBottomRight: =010
            RadiusTopLeft: =010
            RadiusTopRight: =010
            Width: =244
            X: =62
            Y: =17
            ZIndex: =6

        Image_DeleteMainList_CategoryMenu As image:
            BorderColor: |-
                =
                
                If(
                    ThisItem.Result = CheckedLV1 ,
                    RGBA(230, 230, 230, 1),
                    Color.White
                )
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            DisplayMode: |-
                =If(
                    ThisItem.Result = CheckedLV1,
                    DisplayMode.Edit,
                    DisplayMode.Disabled
                )
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =35
            HoverFill: |-
                =If(
                    ThisItem.Result = CheckedLV1 ,
                    RGBA(219, 219, 219, 1),
                    RGBA(0, 0, 0, 0)
                )
            Image: =Delete
            OnSelect: |-
                =Select(Parent);
                /*
                ForAll(
                    Sequence(CountRows(Filter(GNB_MENU, LV1=ThisItem.Result))),
                    Remove(GNB_MENU, LookUp(GNB_MENU,LV1=ThisItem.Result))
                );
                
                UpdateContext({ testHight:
                    CountRows(
                    ForAll(Distinct(SortByColumns(GNB_MENU, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                ) * 80 });
                
                Refresh(GNB_MENU);
                Set(ZoomLV1, "");
                Set(testVisible, "");
                Set(SelectedLV1, "");
                Set(SelectedLV2, "");
                */
                Set(DelpopUpMain,true)
            PaddingBottom: =05
            PaddingLeft: =05
            PaddingRight: =05
            PaddingTop: =05
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: |-
                =
                
                
                If(
                    ThisItem.Result = CheckedLV1 ,
                    RGBA(219, 219, 219, 1),
                    RGBA(0, 0, 0, 0)
                )
            RadiusBottomLeft: =10
            RadiusBottomRight: =10
            RadiusTopLeft: =10
            RadiusTopRight: =10
            Transparency: |+
                =If(
                    ThisItem.Result = CheckedLV1 ,
                    0,
                    0.5
                )
                
            Width: =35
            X: =1413
            Y: =17
            ZIndex: =7

        Image_SubAddMainMenu_CategoryMenu As image:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =24
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            Image: =PlusBlack
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =Gallery_Sub_CategoryMenu.Visible
            Width: =24
            X: =629
            Y: =Button_SubAddMainMenu_CategoryMenu.Y+10
            ZIndex: =10

        Image_CategoryGallery_CategoryMenu As image:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =20
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            Image: =Icon_galleryOn
            ImageRotation: |-
                =If(Gallery_Sub_CategoryMenu.Visible = true,ImageRotation.Rotate180,
                
                ImageRotation.None)
            OnSelect: |-
                =
                Select(Parent);
                
                
                
                If(ZoomLV1<>ThisItem.Result, Set(ZoomLV1,ThisItem.Result), Set(ZoomLV1, ""));
                If(testVisible<>ThisItem.Result ,Set(testVisible,ThisItem.Result), Set(testVisible,""));
                
                If(testVisible="",
                If(ThisItem.IsSelected, UpdateContext({ testHight: 
                CountRows(
                    ForAll(Distinct(SortByColumns(Category_table, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                ) * 80})),
                
                UpdateContext({ testHight:
                    CountRows(
                        ForAll(Distinct(SortByColumns(Category_table, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                    ) * 80 + 
                    CountRows(
                        Filter(
                            Category_table, LV1=ZoomLV1
                        )
                    ) * 80 + 75}));
                //Select(TextInput4)
                Set(SelectedLV1, "");
                Set(SelectedLV2, "");
                Select(Parent);
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            Width: =20
            X: =20
            Y: =28
            ZIndex: =11

    Button_AddMainMenu_CategoryMenu As button:
        BorderColor: |-
            =ColorValue("#D1D1D1")
        Color: =Color.Black
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: |-
            =ColorValue("#FFFFFF")
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FocusedBorderThickness: =2
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        HoverBorderColor: |-
            =ColorValue("#D1D1D1")
        HoverColor: =Color.Black
        HoverFill: |-
            =ColorValue("#F5F5F5")
        OnSelect: |-
            =Set(LastLV1Order, Last(SortByColumns(Category_table,"LV1Order", SortOrder.Ascending)).LV1Order);
            If(
                IsBlank(LastLV1Order),
                Set(LastLV1Order, 0)
            );
            
            Patch(
                Category_table, 
                Defaults(Category_table), 
                { 제목:LastLV1Order+1, LV1:LastLV1Order+1, LV1Order:LastLV1Order+1, LV2Order:1 }
            );
            
            ClearCollect(
                CategoryMenuCollect,
                ShowColumns(
                    SortByColumns(Category_table, "LV1Order", SortOrder.Ascending),
                    "Title",
                    "OData__x004c_V1",
                    "LV1Order",
                    "LV2Order",
                    "Department",
                    "ID",
                    "Users" // 06-23 추가(상의 필요)
                )
            );
            UpdateContext({ testHight:
                CountRows(
                ForAll(Distinct(SortByColumns(Category_table, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
            ) * 80 });
            //Select(TextInput4)
            Concurrent(
            Set(ZoomLV1, "");,
            Set(testVisible, "");,
            Set(SelectedLV1, "");,
            Set(SelectedLV2, "");
            );
            //Refresh(Category_table);
            Set(LastLV1Order, Last(SortByColumns(Category_table,"LV1Order")).LV1Order);
        PressedBorderColor: |-
            =ColorValue("#D1D1D1")
        PressedColor: =Color.Black
        PressedFill: |-
            =ColorValue("#E0E0E0")
        RadiusBottomLeft: =010
        RadiusBottomRight: =010
        RadiusTopLeft: =010
        RadiusTopRight: =010
        Size: =15
        Text: ="메인 카테고리 추가"
        Width: =Button_MainUsersName_CategoryMenu.Width
        X: =377
        Y: =Gallery_Main_CategoryMenu.Y +Gallery_Main_CategoryMenu.Height + 15
        ZIndex: =10

    Container_CountMain_CategoryMenu As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.Bold
        Fill: =RGBA(255, 255, 255, 1)
        Height: =138
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Width: =283
        X: =361
        Y: =133
        ZIndex: =11

        Label_CountMainMenu_CategoryMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: |-
                =ColorValue("#0F6CBD")
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =20
            Text: |+
                =//"메인 메뉴" & " : " & CountRows(Filter(GNB_MENU,LV2Order=1)) & "개"
                //"메인 메뉴 : " & CountRows(Filter(GNB_MENU, !IsBlank(LV1))) & "개"
                CountRows(Distinct(Filter(Category_table, !IsBlank(LV1)), LV1))
                
                
            Width: =61
            X: =34
            Y: =55
            ZIndex: =1

        Label_CountMainTitle_CategoryMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =17
            Text: ="메인 카테고리"
            Width: =158
            X: =30
            Y: =15
            ZIndex: =2

        Label_CountMain_CategoryMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =23
            Size: =15
            Text: ="개"
            Width: =28
            X: =83
            Y: =67
            ZIndex: =3

    Container_CountSub_CategoryMenu As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.Bold
        Fill: =RGBA(255, 255, 255, 1)
        Height: =138
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Width: =268
        X: =658
        Y: =133
        ZIndex: =12

        Label_CountSub2_CategoryMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: |-
                =ColorValue("#0F6CBD")
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =20
            Text: =CountRows(Filter(Category_table,!IsBlank(LV2Order)))
            Width: =61
            X: =34
            Y: =55
            ZIndex: =1

        Label_CountSubMain_CategoryMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =17
            Text: ="서브 카테고리"
            Width: =160
            X: =30
            Y: =15
            ZIndex: =2

        Label_CountSub_CategoryMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =23
            Size: =15
            Text: ="개"
            Width: =28
            X: =75
            Y: =67
            ZIndex: =3

    Container_NoUser_CategoryMenu As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.Bold
        Fill: =RGBA(255, 255, 255, 1)
        Height: =138
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Width: =268
        X: =938
        Y: =133
        ZIndex: =13

        Label_NoUserCount_CategoryMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: |-
                =ColorValue("#0F6CBD")
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =20
            Text: =CountRows(Filter(Category_table, !IsBlank(LV2Order) && IsEmpty(Users) && IsEmpty(Teams)))
            Width: =61
            X: =34
            Y: =55
            ZIndex: =1

        Label_NoUserMain_CategoryMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =17
            Text: ="인원 미할당"
            X: =30
            Y: =15
            ZIndex: =2

        Label_NoUser_CategoryMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            Height: =26
            Size: =15
            Text: ="/" & CountRows(Filter(Category_table,!IsBlank(LV2Order))) & "개"
            Width: =73
            X: =79
            Y: =67
            ZIndex: =3

        Image_NoUser_CategoryMenu As image:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =30
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            Image: =UserListPopup
            OnSelect: =Set(CategoryPopup,true);
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            Width: =30
            X: =225
            Y: =20
            ZIndex: =4

    Image_EditMainMenu_CategoryMenu As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =30
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =PlusBlack
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =30
        X: =976
        Y: =Button_AddMainMenu_CategoryMenu.Y+5
        ZIndex: =18

    Label_CategoryList_CategoryMenu As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Size: =16
        Text: ="●  Category List"
        Width: =178
        X: =372
        Y: =315
        ZIndex: =19

    Group_AddUserPopUp_CategoryMenu As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =33

        Rectangle_ComplateUserList_CategoryMenu As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =580
            Visible: =EditUserVisibleVal
            Width: =494
            X: =821
            Y: =222
            ZIndex: =30

        Button_OKComplateUser_CategoryMenu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |+
                =If(
                    MAMode = "Search",
                    Clear(
                            LookUp(
                            CategoryMenuCollect,
                            ID = CheckedID,
                            Users
                        )
                    );
                    Collect(
                        LookUp(
                            CategoryMenuCollect,
                            ID = CheckedID,
                            Users
                        ),
                        MyPeople
                    );
                    ,
                    MAMode = "Add",
                    Collect(
                        LookUp(
                            CategoryMenuCollect,
                            ID = CheckedID,
                            Users
                        ),
                        MyPeople
                    )
                );
                
                Set(
                    SelectedLV1,
                    ""
                );
                Set(
                    SelectedLV2,
                    ""
                );
                Set(
                    CheckedLV2,
                    ""
                );
                
                Set(
                    ZoomLV1,
                    "FFF"
                );
                Set(EditUserVisibleVal, false);
                Reset(TextInput_AddUserSearch_CategoryMenu);
                Refresh(Category_table);
                
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="확인"
            Visible: |
                =EditUserVisibleVal
            X: =Rectangle_ComplateUserList_CategoryMenu.X + (Rectangle_ComplateUserList_CategoryMenu.Width/2 - Self.Width)/2
            Y: =Rectangle_ComplateUserList_CategoryMenu.Y + Rectangle_ComplateUserList_CategoryMenu.Height - Self.Height - 20
            ZIndex: =31

        Button_CancleComplateUser_CategoryMenu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |-
                =Set(EditUserVisibleVal, false);
                Reset(TextInput_AddUserSearch_CategoryMenu);
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="취소"
            Visible: =EditUserVisibleVal
            X: =Rectangle_ComplateUserList_CategoryMenu.X + (Rectangle_ComplateUserList_CategoryMenu.Width + Self.Width/2)/2
            Y: =Button_OKComplateUser_CategoryMenu.Y
            ZIndex: =32

        Gallery_ComplateUserList_CategoryMenu As gallery.SelectedUsersTabletGallery:
            AccessibleLabel: ="사용자가 사람을 선택함"
            BorderThickness: =1
            Height: |-
                =If(
                    TextInput_AddUserSearch_CategoryMenu.Visible,
                    Gallery_AddUserSearch_CategoryMenu.Height,
                    TextInput_AddUserSearch_CategoryMenu.Height + Gallery_AddUserSearch_CategoryMenu.Height + 20
                )
            Items: =MyPeople
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =47
            Visible: =EditUserVisibleVal
            Width: =TextInput_AddUserSearch_CategoryMenu.Width
            X: =Gallery_AddUserSearch_CategoryMenu.X
            Y: |-
                =If(
                    TextInput_AddUserSearch_CategoryMenu.Visible,
                    Gallery_AddUserSearch_CategoryMenu.Y,
                    TextInput_AddUserSearch_CategoryMenu.Y
                )
            ZIndex: =33

            Rectangle_UserList_CategoryMenu As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledFill: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(105, 121, 126, 1)
                FocusedBorderThickness: =4
                Height: =Parent.TemplateHeight
                HoverFill: =RGBA(105, 121, 126, 1)
                OnSelect: =Select(Parent)
                PressedFill: =RGBA(105, 121, 126, 1)
                Width: =Parent.TemplateWidth
                ZIndex: =1

            Title_UserList_CategoryMenu As label:
                Color: =RGBA(255, 255, 255, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                Height: =Gallery_ComplateUserList_CategoryMenu.TemplateHeight
                OnSelect: =Set(selectedUser, ThisItem)
                PaddingLeft: =10
                Size: =13
                TabIndex: =If(Gallery_AddUserSearch_CategoryMenu.Visible, -1, 0)
                Text: =ThisItem.DisplayName & " ( " & ThisItem.UserPrincipalName & " ) "
                Width: =Gallery_ComplateUserList_CategoryMenu.TemplateWidth - Icon_UserListRemove_CategoryMenu.Width + 10
                Wrap: =false
                ZIndex: =2

            Icon_UserListRemove_CategoryMenu As icon.Cancel:
                AccessibleLabel: =Icon_UserListRemove_CategoryMenu.Tooltip
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =Title_UserList_CategoryMenu.Color
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Height: =Gallery_ComplateUserList_CategoryMenu.TemplateHeight
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Cancel
                OnSelect: |
                    =Remove(
                        MyPeople,
                        LookUp(
                            MyPeople,
                            UserPrincipalName = ThisItem.UserPrincipalName
                        )
                    );
                    Collect(
                        RemoveUserCollection,
                        {
                            LV01_Category: Gallery_Main_CategoryMenu.Selected.Result,
                            LV02_Category: LookUp(Category_table,LV1=Gallery_Main_CategoryMenu.Selected.Result).제목, //Gallery_Sub_CategoryMenu.Selected.제목,
                            Email: ThisItem.UserPrincipalName,
                            Name: ThisItem.DisplayName
                        }
                    );
                PaddingBottom: =9
                PaddingLeft: =9
                PaddingRight: =9
                PaddingTop: =9
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                TabIndex: =If(Gallery_AddUserSearch_CategoryMenu.Visible, -1, 0)
                Tooltip: ="컬렉션에서 사용자를 제거하려면 선택"
                Width: =Self.Height
                X: =Gallery_ComplateUserList_CategoryMenu.TemplateWidth - Self.Width
                ZIndex: =3

        Gallery_AddUserSearch_CategoryMenu As gallery.PeoplePickerTabletGallery:
            AccessibleLabel: ="사용자 찾기 검색 결과"
            BorderColor: =RGBA(166, 166, 166, 1)
            Fill: =Parent.Fill
            Height: =376
            Items: |+
                =/*
                If(
                    !IsBlank(Trim(txtUserSearch.Text)),
                    Office365사용자.SearchUserV2(
                        {
                            searchTerm:txtUserSearch.Text,
                            top: 999
                        }
                    ).value
                )
                */
                
                If(
                    IsBlank(TextInput_AddUserSearch_CategoryMenu.Text),
                    Blank(),
                    If(
                        IsBlank(
                            Find(
                                ",",
                                TextInput_AddUserSearch_CategoryMenu.Text
                            )
                        ),
                        Search(
                            Namelist,
                            TextInput_AddUserSearch_CategoryMenu.Text,
                            "DisplayName"
                        ),
                        Filter(
                            Namelist,
                            DisplayName in Substitute(
                                Split(
                                    TextInput_AddUserSearch_CategoryMenu.Text,
                                    ","
                                ),
                                " ",
                                ""
                            )
                        )
                    )
                )
                
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =87
            Visible: |-
                =If(
                TextInput_AddUserSearch_CategoryMenu.Visible,
                true,
                false
                )
            Width: =Rectangle_ComplateUserList_CategoryMenu.X + Rectangle_ComplateUserList_CategoryMenu.Width - Self.X - 10
            X: =TextInput_AddUserSearch_CategoryMenu.X
            Y: =TextInput_AddUserSearch_CategoryMenu.Y + TextInput_AddUserSearch_CategoryMenu.Height + 20
            ZIndex: =34

            Rectangle_UserInformation_CategoryMenu As rectangle:
                BorderColor: =Label_DisplayName_CategoryMenu.Color
                BorderThickness: =If(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName, 2, 0)
                DisabledFill: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(0,0,0,0)
                Height: =Parent.TemplateHeight - 2*Self.Y
                HoverFill: =RGBA(0,0,0,0)
                OnSelect: =Select(Label_DisplayName_CategoryMenu)
                PressedFill: =RGBA(105, 121, 126, 1)
                Width: =Parent.TemplateWidth - 2*Self.X
                X: =1
                Y: =1
                ZIndex: =1

            Icon_ProfileImage_CategoryMenu As icon.Person:
                BorderColor: =RGBA(0, 0, 0, 0)
                Color: =RGBA(255, 255, 255, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                Fill: =RGBA(0,0,0,0)
                Height: =Image_ProfileImage_CategoryMenu.Height
                Icon: =Icon.Person
                OnSelect: =Select(Label_DisplayName_CategoryMenu)
                PaddingBottom: =12
                PaddingLeft: =12
                PaddingRight: =12
                PaddingTop: =12
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =Image_ProfileImage_CategoryMenu.Width
                X: =Image_ProfileImage_CategoryMenu.X
                Y: =Image_ProfileImage_CategoryMenu.Y
                ZIndex: =2

            Image_ProfileImage_CategoryMenu As image:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Height: =Self.Width
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverFill: =RGBA(0, 0, 0, 0)
                Image: =If(!IsBlank(ThisItem.Id), 'Office365사용자'.UserPhotoV2(ThisItem.Id))
                OnSelect: =Select(Label_DisplayName_CategoryMenu)
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =Gallery_AddUserSearch_CategoryMenu.TemplateHeight - 30
                X: =37
                Y: =(Gallery_AddUserSearch_CategoryMenu.TemplateHeight / 2) - (Self.Height/2)
                ZIndex: =3

            Label_DisplayName_CategoryMenu As label:
                BorderColor: =Self.Color
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =Self.Size * 1.8
                OnSelect: |
                    =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                    /*
                    Concurrent(
                        Set(
                            selectedUser,
                            ThisItem
                        ),
                        Reset(TextSearchBox1_1),
                        If(
                            Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName) && Not(ThisItem.UserPrincipalName in LookUp(CategoryMenuCollect, ID=CheckedID, Users).Email),
                            Collect(
                                MyPeople,
                                ThisItem
                            );
                            Update( MyPeople, First( Filter( MyPeople, UserPrincipalName=ThisItem.UserPrincipalName ) ), 
                                { 
                                    Claims:"i:0#.f|membership|"& ThisItem.UserPrincipalName,
                                    Department:ThisItem.Department,
                                    DisplayName:ThisItem.DisplayName,
                                    UserPrincipalName:ThisItem.UserPrincipalName,
                                    JobTitle:ThisItem.JobTitle 
                                } 
                            )
                        )
                    );
                    */
                    If(
                        Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName) && Not(
                            ThisItem.UserPrincipalName in LookUp(
                                CategoryMenuCollect,
                                ID = CheckedID,
                                Users
                            ).Email
                        ),
                        Collect(
                            MyPeople,
                            ThisItem
                        );
                        Update(
                            MyPeople,
                            First(
                                Filter(
                                    MyPeople,
                                    UserPrincipalName = ThisItem.UserPrincipalName
                                )
                            ),
                            {
                                Claims: "i:0#.f|membership|" & ThisItem.UserPrincipalName,
                                Department: ThisItem.Department,
                                DisplayName: ThisItem.DisplayName,
                                UserPrincipalName: ThisItem.UserPrincipalName,
                                JobTitle: ThisItem.JobTitle
                            }
                        );
                        Set(UserAddPopup,true);,
                        Timer_AddUserComplete_CategoryMenu.Start = true,
                        Notify(
                            "사용자 추가 완료.",
                            NotificationType.Success,
                            800
                        ),
                       Set(UserAddPopup,false);,
                        Notify(
                            "중복된 이름입니다.",
                            NotificationType.Error,
                            800
                        )
                    );
                    
                    
                    
                    //Reset(TextSearchBox1_1);
                    //등록완료시 초기화
                Size: =12
                TabIndex: =0
                Text: =ThisItem.DisplayName
                Width: =Gallery_AddUserSearch_CategoryMenu.TemplateWidth - 232
                Wrap: =false
                X: =Image_ProfileImage_CategoryMenu.X + Image_ProfileImage_CategoryMenu.Width + 16
                Y: =16
                ZIndex: =4

            Label_UserPrincipalName_CategoryMenu As label:
                Color: =RGBA(51, 51, 51, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                Height: =Self.Size * 1.8
                OnSelect: =Select(Label_DisplayName_CategoryMenu)
                Size: =12
                Text: =ThisItem.UserPrincipalName
                Width: =Label_DisplayName_CategoryMenu.Width
                Wrap: =false
                X: =Label_DisplayName_CategoryMenu.X
                Y: =Gallery_AddUserSearch_CategoryMenu.TemplateHeight - Self.Height - 20
                ZIndex: =5

            Separator_AdduserGallery_CategoryMenu As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                Fill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =6

            Icon_AddUser_CategoryMenu As icon.Add:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Add
                OnSelect: =Select(Label_DisplayName_CategoryMenu)
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                X: =389
                Y: =11
                ZIndex: =7

        TextInput_AddUserSearch_CategoryMenu As text:
            Align: =TextPosition.Left
            Default: =""
            Height: |
                =40
            HintText: ="검색"
            PaddingLeft: =70
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Visible: =If(MAMode="Add", EditUserVisibleVal, false)
            Width: =Gallery_AddUserSearch_CategoryMenu.Width
            X: =Rectangle_ComplateUserList_CategoryMenu.X + 10
            Y: =Rectangle_ComplateUserList_CategoryMenu.Y + 10
            ZIndex: =35

        Icon_AddUserSherch_CategoryMenu As icon.Search:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(105, 121, 126, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =TextInput_AddUserSearch_CategoryMenu.Height-10
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Search
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =TextInput_AddUserSearch_CategoryMenu.Visible
            Width: =Self.Height
            X: =TextInput_AddUserSearch_CategoryMenu.X + 15
            Y: =TextInput_AddUserSearch_CategoryMenu.Y + 5
            ZIndex: =36

    Group_AddUserComplete_CategoryMenu As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =44

        Rectangle_AddUserComplete_CategoryMenu As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =396
            Visible: =If(UserAddPopup = true,true,false)
            Width: =772
            X: =680
            Y: =252
            ZIndex: =37

        Label_AddUserCompleteName_CategoryMenu As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =172
            Size: =30
            Text: =Last(Filter(MyPeople,DisplayName = DisplayName,DisplayName)).DisplayName
            Visible: =If(UserAddPopup = true,true,false)
            Width: =192
            X: =856
            Y: =350
            ZIndex: =38

        Label_AddUserComplete_CategoryMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =172
            Size: =30
            Text: ="님 추가 완료"
            Visible: =If(UserAddPopup = true,true,false)
            Width: =359
            X: =1016
            Y: =350
            ZIndex: =39

        Timer_AddUserComplete_CategoryMenu As timer:
            BorderColor: =RGBA(105, 121, 126, 1)
            BorderStyle: =BorderStyle.None
            DisabledBorderColor: =RGBA(244, 244, 244, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Duration: =1000
            Fill: =RGBA(105, 121, 126, 1)
            Font: =Font.'Segoe UI'
            Height: =70
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnTimerEnd: |-
                =Set(UserAddPopup, false); // Popup 컨트롤 숨기기
                Reset(Timer_AddUserComplete_CategoryMenu);
            OnTimerStart: =
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            Start: =If(UserAddPopup = true,true,false)
            Visible: =false
            X: =640
            Y: =10
            ZIndex: =40

    Group_DeleteMemberMain_CategoryMenu As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =47

        Rectangle_DeleteMemberMain_CategoryMenu As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =396
            Visible: =DelpopUpMain=true
            Width: =772
            X: =680
            Y: =272
            ZIndex: =20

        Button_OKDeleteMamberMain_CategoryMenu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |-
                =ForAll(
                    Sequence(CountRows(Filter(Category_table, LV1=CheckedLV1))),
                    Remove(Category_table, LookUp(Category_table,LV1=CheckedLV1))
                );
                //Remove(Category_table,Filter(Category_table,LV1=CheckedLV1));
                
                UpdateContext({ testHight:
                    CountRows(
                    ForAll(Distinct(SortByColumns(Category_table, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                ) * 80 });
                
                //Refresh(Category_table);
                Set(ZoomLV1, "");
                Set(testVisible, "");
                Set(SelectedLV1, "");
                Set(SelectedLV2, "");
                Set(DelpopUpMain,false)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="확인"
            Visible: =DelpopUpMain=true
            X: =864
            Y: =605
            ZIndex: =21

        Button_CencleDeleteMamberMain_CategoryMenu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: =Set(DelpopUpMain,false)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="취소"
            Visible: =DelpopUpMain=true
            X: =1107
            Y: =605
            ZIndex: =22

        Label_DeleteMemberMain_CategoryMenu As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            FontWeight: =FontWeight.Semibold
            Height: =92
            Size: =30
            Text: ="삭제하시겠습니까?"
            Visible: =DelpopUpMain=true
            Width: =391
            X: =876
            Y: =390
            ZIndex: =23

        Label_DeletMainMenuWarning_CategoryMenu As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =13
            Text: ="""확인시 Save를 누르지 않아도 삭제됩니다"""
            Underline: =true
            Visible: =DelpopUpMain
            Width: =400
            X: =871
            Y: =525
            ZIndex: =24

    New_Component_GNB_CategoryMenu As New_Component_GNB:
        ZIndex: =48

    Group_DeleteMemberSub_CategoryMenu As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =48

        Rectangle_DeleteMemberSub_CategoryMenu As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =396
            Visible: =DelPopUp=true
            Width: =772
            X: =680
            Y: =329
            ZIndex: =25

        Button_OKDeleteMamberSub_CategoryMenu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |-
                =Remove(
                    Category_table,
                    First(
                        Filter(
                            Category_table,
                            ID=CheckedID
                        )
                    )
                );
                UpdateContext({ ShowHeight:
                    CountRows(
                    ForAll(SortByColumns(Filter(Category_table, LV1<>Blank()), "LV1Order", SortOrder.Ascending), {Result: ThisRecord.LV1})
                ) * 80 + 
                    CountRows(
                        Filter(
                            Category_table, LV1=ZoomLV1
                        )
                    ) * 80 + 75}
                );
                
                Set(DelPopUp,false)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="확인"
            Visible: =DelPopUp=true
            X: =864
            Y: =662
            ZIndex: =26

        Button_CencleDeleteMamberSub_CategoryMenu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: =Set(DelPopUp,false)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="취소"
            Visible: =DelPopUp=true
            X: =1107
            Y: =Button_OKDeleteMamberSub_CategoryMenu.Y
            ZIndex: =27

        Label_DeleteMemberSub_CategoryMenu As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            FontWeight: =FontWeight.Semibold
            Height: =92
            Size: =30
            Text: ="삭제하시겠습니까?"
            Visible: =DelPopUp=true
            Width: =391
            X: =876
            Y: =447
            ZIndex: =28

        Label_DeletSubMenuWarning_CategoryMenu As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =13
            Text: ="""확인시 Save를 누르지 않아도 삭제됩니다"""
            Underline: =true
            Visible: =DelPopUp
            Width: =400
            X: =867
            Y: =545
            ZIndex: =29

    Group_AddTeam_CategoryMenu As group:
        Height: =5
        Width: =5
        X: =-713
        Y: =-180
        ZIndex: =56

        Rectangle_TeamPopUp_CategoryMenu As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =580
            Visible: =AddTeamPopup
            Width: =494
            X: =811
            Y: =203
            ZIndex: =41

        Button_OKTeamPopUP_CategoryMenu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |+
                =If(
                    MAMode = "Search",
                    Clear(
                            LookUp(
                            CategoryMenuCollect,
                            ID = CheckedID,
                            Users
                        )
                    );
                    Collect(
                        LookUp(
                            CategoryMenuCollect,
                            ID = CheckedID,
                            Department
                        ),
                        MyPeople
                    );
                    ,
                    MAMode = "Add",
                    Collect(
                        LookUp(
                            CategoryMenuCollect,
                            ID = CheckedID,
                            Department
                        ),
                        MyPeople
                    );
                    ,
                    MAMode = "TeamAdd",
                Collect(
                        LookUp(
                            CategoryMenuCollect,
                            ID = CheckedID,
                            Department
                            //Users    
                        ),
                        MyPeople
                    );
                     
                
                    /*
                    UpdateContext({
                    MyColumnValue: MyPeople.UserPrincipalName // MyPeople 컬렉션의 특정한 열의 값을 변수에 저장
                });
                Collect(
                    CategoryMenuCollect,
                    {
                        ID: CheckedID,
                        Teams: MyColumnValue // 변수에 저장된 값을 CategoryMenuCollect 컬렉션의 Teams 열에 넣음
                    }
                )
                */
                );
                
                Set(
                    SelectedLV1,
                    ""
                );
                Set(
                    SelectedLV2,
                    ""
                );
                Set(
                    CheckedLV2,
                    ""
                );
                
                Set(
                    ZoomLV1,
                    "FFF"
                );
                Set(EditUserVisibleVal, false);
                Reset(TextInput_ShearchTeam_CategoryMenu);
                Set(AddTeamPopup,false);
                Refresh(Category_table);
                
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="확인"
            Visible: |-
                =
                If(
                TextInput_ShearchTeam_CategoryMenu.Visible,
                true,
                false
                )
            X: =854
            Y: =723
            ZIndex: =42

        Button_CancelTeamPopUP_CategoryMenu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |-
                =Set(AddTeamPopup, false);
                Set(Ok, false);
                Reset(TextInput_ShearchTeam_CategoryMenu);
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="취소"
            Visible: =AddTeamPopup
            X: =1098
            Y: =723
            ZIndex: =43

        Gallery_ShearchTeamMembers_CategoryMenu As gallery.SelectedUsersTabletGallery:
            AccessibleLabel: ="사용자가 사람을 선택함"
            BorderThickness: =1
            Height: =402
            Items: =MyPeople2
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =47
            Visible: =AddTeamPopup
            Width: =TextInput_ShearchTeam_CategoryMenu.Width
            X: =821
            Y: =237
            ZIndex: =44

            Rectangle_TeamMembers_CategoryMenu As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledFill: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(105, 121, 126, 1)
                FocusedBorderThickness: =4
                Height: =Parent.TemplateHeight
                HoverFill: =RGBA(105, 121, 126, 1)
                OnSelect: =Select(Parent)
                PressedFill: =RGBA(105, 121, 126, 1)
                Visible: |-
                    =If(
                    TextInput_ShearchTeam_CategoryMenu.Visible,
                    false,
                    true
                    )
                Width: =Parent.TemplateWidth
                ZIndex: =1

            Title_TeamMembers_CategoryMenu As label:
                Color: =RGBA(255, 255, 255, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                Height: =Gallery_ShearchTeamMembers_CategoryMenu.TemplateHeight
                OnSelect: =Set(selectedUser, ThisItem)
                PaddingLeft: =10
                Size: =13
                TabIndex: =If(Gallery_ShearchTeam_CategoryMenu.Visible, -1, 0)
                Text: |-
                    =//ThisItem.DisplayName & " ( " & ThisItem.UserPrincipalName & " ) "
                    IfError(AzureAD.GetGroup(ThisItem.Value).description,"")
                Visible: |-
                    =If(
                    TextInput_ShearchTeam_CategoryMenu.Visible,
                    false,
                    true
                    )
                Width: =Gallery_ShearchTeamMembers_CategoryMenu.TemplateWidth - Icon_DeleteTeamMembers_CategoryMenu.Width + 10
                Wrap: =false
                ZIndex: =2

            Icon_DeleteTeamMembers_CategoryMenu As icon.Cancel:
                AccessibleLabel: =Icon_DeleteTeamMembers_CategoryMenu.Tooltip
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =Title_TeamMembers_CategoryMenu.Color
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Height: =Gallery_ShearchTeamMembers_CategoryMenu.TemplateHeight
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Cancel
                OnSelect: |-
                    =Remove(
                        MyPeople2,
                        ThisItem
                    );
                    Patch(
                        CategoryMenuCollect,
                        LookUp(
                            CategoryMenuCollect,
                            ID = CheckedID
                        ),
                        {
                            Team_ID: Concat(MyPeople2, Value,",")
                        }
                    )
                PaddingBottom: =9
                PaddingLeft: =9
                PaddingRight: =9
                PaddingTop: =9
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                TabIndex: =If(Gallery_ShearchTeam_CategoryMenu.Visible, -1, 0)
                Tooltip: ="컬렉션에서 사용자를 제거하려면 선택"
                Visible: |-
                    =If(
                    TextInput_ShearchTeam_CategoryMenu.Visible,
                    false,
                    true
                    )
                Width: =Self.Height
                X: =Gallery_ShearchTeamMembers_CategoryMenu.TemplateWidth - Self.Width
                ZIndex: =3

        Gallery_ShearchTeam_CategoryMenu As gallery.PeoplePickerTabletGallery:
            AccessibleLabel: ="사용자 찾기 검색 결과"
            BorderColor: =RGBA(166, 166, 166, 1)
            Fill: =Parent.Fill
            Height: =366
            Items: |+
                =col_ADGroup
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                /*If(
                    IsBlank(TextInput_ShearchTeam_CategoryMenu.Text),
                    Blank(),
                    If(
                        IsBlank(
                            Find(
                                ",",
                                TextInput_ShearchTeam_CategoryMenu.Text
                            )
                        ),
                        Search(
                            Departmentlist,
                            TextInput_ShearchTeam_CategoryMenu.Text,
                            "Value"
                        ),
                        Filter(
                            Departmentlist,
                            "Value" in Substitute(
                                Split(
                                    TextInput_ShearchTeam_CategoryMenu.Text,
                                    ","
                                ),
                                " ",
                                ""
                            )
                        )
                    )
                )*/
                
                
                
                
                
                /*
                 If(
                    IsBlank(txtUserSearch_1.Text),
                    Blank(),
                    If(
                        IsBlank(
                            Find(
                                ",",
                                txtUserSearch_1.Text
                            )
                        ),
                        Search(
                           Namelist,
                            txtUserSearch_1.Text,
                            "Department"
                        ),
                        Filter(
                            Namelist,
                            Department in Substitute(
                                Split(
                                    txtUserSearch_1.Text,
                                    ","
                                ),
                                " ",
                                ""
                            )
                        )
                    )
                )
                */
                
                
                
                
                /*
                If(
                    IsBlank(txtUserSearch_1.Text),
                    Blank(),
                    If(
                        IsBlank(
                            Find(
                                ",",
                                txtUserSearch_1.Text
                            )
                        ),
                        Search(
                           Namelist,
                            txtUserSearch_1.Text,
                            "Department"
                        ),
                        Filter(
                            Namelist,
                            Department in Substitute(
                                Split(
                                    txtUserSearch_1.Text,
                                    ","
                                ),
                                " ",
                                ""
                            )
                        )
                    )
                )
                */
                
                
                
                
                
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =87
            Visible: |-
                =If(
                TextInput_ShearchTeam_CategoryMenu.Visible,
                true,
                false
                )
            Width: =444
            X: =836
            Y: =273
            ZIndex: =45

            Rectangle_AddTeam_CategoryMenu As rectangle:
                BorderColor: =Title_AddTeamName_CategoryMenu.Color
                BorderThickness: =//If(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName, 2, 0)
                DisabledFill: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(0,0,0,0)
                Height: =Parent.TemplateHeight - 2*Self.Y
                HoverFill: =RGBA(0,0,0,0)
                OnSelect: =Select(Title_AddTeamName_CategoryMenu)
                PressedFill: =RGBA(105, 121, 126, 1)
                Width: =444
                Y: =1
                ZIndex: =1

            Title_AddTeamName_CategoryMenu As label:
                BorderColor: =Self.Color
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =Self.Size * 1.8
                OnSelect: |
                    =If(
                        ThisItem.id in LookUp(
                            CategoryMenuCollect,
                            ID = CheckedID
                        ).Team_ID,
                        Notify(
                            "중복된 이름입니다.",
                            NotificationType.Error,
                            800
                        ),
                        Patch(
                            CategoryMenuCollect,
                            LookUp(
                                CategoryMenuCollect,
                                ID = CheckedID
                            ),
                            If(
                                IsBlank(
                                    LookUp(
                                        CategoryMenuCollect,
                                        ID = CheckedID
                                    ).Team_ID
                                ),
                                {Team_ID: ThisItem.id},
                                {
                                    Team_ID: Concat(
                                        Filter(
                                            CategoryMenuCollect,
                                            ID = CheckedID
                                        ),
                                        Team_ID & "," & ThisItem.id,
                                        ","
                                    )
                                }
                            )
                        );
                        Notify(
                            "사용자 추가 완료.",
                            NotificationType.Success,
                            800
                        )
                    )
                    /*If(
                        Not(ThisItem.description in MyPeople.Department) && Not(
                            ThisItem.description in LookUp(
                                CategoryMenuCollect,
                                ID = CheckedID,
                                Users
                            ).Email
                        ),
                        ClearCollect(
                            MatchingPeople,
                            Filter(
                                Namelist,
                                Department = ThisItem.description
                            )
                        );
                        ForAll(
                            MatchingPeople,
                            If(
                                Not(UserPrincipalName in MyPeople.UserPrincipalName),
                                Collect(
                                    MyPeople,
                                    {
                                        Claims: "i:0#.f|membership|" & UserPrincipalName,
                                        Department: Department,
                                        DisplayName: DisplayName,
                                        UserPrincipalName: UserPrincipalName,
                                        JobTitle: JobTitle
                                    }
                                );
                                //
                            )
                        );
                        //Set(UserAddPopup,true);,
                        //timerAddUser.Start = true,
                    Notify(
                            "사용자 추가 완료.",
                            NotificationType.Success,
                            800
                        ),
                       //Set(UserAddPopup,false);,
                        Notify(
                            "중복된 이름입니다.",
                            NotificationType.Error,
                            800
                        )
                    );*/
                Size: =12
                TabIndex: =0
                Text: =ThisItem.description
                Width: =Gallery_ShearchTeam_CategoryMenu.TemplateWidth - 232
                Wrap: =false
                X: =
                Y: =16
                ZIndex: =4

            Separator_AddTeam_CategoryMenu As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                Fill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =6

            Icon_AddTeam_CategoryMenu As icon.Add:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Add
                OnSelect: =Select(Title_AddTeamName_CategoryMenu)
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                X: =357
                Y: =1
                ZIndex: =7

        TextInput_ShearchTeam_CategoryMenu As text:
            Align: =TextPosition.Left
            Default: =""
            Height: =35
            HintText: ="검색"
            PaddingLeft: =70
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Visible: =If(MAMode="TeamAdd", AddTeamPopup, false)
            Width: =466
            X: =821
            Y: =213
            ZIndex: =46

        Icon_ShearchTeam_CategoryMenu As icon.Search:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(105, 121, 126, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =TextInput_ShearchTeam_CategoryMenu.Height-10
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Search
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =TextInput_ShearchTeam_CategoryMenu.Visible
            Width: =Self.Height
            X: =836
            Y: =218
            ZIndex: =47

    Group_IncompleteSubMenuPopup_CategoryMenu As group:
        Height: =5
        Width: =5
        X: =-1227
        Y: =-130
        ZIndex: =61

        Rectangle_IncompleteSubMenuPopupMain_CateoryMenu As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            DisabledFill: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =535
            HoverFill: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            Visible: =CategoryPopup
            Width: =506
            X: =854
            Y: =225
            ZIndex: =14

        "Gallery_IncompleteSubMenuPopup_CateoryMenu As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            BorderThickness: =1
            DelayItemLoading: =true
            Height: =442
            Items: =Filter(Category_table, !IsBlank(LV2Order) && IsEmpty(Users) && IsEmpty(Teams))
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =Min(160, Self.Height - 60)
            Visible: =CategoryPopup
            Width: =476
            X: =867
            Y: =301
            ZIndex: =15

            Separator_IncompleteSubMenuPopup_CateoryMenu As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                Fill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =5

            Label_IncompleteSubMenuName_CateoryMenu As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =88
                OnSelect: =Select(Parent)
                Size: =18
                Text: |-
                    =//ThisItem.LV1& "  ===>  " & ThisItem.제목
                    ThisItem.제목
                Width: =427
                X: =24
                Y: =34
                ZIndex: =6

        Button_IncompleteSubMenuPopupCancel_CateoryMenu As icon.Cancel:
            BorderColor: =RGBA(166, 166, 166, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =40
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Cancel
            OnSelect: |
                =Set(CategoryPopup, false)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =CategoryPopup
            Width: =38
            X: =1305
            Y: =244
            ZIndex: =16

        Label_IncompleteSubMenuPopup_CateoryMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =17
            Text: ="할당된 인원이 없는 메뉴 목록"
            Visible: =CategoryPopup
            Width: =311
            X: =946
            Y: =249
            ZIndex: =17

