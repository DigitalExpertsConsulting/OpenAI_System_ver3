App As appinfo:
    BackEnabled: =false
    OnStart: |-
        =//디자인 설정
        Set(CSS_COMMON, {
            colors: {
                //background
                bg1: ColorValue("#FFFFFF"),
                bg1_hover: ColorValue("#F5F5F5"),
                bg1_pressed: ColorValue("#E0E0E0"),
                bg1_selected: ColorValue("#EBEBEB"),
                bg2: ColorValue("#FAFAFA"),
                bg3: ColorValue("#F5F5F5"),
                brand_bg: ColorValue("#0F6CBD"),
                brand_bg_hover: ColorValue("#115EA3"),
                brand_bg_pressed: ColorValue("#0C3B5E"),
                brand_bg_selected: ColorValue("#0F548C"),
                brand_bg_inverted: ColorValue("#FFFFFF"),
                brand_bg_inverted_hover: ColorValue("#EBF3FC"),
                brand_bg_inverted_pressed: ColorValue("#CFE4FA"),
                brand_bg_inverted_selected: ColorValue("#EBF3FC"),
                bg_disabled: ColorValue("#F0F0F0"),
                bg_overlay: RGBA(0, 0, 0, 0.4),
                scroll_bar: RGBA(0, 0, 0, 0.5),
                //foreground
                fg1: ColorValue("#242424"),
                fg1_brand_hover: ColorValue("#0F6CBD"),
                fg1_brand_pressed: ColorValue("#115EA3"),
                fg1_brand_selected: ColorValue("#0F6CBD"),
                fg2: ColorValue("#424242"),
                fg3: ColorValue("#616161"),
                fg4:ColorValue("#707070"),
                fg_inverted: ColorValue("#FFFFFF"),
                fg_disabled: ColorValue("#BDBDBD"),
                //stroke
                stroke1: ColorValue("#BDBDBD"),
                stroke1_hover: ColorValue("#666666"),
                stroke1_selected:ColorValue("#0F6CBD"),
                stroke1_errer: ColorValue("#D64D51"),
                stroke2: ColorValue("#CCCCCC"),
                stroke3: ColorValue("#E0E0E0"),
                stroke4: ColorValue("#424242"),
                stroke_disabled: ColorValue("#E0E0E0"),
                // exception
                green1: ColorValue("#107C10"),
                green2: ColorValue("#9FD89F"),
                green3: ColorValue("#F1FAF1"),
                yellow1: ColorValue("#FDE300"),
                yellow2: ColorValue("#FEF7B2"),
                yellow3: ColorValue("#FFFEF1"),
                mustard1: ColorValue("#EAA300"),
                mustard2: ColorValue("#FFE099"),
                mustard3: ColorValue("#FFFAF0"),
                orange1: ColorValue("#F36F36"),
                orange2: ColorValue("#F9C4A6"),
                orange3: ColorValue("#FFF8F3"),
                red1: ColorValue("#D64D51"),
                red2: ColorValue("#F1BBBC"),
                red3: ColorValue("#FDF6F6")
            },
            typography: {
                xxl: {
                    size: 32,
                    line_height: 40
                },
                xl: {
                    size: 24,
                    line_height:32
                },
                lg: {
                    size: 20,
                    line_height:28
                },
                md: {
                    size: 16,
                    line_height: 22
                },
                sm: {
                    size: 14,
                    line_height: 20
                },
                xs: {
                    size: 12,
                    line_height: 16
                }
            },
            size: {
                lg: 40,
                md: 32,
                sm: 24
            }
        });
        
        // 선택 카테고리 드롭박스 기본값
        Set(DEFAULT_SELECT_CATEGORY_VALUE,"----------------------");
        // 조회에는 전체로 표시
        Set(DEFAULT_CATEGORY_VALUE, "전체");
        // ------ GNB 카테고리 메뉴들 설정 시작 ------
        ClearCollect(
            colGNBMenu,
            ForAll(
                Table(ParseJSON('똑실이-[Apps]사용자GNB메뉴목록'.Run(User().Email).output_gnb_menu)),
                {
                    Title: Text(ThisRecord.Value.Title),
                    Menu_LV1: Text(ThisRecord.Value.Menu_LV1)
                }
            )
        );
        
        ClearCollect(
            colGNBMenuLV1,
            ForAll(
                Distinct(
                    colGNBMenu,
                    Menu_LV1
                ),
                {Result: ThisRecord.Value}
            )
        );
        
        ClearCollect(
            colGNBTitle,
            ForAll(
                Distinct(
                    colGNBMenu,
                    Title
                ),
                {제목: ThisRecord.Value}
            )
        );
        // ------ GNB 카테고리 메뉴들 설정 끝 ------
        
        Set(DebugMenuCount, 0);
        
        Set(LodingPopup,true);
        Refresh(똑실이_GNB_MENU);
        
        Concurrent(
            Set(CategoryVal,["*",":","<",">","?","/","\","|",Char(34)]), // 카테고리 폴더명 밸리데이션 체크 변수
            Set(FileVal,["pdf","pptx","ppt","doc","docx","PDF","PPTX","PPT","DOC","DOCX"]),// 업로드 파일 확장자 밸리데이션 체크 변수
            Set(ExcelVal,["xlsx"]), 
        
            //Set(Choi, PlainText(Last(GNB_CUSTOM).imgtest));,
            Set(gnbColor1, Last(똑실이_GNB_CUSTOM).GNBbgColor);,           // gnb 배경색
            Set(LV1Selected1, Last(똑실이_GNB_CUSTOM).LV1SelectedColor);,  // lv1 메뉴 선택시 배경 색
            Set(LV2BGColor1, Last(똑실이_GNB_CUSTOM).LV2bgColor);,        // lv2 메뉴 배경 색
            Set(LV2Selected1, Last(똑실이_GNB_CUSTOM).LV2SelectedColor);,  // lv2 메뉴 선택시 배경색
            Set(Signature1, Last(똑실이_GNB_CUSTOM).SignatureColor);,     // 시그니처 색
            Set(FontColor1, Last(똑실이_GNB_CUSTOM).FontColor);,          // 글자 색
            Set(gnbFont1, Last(똑실이_GNB_CUSTOM).Font);,                 // 글꼴
            Set(FontSize1, Last(똑실이_GNB_CUSTOM).FontSize);,            // 글자 크기
            Set(Logo, Last(똑실이_GNB_CUSTOM.LogoImage));,                // 로고
        
        ForAll(
            똑실이_AzureGroup,
            Collect(
                col_ADGroup,
                AzureAD.GetGroup(Group_ID)
            )
        );
        
        
        ClearCollect(
            NewPortalCollect,
            ShowColumns(
                SortByColumns(똑실이_GNB_MENU, "LV1Order", SortOrder.Ascending),
                "Title",
                "Menu_LV1",
                "LV1Order",
                "LV2Order",
                "ReportURI",
                "ID"
            )
        );,
        
        ClearCollect(NewMACollect, ShowColumns(똑실이_GNB_MENU,"Title","Menu_LV1","LV1Order","LV2Order","ID","Teams","Users"));
        
        Clear(LikeTable);,
        Refresh(똑실이_QA_table);
        
        
        );
        
        
        ForAll(
            Sequence(CountRows(Filter(똑실이_GNB_MENU, IsNumeric(Menu_LV1) || IsBlank(Menu_LV1)))),
            Remove(똑실이_GNB_MENU, First(Filter(똑실이_GNB_MENU, IsNumeric(Menu_LV1) || IsBlank(Menu_LV1))))
        );
        ForAll(
            Sequence(CountRows(Filter(똑실이_GNB_MENU, IsNumeric(제목) || IsBlank(제목)))),
            Remove(똑실이_GNB_MENU, First(Filter(똑실이_GNB_MENU, IsNumeric(제목) || IsBlank(제목))))
        );
        
           Sequence(CountRows(Filter(똑실이_GNB_MENU, IsNumeric(Menu_LV1) || IsBlank(Menu_LV1))));
            Sequence(CountRows(Filter(똑실이_GNB_MENU, IsNumeric(제목) || IsBlank(제목))));
        
        //test
        //Set(Media, AddMediaButton1.Media);
        
        //카테고리 액세스 권환 컬렉션
        ClearCollect(
            Category_Auth, 
            { 
                LV1_Category: "", 
                LV2_Category: "", 
                Email: "" 
            }
        );
        Clear(Category_Auth);
        Set(LodingPopup,false);
        
        Clear(gnbdist);
        Clear(gnbgru);
        ForAll(
            똑실이_GNB_MENU,
            Collect(
                gnbdist,
                ThisRecord.Teams
            )
        );
        ForAll(
            gnbdist,
            If(
                CountRows(
                    Filter(
                        Office365그룹.ListGroupMembers(
                            Mid(
                                ThisRecord.Claims,
                                40
                            )
                        ).value,
                        User().Email in mail
                    )
                ) > 0,
                Collect(
                    gnbgru,
                    {Email: ThisRecord.Email}
                )
            )
        );
        Distinct(
            gnbgru,
            ThisRecord
        );
        
        Set(Filter_LV1LV2,First(똑실이_AgentFunction_table​).Category_LV1LV2);
        Set(Filter_Name,First(똑실이_AgentFunction_table​).Name);
        
        Set(CategoryLV1Select,First(똑실이_Category_table).Category_LV1);
        
        Refresh(똑실이_SuperAdmin_table);
    StartScreen: =QALog
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

