App As appinfo:
    BackEnabled: =false
    OnStart: |+
        =Set(DebugMenuCount, 0);
        
        Set(LodingPopup,true);
        Refresh(똑실이_GNB_MENU);
        
        Concurrent(
            Set(CategoryVal,["*",":","<",">","?","/","\","|",Char(34)]), // 카테고리 폴더명 밸리데이션 체크 변수
            Set(FileVal,["pdf","pptx","ppt","doc","docx","PDF","PPTX","PPT","DOC","DOCX"]),// 업로드 파일 확장자 밸리데이션 체크 변수
            Set(ExcelVal,["xlsx"]), 
        
            //Set(Choi, PlainText(Last(GNB_CUSTOM).imgtest));,
            Set(gnbColor1, Last(똑실이_GNB_CUSTOM).GNBbgColor);,           // gnb 배경색
            Set(LV1Selected1, Last(똑실이_GNB_CUSTOM).LV1SelectedColor);,  // lv1 메뉴 선택시 배경 색
            Set(LV2BGColor1, Last(똑실이_GNB_CUSTOM).LV2bgColor);,        // lv2 메뉴 배경 색
            Set(LV2Selected1, Last(똑실이_GNB_CUSTOM).LV2SelectedColor);,  // lv2 메뉴 선택시 배경색
            Set(Signature1, Last(똑실이_GNB_CUSTOM).SignatureColor);,     // 시그니처 색
            Set(FontColor1, Last(똑실이_GNB_CUSTOM).FontColor);,          // 글자 색
            Set(gnbFont1, Last(똑실이_GNB_CUSTOM).Font);,                 // 글꼴
            Set(FontSize1, Last(똑실이_GNB_CUSTOM).FontSize);,            // 글자 크기
            Set(Logo, Last(똑실이_GNB_CUSTOM.LogoImage));,                // 로고
        
        ForAll(
            똑실이_AzureGroup,
            Collect(
                col_ADGroup,
                AzureAD.GetGroup(Group_ID)
            )
        );
        
        ClearCollect(
            NewPortalCollect,
            ShowColumns(
                SortByColumns(똑실이_GNB_MENU, "LV1Order", SortOrder.Ascending),
                "Title",
                "Menu_LV1",
                "LV1Order",
                "LV2Order",
                "ReportURI",
                "ID"
            )
        );,
        
        ClearCollect(NewMACollect, ShowColumns(똑실이_GNB_MENU,"Title","Menu_LV1","LV1Order","LV2Order","ID","Teams","Users"));
        
        Clear(LikeTable);,
        Refresh(똑실이_QA_table);
        
        
        );
        
        
        ForAll(
            Sequence(CountRows(Filter(똑실이_GNB_MENU, IsNumeric(Menu_LV1) || IsBlank(Menu_LV1)))),
            Remove(똑실이_GNB_MENU, First(Filter(똑실이_GNB_MENU, IsNumeric(Menu_LV1) || IsBlank(Menu_LV1))))
        );
        ForAll(
            Sequence(CountRows(Filter(똑실이_GNB_MENU, IsNumeric(제목) || IsBlank(제목)))),
            Remove(똑실이_GNB_MENU, First(Filter(똑실이_GNB_MENU, IsNumeric(제목) || IsBlank(제목))))
        );
        
           Sequence(CountRows(Filter(똑실이_GNB_MENU, IsNumeric(Menu_LV1) || IsBlank(Menu_LV1))));
            Sequence(CountRows(Filter(똑실이_GNB_MENU, IsNumeric(제목) || IsBlank(제목))));
        
        //test
        //Set(Media, AddMediaButton1.Media);
        
        //카테고리 액세스 권환 컬렉션
        ClearCollect(
            Category_Auth, 
            { 
                LV1_Category: "", 
                LV2_Category: "", 
                Email: "" 
            }
        );
        Clear(Category_Auth);
        Set(LodingPopup,false);
        
        Clear(gnbdist);
        Clear(gnbgru);
        ForAll(
            똑실이_GNB_MENU,
            Collect(
                gnbdist,
                ThisRecord.Teams
            )
        );
        ForAll(
            gnbdist,
            If(
                CountRows(
                    Filter(
                        Office365그룹.ListGroupMembers(
                            Mid(
                                ThisRecord.Claims,
                                40
                            )
                        ).value,
                        User().Email in mail
                    )
                ) > 0,
                Collect(
                    gnbgru,
                    {Email: ThisRecord.Email}
                )
            )
        );
        Distinct(
            gnbgru,
            ThisRecord
        );
        
        Set(Filter_LV1LV2,First(똑실이_AgentFunction_table​).Category_LV1LV2);
        Set(Filter_Name,First(똑실이_AgentFunction_table​).Name);
        
        Set(CategoryLV1Select,First(똑실이_Category_table).Category_LV1)
        
        
    StartScreen: =QALog
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

