MAMenu As screen:
    BackgroundImage: =                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
    Fill: =RGBA(245, 245, 245, 1)
    Height: =
    LoadingSpinnerColor: =RGBA(105, 121, 126, 1)
    OnVisible: |-
        =Concurrent(
        Set(SubMenuPopup,false);,
        UpdateContext({menuPopupVi:false});,
        UpdateContext({menuTeamPopupVi:false});
        );
        
        
        UpdateContext({testHight:CountRows(
            ForAll(Distinct(SortByColumns(Filter(똑실이_GNB_MENU, Menu_LV1<>Blank()), "LV1Order", SortOrder.Ascending), Menu_LV1), {Result: ThisRecord.Value})
        ) * 80});
        
        Concurrent(
        Set(ZoomLV1, "");,
        Set(testVisible, "");,
        Set(SelectedLV1, "");,
        Set(SelectedLV2, "");,
        Set(AddTeamPopup, false);,
        
        Set(EditUserVisibleVal, false);,
        ClearCollect(NewMACollect, ShowColumns(똑실이_GNB_MENU,"Title","Menu_LV1","LV1Order","LV2Order","Users","ID","Team_ID","Teams"));,
        Clear(NewPortalCollect);
        );
        
        ClearCollect(
            Namelist,
            Filter(
                Office365사용자.SearchUser(
                    {
                        top: 999
                    }
                ),
                AccountEnabled = true
            )
        );
        
        /*
        ClearCollect(
            Departmentlist,
            Distinct(
                ShowColumns(
                    'Office365사용자'.SearchUser(
                        {
                            searchTerm2: TextInput_ShearchTeam_MAMenu_1.Text,
                            top: 999
                        }
                    ),
                    "Department"
                ),
                Department
            )
        );
        */
    Width: =

    Rectangle_MAMenuHeader_MAMenu As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        Fill: =RGBA(112, 112, 112, 1)
        Height: =1
        Visible: =false
        Width: =Parent.Width - New_Component_GNB_MAMenu.Width
        X: =New_Component_GNB_gnbMenu.Width
        Y: =100
        ZIndex: =2

    Gallery_Main_MAMenu As gallery.variableTemplateHeightGallery:
        BorderColor: =RGBA(255, 255, 255, 1)
        Fill: =RGBA(255, 255, 255, 1)
        Height: =845
        Items: |-
            =ForAll(Distinct(SortByColumns(똑실이_GNB_MENU, "LV1Order", SortOrder.Ascending), Menu_LV1), {Result: ThisRecord.Value})
            //SortByColumns(GNB_MENU, "LV1Order", Ascending)
        Layout: =Layout.Vertical
        LoadingSpinnerColor: =RGBA(0, 18, 107, 1)
        OnSelect: |-
            =Set(SelectedLV2,"");
            Set(SelectedLV1, ThisItem.Result);
            If(ThisItem.IsSelected && testV<>ThisItem.Result,UpdateContext({testV:ThisItem.Result}),UpdateContext({testV:""}));
            
            If(ThisItem.Result=SelectedLV1, //Checkbox1.Value,
            Set(CheckedLV1, ThisItem.Result);
            Set(CheckedLV1Order, LookUp(똑실이_GNB_MENU, Menu_LV1=ThisItem.Result, LV1Order));
            Set(CheckedRemarks, LookUp(똑실이_GNB_MENU, Menu_LV1=ThisItem.Result, Remarks));
            Set(CheckedID, LookUp(똑실이_GNB_MENU, Menu_LV1=ThisItem.Result, ID));,
            
            Set(CheckedLV1, Blank());
            Set(CheckedLV2, Blank());
            Set(CheckedLV1Order, Blank());
            Set(CheckedLV2Order, Blank());
            Set(CheckedReportURI, Blank());
            Set(CheckedRemarks, Blank());
            Set(CheckedID, Blank());
            );
            
            Set(FirstLV1Order, First(SortByColumns(똑실이_GNB_MENU,"LV1Order")).LV1Order);
            Set(PrevLV1Order, CheckedLV1Order-1);
            Set(NextLV1Order, CheckedLV1Order+1);
            Set(LastLV1Order, Last(SortByColumns(똑실이_GNB_MENU,"LV1Order")).LV1Order);
            Set(BlankLV1Order, LastLV1Order +1);
            If(ZoomLV1<>ThisItem.Result, Set(ZoomLV1,ThisItem.Result), Set(ZoomLV1, ""));
            If(testVisible<>ThisItem.Result ,Set(testVisible,ThisItem.Result), Set(testVisible,""));
            If(testVisible="",
            If(ThisItem.IsSelected, UpdateContext({ testHight: 
            CountRows(
                ForAll(Distinct(SortByColumns(똑실이_GNB_MENU, "LV1Order", SortOrder.Ascending), Menu_LV1), {Result: ThisRecord.Value})
            ) * 80})),
            
            UpdateContext({ testHight:
                CountRows(
                    ForAll(Distinct(SortByColumns(똑실이_GNB_MENU, "LV1Order", SortOrder.Ascending), Menu_LV1), {Result: ThisRecord.Value})
                ) * 80 + 
                CountRows(
                    Filter(
                        똑실이_GNB_MENU, Menu_LV1=ZoomLV1
                    )
                ) * 80 + 75}));
            //Select(TextInput4)
            Set(SelectedLV1, "");
            Set(SelectedLV2, "");
        ShowScrollbar: =false
        TemplatePadding: =0
        TemplateSize: |-
            =If(
                Gallery_Sub_MAMenu.Visible=true,
                CountRows(
                    Filter(
                        똑실이_GNB_MENU, Menu_LV1=ZoomLV1
                    )
                ) * 75 + 72,
                500
            )
        Width: =1500
        X: =360
        Y: =175
        ZIndex: =3

        Gallery_Sub_MAMenu As gallery.variableTemplateHeightGallery:
            BorderColor: =RGBA(166, 166, 166, 1)
            Height: |-
                =If(
                    testVisible=ThisItem.Result,
                    CountRows(
                        Filter(
                            똑실이_GNB_MENU,
                            Menu_LV1 = ThisItem.Result
                        )
                    ) * 80,
                    0
                )
                
                
                
                /*CountRows(
                    Filter(
                        GNB_MENU,
                        LV1 = ThisItem.Result
                    )
                ) * 75.835
                */
                
                /*If(
                    testVisible=ThisItem.Result,
                    CountRows(
                        Filter(
                            GNB_MENU,
                            LV1 = ThisItem.Result
                        )
                    ) * 75,
                    0
                )*/
                
                
                
                /*ForAll(
                    Sequence(CountRows(Filter(NewMACollect, OData__x004c_V1=ThisItem.Result))),
                    Sum(
                );*/
            Items: =SortByColumns(Filter(똑실이_GNB_MENU, Menu_LV1=ThisItem.Result), "LV2Order", SortOrder.Ascending)
            Layout: =Layout.Vertical
            OnSelect: |
                =Set(SelectedLV2,ThisItem.제목);
                Set(SelectedLV1, "");
                
                If(ThisItem.제목=SelectedLV2, //Checkbox5.Value,
                Set(CheckedLV1, ThisItem.Menu_LV1);
                Set(CheckedLV2, ThisItem.제목);
                Set(CheckedLV1Order, ThisItem.LV1Order);
                Set(CheckedLV2Order, ThisItem.LV2Order);
                Set(CheckedReportURI, ThisItem.ReportURI);
                Set(CheckedRemarks, ThisItem.Remarks);
                Set(CheckedID, ThisItem.ID);,
                
                Set(CheckedLV1, Blank());
                Set(CheckedLV2, Blank());
                Set(CheckedLV1Order, Blank());
                Set(CheckedLV2Order, Blank());
                Set(CheckedReportURI, Blank());
                Set(CheckedRemarks, Blank());
                Set(CheckedID, Blank());
                );
                
                Set(FirstLV2Order, First(SortByColumns(Filter(똑실이_GNB_MENU, Menu_LV1=CheckedLV1),"LV2Order")).LV2Order);
                Set(PrevLV2Order, CheckedLV2Order-1);
                Set(NextLV2Order, CheckedLV2Order+1);
                Set(LastLV2Order, Last(SortByColumns(Filter(똑실이_GNB_MENU, Menu_LV1=CheckedLV1),"LV2Order")).LV2Order);
                Set(BlankLV2Order, LastLV2Order +1);
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: |-
                =77
                /*
                CountRows(
                    Filter(
                        GNB_MENU,
                        LV1 = ThisItem.Result
                    )
                ) * 72
                */
            Visible: =If(testVisible=ThisItem.Result, true, false)
            Width: =Parent.Width
            Y: =72
            ZIndex: =2

            Button_SubGalleryBody_MAMenu As button:
                BorderColor: =If(ThisItem.IsSelected,RGBA(15, 108, 189, 1), RGBA(224, 224, 224, 1))
                BorderThickness: =1
                DisabledBorderColor: |-
                    =ColorValue("#D1D1D1")
                DisabledColor: |-
                    =ColorValue("#FFFFFF")
                DisabledFill: |-
                    =ColorValue("#FFFFFF")
                Fill: =If(ThisItem.IsSelected,RGBA(235,243,252,1),RGBA(255, 255, 255, 1))
                FocusedBorderColor: =RGBA(15, 108, 189, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =64
                HoverBorderColor: =RGBA(15, 108, 189, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =
                OnSelect: =
                PressedBorderColor: =RGBA(15, 108, 189, 1)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =RGBA(255, 255, 255, 1)
                Size: =15
                Text: =""
                Width: =1420
                X: =40
                Y: =4
                ZIndex: =1

            TextInput_MenuTeamBack_MenuList As text:
                BorderColor: =RGBA(224, 224, 224, 1)
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                Default: =
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =32
                HoverBorderColor: =RGBA(224, 224, 224, 1)
                HoverColor: =RGBA(51, 51, 51, 1)
                HoverFill: =RGBA(255, 255, 255, 1)
                OnSelect: =Select(Parent)
                PressedBorderColor: =RGBA(105, 121, 126, 1)
                PressedColor: =RGBA(51, 51, 51, 1)
                PressedFill: =RGBA(255, 255, 255, 1)
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                Size: =13
                Width: =510
                X: =846
                Y: =20
                ZIndex: =2

            TextInput_SubMenuName_MAMenu As text:
                BorderColor: =RGBA(224, 224, 224, 1)
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                Default: |-
                    =If(
                        ThisItem.제목=LookUp(똑실이_GNB_MENU, Menu_LV1=ThisItem.제목, LV1Order) || IsNumeric(ThisItem.제목),
                        Blank(),
                        ThisItem.제목
                    )
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                FocusedBorderThickness: =4
                Height: =32
                HintText: |-
                    =If(
                        IsNumeric(ThisItem.Menu_LV1),
                        "새 메뉴",
                        ThisItem.Menu_LV1
                    )
                HoverBorderColor: =RGBA(224, 224, 224, 1)
                HoverColor: =RGBA(51, 51, 51, 1)
                HoverFill: =RGBA(255, 255, 255, 1)
                Mode: =TextMode.MultiLine
                OnChange: =
                OnSelect: |-
                    =//If(SelectedLV2<>ThisItem.Title, Set(SelectedLV2,ThisItem.Title), Set(SelectedLV2, ""));
                    Set(SelectedLV2,ThisItem.제목);
                    Set(SelectedLV1, "");
                    Select(Parent)
                PaddingLeft: =15
                PressedBorderColor: =RGBA(105, 121, 126, 1)
                PressedColor: =RGBA(51, 51, 51, 1)
                PressedFill: =RGBA(255, 255, 255, 1)
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                Size: =13
                Width: =250
                X: =63
                Y: =20
                ZIndex: =3

            Label_ComplateUsersName_MAMenu As label:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Height: =32
                OnSelect: =Select(Parent)
                PaddingLeft: =10
                Size: =13
                Text: |-
                    =//Concat(ThisItem.'Users (Users0)', DisplayName & " ( " & Email & " ) ", ",                                                  ")
                    //Concat(MyPeople, DisplayName & " ( " & Mail & " ) ", ",                                                                    ")
                    //Concat(LookUp(NewMACollect, Title=If(__CheckedLV2<>ThisItem.Title, ThisItem.Title, __CheckedLV2), Users0), DisplayName & " (" & Email & ")", ",                     ")
                    If(
                        CountRows(
                            LookUp(
                                NewMACollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Users
                            )
                        ) > 1,
                        First(
                            LookUp(
                                NewMACollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Users
                            )
                        ).DisplayName & " 외" & Int(
                            CountRows(
                                LookUp(
                                    NewMACollect,
                                    Title = If(
                                        CheckedLV2 <> ThisItem.제목,
                                        ThisItem.제목,
                                        CheckedLV2
                                    ),
                                    Users
                                )
                            )
                        ) - 1 & "명",
                        First(
                            LookUp(
                                NewMACollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Users
                            )
                        ).DisplayName
                    )
                Width: =510
                Wrap: =false
                X: =846
                Y: =20
                ZIndex: =4

            TextInput_MenuTeamBack_MAMenu As text:
                BorderColor: =RGBA(224, 224, 224, 1)
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                Default: =
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =32
                HoverBorderColor: =RGBA(224, 224, 224, 1)
                HoverColor: =RGBA(51, 51, 51, 1)
                HoverFill: =RGBA(255, 255, 255, 1)
                OnSelect: =Select(Parent)
                PressedBorderColor: =RGBA(224, 224, 224, 1)
                PressedColor: =RGBA(51, 51, 51, 1)
                PressedFill: =RGBA(255, 255, 255, 1)
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                Size: =13
                Width: =430
                X: =322
                Y: =20
                ZIndex: =7

            Label_ComplateTeamName2_MAMenu As label:
                BorderColor: =RGBA(179, 179, 179, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Height: =32
                OnSelect: =Select(Parent)
                Overflow: =Overflow.Scroll
                PaddingLeft: =10
                Size: =13
                Text: |-
                    =If(
                        CountRows(LookUp(NewMACollect,ID=ThisItem.ID).Teams) = 0 || IsBlank(LookUp(NewMACollect,ID=ThisItem.ID).Teams),
                        "팀을 할당해 주세요",
                        CountRows(LookUp(NewMACollect,ID=ThisItem.ID).Teams) > 1,
                        First(LookUp(NewMACollect,ID=ThisItem.ID).Teams).DisplayName & " 외" & CountRows(LookUp(NewMACollect,ID=ThisItem.ID).Teams) - 1 & " 명",
                        First(LookUp(NewMACollect,ID=ThisItem.ID).Teams).DisplayName
                    )
                    
                    /*
                    If(
                        LookUp(NewMACollect,ID=ThisItem.ID).TeamName = "" || LookUp(NewMACollect,ID=ThisItem.ID).TeamName = Blank(),
                        "팀을 할당해 주세요",
                        CountRows(
                            Split(
                                LookUp(
                                    NewMACollect,
                                    ID = ThisItem.ID
                                ).TeamName,
                                ","
                            )
                        ) > 1,
                        First(
                            Split(
                                LookUp(
                                    NewMACollect,
                                    ID = ThisItem.ID
                                ).TeamName,
                                ","
                            )
                        ).Value & " 외" & CountRows(
                            Split(
                                LookUp(
                                    NewMACollect,
                                    ID = ThisItem.ID
                                ).TeamName,
                                ","
                            )
                        ) - 1 & " 팀",
                        LookUp(
                            NewMACollect,
                            ID = ThisItem.ID
                        ).TeamName
                    )
                    */
                Width: =430
                X: =322
                Y: =20
                ZIndex: =8

            Label_ComplateTeamName_MAMenu As label:
                BorderColor: =RGBA(179, 179, 179, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Height: =32
                OnSelect: =
                Overflow: =Overflow.Scroll
                PaddingLeft: =10
                Size: =13
                Text: =
                Width: =250
                X: =63
                Y: =20
                ZIndex: =9

            Image_TeamSerch2_MAMenu As image:
                BorderColor: |-
                    =ColorValue("#D1D1D1")
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =32
                HoverBorderColor: |-
                    =ColorValue("#D1D1D1")
                HoverFill: |-
                    =ColorValue("#F5F5F5")
                Image: =Icon_AddTeamCheck
                OnSelect: |-
                    =UpdateContext({menuTeamPopupVi:true});
                    UpdateContext({menuSelected:ThisItem.ID});
                    
                    ClearCollect(viewTeamName_Menu, LookUp(NewMACollect,ID=ThisItem.ID).Teams);
                PressedBorderColor: |-
                    =ColorValue("#D1D1D1")
                PressedFill: |-
                    =ColorValue("#E0E0E0")
                RadiusBottomLeft: =010
                RadiusBottomRight: =010
                RadiusTopLeft: =010
                RadiusTopRight: =010
                Width: =32
                X: =762
                Y: =20
                ZIndex: =10

            Image_Addteam2_MAMenu As image:
                BorderColor: |-
                    =ColorValue("#D1D1D1")
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                DisplayMode: =If(ThisItem.IsSelected=true,DisplayMode.Edit,DisplayMode.Disabled)
                FocusedBorderThickness: =4
                Height: =32
                HoverBorderColor: |-
                    =ColorValue("#D1D1D1")
                HoverFill: |-
                    =ColorValue("#F5F5F5")
                Image: =Icon_AddTeam
                OnSelect: |-
                    =
                    /*
                    UpdateContext({menuPopupVi:true});
                    UpdateContext({menuSelected:ThisItem.ID});
                    ClearCollect(viewTeamName_Menu, LookUp(NewMACollect,ID=ThisItem.ID).Teams);
                    */
                    
                    UpdateContext({menuPopupVi:true});
                    UpdateContext({menuSelected: ThisItem.ID});
                    ClearCollect(viewTeamName_Menu,LookUp(NewMACollect, ID= ThisItem.ID).Teams);
                    ClearCollect(
                        MAMenu_Groups,
                        ForAll(
                            Table(ParseJSON('똑실이-[Apps]오피스365그룹검색'.Run("").output)),
                            {
                                id: ThisRecord.Value.id,
                                mail: Text(ThisRecord.Value.mail),
                                displayName: Text(ThisRecord.Value.displayName),
                                securityEnabled: Text(ThisRecord.Value.securityEnabled),
                                is365: Text(ThisRecord.Value.is365)
                            }
                        )
                    )
                PressedBorderColor: |-
                    =ColorValue("#D1D1D1")
                PressedFill: |-
                    =ColorValue("#E0E0E0")
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                Transparency: =If(Image_Addteam2_MAMenu.DisplayMode = DisplayMode.Disabled,0.7,0)
                Width: =32
                X: =804
                Y: =20
                ZIndex: =11

            Image_TeamSerch_MAMenu As image:
                BorderColor: |-
                    =ColorValue("#D1D1D1")
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =32
                HoverBorderColor: |-
                    =ColorValue("#D1D1D1")
                HoverFill: |-
                    =ColorValue("#F5F5F5")
                Image: =Icon_AddTeamCheck
                OnSelect: |-
                    =Select(Parent);
                    Collect(adminUser, LookUp(NewMACollect, ID= ThisItem.ID).Users);
                    Set(MAMode, "Search");
                    Set(EditUserVisibleVal, true);
                    //ClearCollect(MyPeople,RenameColumns( ThisItem.'Users (Users0)', "Email", "UserPrincipalName"));
                    //ClearCollect(MyPeople, ThisItem.'Users (Users0)');
                PressedBorderColor: |-
                    =ColorValue("#D1D1D1")
                PressedFill: |-
                    =ColorValue("#E0E0E0")
                RadiusBottomLeft: =010
                RadiusBottomRight: =010
                RadiusTopLeft: =010
                RadiusTopRight: =010
                Width: =32
                X: =1366
                Y: =20
                ZIndex: =12

            Image_Addteam_MAMenu As image:
                BorderColor: |-
                    =ColorValue("#D1D1D1")
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                DisplayMode: =If(ThisItem.IsSelected=true,DisplayMode.Edit,DisplayMode.Disabled)
                FocusedBorderThickness: =4
                Height: =32
                HoverBorderColor: |-
                    =ColorValue("#D1D1D1")
                HoverFill: |-
                    =ColorValue("#F5F5F5")
                Image: =Icon_AddTeam
                OnSelect: |-
                    =Select(Parent);
                    Clear(adminUser);
                    //ClearCollect(MyPeople,RenameColumns( LookUp(NewMACollect, Title=ThisItem.Title, Users0), "Email", "UserPrincipalName"));
                    Set(MAMode, "Add");
                    Set(EditUserVisibleVal, true);
                    Collect(adminUser, LookUp(NewMACollect, ID= ThisItem.ID).Users);
                PressedBorderColor: |-
                    =ColorValue("#D1D1D1")
                PressedFill: |-
                    =ColorValue("#E0E0E0")
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                Transparency: =If(Image_Addteam2_MAMenu.DisplayMode = DisplayMode.Disabled,0.7,0)
                Width: =32
                X: =1409
                Y: =20
                ZIndex: =13

        Image_GNBMenuGallery_MAMenu As image:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =20
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverFill: =RGBA(0, 0, 0, 0)
            Image: =Icon_galleryOn
            ImageRotation: |
                =//If(ThisItem.Result=testV,ImageRotation.Rotate180,ImageRotation.None)
                
                If(Gallery_Sub_MAMenu.Visible= true,ImageRotation.Rotate180,ImageRotation.None)
            OnSelect: =
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedFill: =RGBA(0, 0, 0, 0)
            Width: =20
            X: =18
            Y: =23
            ZIndex: =5

        TextInput_Main_LV1_MAMenu As text:
            BorderColor: =RGBA(166, 166, 166, 1)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            Default: =ThisItem.Result
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            DisplayMode: =DisplayMode.View
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverColor: =RGBA(51, 51, 51, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            OnChange: =
            OnSelect: =Select(Parent)
            PressedBorderColor: =RGBA(105, 121, 126, 1)
            PressedColor: =RGBA(51, 51, 51, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =10
            RadiusBottomRight: =10
            RadiusTopLeft: =10
            RadiusTopRight: =10
            Width: =400
            X: =38
            Y: =12
            ZIndex: =6

        Rectangle_MainGallery_MAMenu As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(224, 224, 224, 1)
            FocusedBorderThickness: =4
            Height: =1
            HoverFill: =RGBA(224, 224, 224, 1)
            OnSelect: =
            PressedFill: =RGBA(224, 224, 224, 1)
            Width: =1463
            X: =38
            Y: =61
            ZIndex: =7

        Button_Select_MAMenu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =61
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =
            OnSelect: =Select(Parent)
            PressedBorderColor: =
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: =""
            Width: =1500
            ZIndex: =8

    Label_MAMenuTitle_MAMenu As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        FontWeight: =FontWeight.Bold
        Height: =64
        Size: =30
        Text: ="권한관리"
        Width: =393
        X: =343
        Y: =23
        ZIndex: =4

    Button_ViewTeamMembers_MAMenu As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(105, 121, 126, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
        OnSelect: |
            =Clear(
                        LookUp(
                        NewMACollect,
                        ID = CheckedID,
                        Teams
                    )
                );
            
            Set(Ok, false);
            Set(AddTeamPopup, false);
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =15
        Text: ="확인"
        Visible: =Ok
        X: =854
        Y: =723
        ZIndex: =5

    Button_MAMenuSAVEPatch_MAMenu As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderThickness: =1
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: |-
            =ColorValue("#0F6CBD")
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FocusedBorderThickness: =2
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: |-
            =ColorValue("#115EA3")
        OnSelect: |+
            =Patch(
                똑실이_GNB_MENU,
                NewMACollect
            );
            
            // GNB 새로고침
            ClearCollect(
                colGNBMenu,
                ForAll(
                    Table(ParseJSON('[Dev]똑실이-[Apps]사용자GNB메뉴목록_V2'.Run(User().Email).output_gnb_menu)),
                    {
                        Title: Text(ThisRecord.Value.Title),
                        Menu_LV1: Text(ThisRecord.Value.Menu_LV1)
                    }
                )
            );
            
            ClearCollect(
                colGNBMenuLV1,
                ForAll(
                    Distinct(
                        colGNBMenu,
                        Menu_LV1
                    ),
                    {Result: ThisRecord.Value}
                )
            );
            
            ClearCollect(
                colGNBTitle,
                ForAll(
                    Distinct(
                        colGNBMenu,
                        Title
                    ),
                    {제목: ThisRecord.Value}
                )
            );
            
            Notify(
                    "저장완료.",
                    NotificationType.Success,
                    5000
                );
            ClearCollect(NewMACollect, ShowColumns(똑실이_GNB_MENU,"Title","Menu_LV1","LV1Order","LV2Order","Users","ID","Teams"));
            ClearCollect(TeamMACollect,ShowColumns(똑실이_GNB_MENU,"Title","Menu_LV1","LV1Order","LV2Order","Users","ID","Teams"));
            UpdateContext({ testHight:
                CountRows(
                ForAll(Distinct(SortByColumns(똑실이_GNB_MENU, "LV1Order", SortOrder.Ascending), Menu_LV1), {Result: ThisRecord.Value})
            ) * 80 });
            //Select(TextInput4)
            Set(ZoomLV1, "");
            Set(testVisible, "");
            Set(SelectedLV1, "");
            Set(SelectedLV2, "");
            
            
        PaddingLeft: =40
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: |-
            =ColorValue("#0C3B5E")
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Size: =14
        Text: ="Save"
        Width: =121
        X: =1751
        Y: =40
        ZIndex: =6

    Image_MAMenuSave_MAMenu As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =25
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =IconSave
        OnSelect: =Select(Button_MAMenuSAVEPatch_MAMenu)
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =25
        X: =1774
        Y: =48
        ZIndex: =7

    New_Component_GNB_MAMenu As New_Component_GNB:
        ZIndex: =8

    Label_MenuList_MAMenu As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Size: =16
        Text: ="●  Menu List"
        Width: =178
        X: =356
        Y: =128
        ZIndex: =9

    Button_Refresh_MAMenu As button:
        BorderColor: |-
            =ColorValue("#D1D1D1")
        BorderThickness: =1
        Color: =RGBA(0, 0, 0, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: |-
            =ColorValue("#FFFFFF")
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FocusedBorderThickness: =2
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        HoverBorderColor: |-
            =ColorValue("#C7C7C7")
        HoverColor: |-
            =ColorValue("#242424")
        HoverFill: |-
            =ColorValue("#F5F5F5")
        OnSelect: |-
            =// GNB 새로고침
            ClearCollect(
                colGNBMenu,
                ForAll(
                    Table(ParseJSON('[Dev]똑실이-[Apps]사용자GNB메뉴목록_V2'.Run(User().Email).output_gnb_menu)),
                    {
                        Title: Text(ThisRecord.Value.Title),
                        Menu_LV1: Text(ThisRecord.Value.Menu_LV1)
                    }
                )
            );
            
            ClearCollect(
                colGNBMenuLV1,
                ForAll(
                    Distinct(
                        colGNBMenu,
                        Menu_LV1
                    ),
                    {Result: ThisRecord.Value}
                )
            );
            
            ClearCollect(
                colGNBTitle,
                ForAll(
                    Distinct(
                        colGNBMenu,
                        Title
                    ),
                    {제목: ThisRecord.Value}
                )
            );
            
            Refresh(똑실이_GNB_MENU);
        PaddingLeft: =30
        PressedBorderColor: |-
            =ColorValue("#B3B3B3")
        PressedColor: =Color.Black
        PressedFill: |-
            =ColorValue("#E0E0E0")
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Size: =11
        Text: ="새로고침"
        Width: =121
        X: =1600
        Y: =40
        ZIndex: =10

    Image_Refresh_MAMenu As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =20
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =TokenMenuRefresh
        OnSelect: =Select(Button_Refresh_MAMenu)
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =20
        X: =1617
        Y: =50
        ZIndex: =11

    Background_Modal_MAMenu As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledFill: =
        Fill: =RGBA(0, 0, 0, 0.2)
        FocusedBorderThickness: =4
        Height: =1080
        HoverFill: =
        PressedFill: =
        Visible: =menuPopupVi Or menuTeamPopupVi Or EditUserVisibleVal 
        Width: =1620
        X: =300
        ZIndex: =12

    Group_EditGroup_MAMenu As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =58

        Rectangle_EditGroupBody_MAMenu As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderThickness: =1
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =720
            OnSelect: =
            Visible: =menuTeamPopupVi
            Width: =600
            X: =841
            Y: =168
            ZIndex: =13

        Button_EditGroupSave_MAMenu As button:
            AutoDisableOnSelect: =false
            BorderColor: =RGBA(224, 224, 224, 1)
            BorderThickness: =1
            Color: |-
                =ColorValue("#FFFFFF")
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: |-
                =ColorValue("#0F6CBD")
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: |-
                =ColorValue("#FFFFFF")
            HoverFill: |-
                =ColorValue("#115EA3")
            OnSelect: |
                =Patch(
                    NewMACollect,
                    LookUp(
                        NewMACollect,
                        ID = menuSelected
                    ),
                    {
                        Teams: viewTeamName_Menu
                    }
                );
                UpdateContext({resetSearch: true});
                UpdateContext({resetSearch: false});
                UpdateContext({menuTeamPopupVi:false});
                Clear(viewTeamName_Menu);
            PressedBorderColor: =
            PressedColor: |-
                =ColorValue("#FFFFFF")
            PressedFill: |-
                =ColorValue("#0C3B5E")
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Size: =15
            Text: ="확인"
            Visible: =menuTeamPopupVi
            Width: =96
            X: =1215
            Y: =826
            ZIndex: =14

        Button_EditGroupCancel_MAMenu As button:
            AutoDisableOnSelect: =false
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: |-
                =ColorValue("#B3B3B3")
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: |-
                =ColorValue("#C7C7C7")
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: |-
                =ColorValue("#F5F5F5")
            OnSelect: |-
                =UpdateContext({menuTeamPopupVi:false});
                Clear(viewTeamName_Menu);
            PressedBorderColor: |-
                =ColorValue("#B3B3B3")
            PressedColor: =RGBA(0, 0, 0, 1)
            PressedFill: |-
                =ColorValue("#E0E0E0")
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Size: =15
            Text: ="취소"
            Visible: =menuTeamPopupVi
            Width: =96
            X: =1322
            Y: =826
            ZIndex: =15

        Gallery_EditGroup_MAMenu As gallery.SelectedUsersTabletGallery:
            AccessibleLabel: ="사용자가 사람을 선택함"
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            Fill: |-
                =ColorValue("#FAFAFA")
            Height: =488
            Items: =Search(viewTeamName_Menu,TextInput_EditGroup_MAMenu.Text,"DisplayName")
            Layout: =Layout.Vertical
            OnSelect: =
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =57
            Visible: =menuTeamPopupVi
            Width: =552
            X: =865
            Y: =321
            ZIndex: =16

            Button_EditGroupName_MAMenu As button:
                BorderColor: =If(ThisItem.IsSelected,RGBA(15, 108, 189, 1), RGBA(0, 0, 0, 0))
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =If(ThisItem.IsSelected,RGBA(235,243,252,1),RGBA(255, 255, 255, 1))
                FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =48
                HoverBorderColor: =RGBA(15, 108, 189, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =
                OnSelect: =
                PressedBorderColor: =RGBA(15, 108, 189, 1)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =
                RadiusBottomLeft: =8
                RadiusBottomRight: =8
                RadiusTopLeft: =8
                RadiusTopRight: =8
                Size: =15
                Text: =""
                Width: =504
                X: =24
                Y: =9
                ZIndex: =2

            Label__EditGroupName_MAMenu As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =52
                OnSelect: =
                PaddingLeft: =10
                Size: =13
                Text: =ThisItem.DisplayName
                Width: =380
                X: =100
                Y: =5
                ZIndex: =3

            Icon_EditGroupRemove_MAMenu As icon.Add:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =25
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Cancel
                OnSelect: |-
                    =Remove(viewTeamName_Menu,ThisItem);
                        Notify(
                            "팀 제거 완료.",
                            NotificationType.Success,
                            5000
                        )
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =25
                X: =485
                Y: =20
                ZIndex: =4

            Label_Prefix_GroupName_MAMenu As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                OnSelect: =Select(Parent)
                Size: =13
                Text: |-
                    =If(StartsWith(ThisItem.Claims,"c:0o.c|federateddirectoryclaimprovider|"), "M365", " AD")
                Width: =70
                X: =40
                Y: =11
                ZIndex: =5

        Rectangle_EditGroupHeader_MAMenu As rectangle:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            DisabledFill: =RGBA(0,0,0,0)
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(0,0,0,0)
            FocusedBorderThickness: =4
            Height: =88
            HoverFill: =RGBA(0,0,0,0)
            PressedFill: =RGBA(0,0,0,0)
            Visible: =menuTeamPopupVi
            Width: =552
            X: =865
            Y: =233
            ZIndex: =26

        Label_EditGroupHeader_MAMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =16
            Text: ="할당 그룹"
            Visible: =menuTeamPopupVi
            X: =865
            Y: =184
            ZIndex: =27

        TextInput_EditGroup_MAMenu As text:
            Align: =TextPosition.Left
            BorderColor: |-
                =ColorValue("#D1D1D1")
            Default: =""
            FocusedBorderThickness: =1
            HintText: ="검색"
            OnSelect: =
            PaddingLeft: =15
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Reset: =resetSearch
            Visible: =menuTeamPopupVi
            X: =891
            Y: =257
            ZIndex: =28

        Icon_EditGroup_MAMenu As icon.Search:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(105, 121, 126, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =TextInput_EditGroup_MAMenu.Height-10
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Search
            OnSelect: =
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =menuTeamPopupVi
            Width: =Self.Height
            X: =1172
            Y: =263
            ZIndex: =29

    Group_AddGroup_MAMenu As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =59

        Rectangle_AddGroup_MAMenu As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderThickness: =2
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =720
            OnSelect: =
            Visible: =menuPopupVi
            Width: =600
            X: =836
            Y: =175
            ZIndex: =22

        Button_AddGroupSave_MAMenu As button:
            AutoDisableOnSelect: =false
            BorderColor: =RGBA(224, 224, 224, 1)
            BorderThickness: =1
            Color: |-
                =ColorValue("#FFFFFF")
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: |-
                =ColorValue("#0F6CBD")
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: |-
                =ColorValue("#115EA3")
            OnSelect: |
                =Patch(
                    NewMACollect,
                    LookUp(
                        NewMACollect,
                        ID = menuSelected
                    ),
                    {
                        Teams:viewTeamName_Menu
                    }
                );
                UpdateContext({resetSearch: true});
                UpdateContext({resetSearch: false});
                UpdateContext({menuPopupVi:false});
                Clear(viewTeamName_Menu);
            PressedBorderColor: =
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: |-
                =ColorValue("#0C3B5E")
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Size: =15
            Text: ="확인"
            Visible: =menuPopupVi
            Width: =96
            X: =1199
            Y: =831
            ZIndex: =23

        Button_AddGroupCancel_MAMenu As button:
            AutoDisableOnSelect: =false
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: |-
                =ColorValue("#B3B3B3")
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: |-
                =ColorValue("#C7C7C7")
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: |-
                =ColorValue("#F5F5F5")
            OnSelect: |-
                =UpdateContext({menuPopupVi:false});
                UpdateContext({resetSearch: true});
                UpdateContext({resetSearch: false});
                Clear(viewTeamName_Menu);
            PressedBorderColor: |-
                =ColorValue("#B3B3B3")
            PressedColor: =RGBA(0, 0, 0, 1)
            PressedFill: |-
                =ColorValue("#E0E0E0")
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Size: =15
            Text: ="취소"
            Visible: =menuPopupVi
            Width: =96
            X: =1311
            Y: =831
            ZIndex: =24

        Gallery_AddGroup_MAMenu As gallery.SelectedUsersTabletGallery:
            AccessibleLabel: ="사용자가 사람을 선택함"
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            Fill: |-
                =ColorValue("#FAFAFA")
            FocusedBorderThickness: =1
            Height: =488
            Items: |
                =Filter(MAMenu_Groups,securityEnabled="true" || is365 = "true")
            Layout: =Layout.Vertical
            OnSelect: =
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =57
            Visible: =menuPopupVi
            Width: =552
            X: =858
            Y: =328
            ZIndex: =25

            Button_AddGroupName_MAMenu As button:
                BorderColor: |-
                    =If(ThisItem.IsSelected,RGBA(15, 108, 189, 1), ColorValue("#D1D1D1"))
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =If(ThisItem.IsSelected,RGBA(235,243,252,1),RGBA(255, 255, 255, 1))
                FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =48
                HoverBorderColor: =RGBA(15, 108, 189, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =
                OnSelect: =
                PressedBorderColor: =RGBA(15, 108, 189, 1)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =
                Size: =15
                Text: =""
                Width: =504
                X: =26
                Y: =9
                ZIndex: =2

            Label_AddGroupName_MAMenu As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =46
                OnSelect: =
                PaddingLeft: =10
                PaddingTop: =0
                Size: =13
                Text: =ThisItem.displayName & " (" & ThisItem.mail & ")"
                Tooltip: =ThisItem.displayName & " (" & ThisItem.mail & ")"
                Width: =400
                X: =100
                Y: =11
                ZIndex: =3

            Icon_AddGroup_MAMenu As icon.Add:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =25
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: |-
                    =If(
                        If(ThisItem.is365="true","c:0o.c|federateddirectoryclaimprovider|","c:0t.c|tenant|") & ThisItem.id in viewTeamName_Menu.Claims,
                        Icon.Cancel,
                        Icon.Add
                    )
                OnSelect: |-
                    =If(
                        If(ThisItem.is365="true","c:0o.c|federateddirectoryclaimprovider|","c:0t.c|tenant|") & ThisItem.id in viewTeamName_Menu.Claims,
                        Remove(
                            viewTeamName_Menu,
                            LookUp(
                                viewTeamName_Menu,
                                Claims = If(ThisItem.is365="true","c:0o.c|federateddirectoryclaimprovider|","c:0t.c|tenant|") & ThisItem.id
                            );
                        );
                        Notify(
                            "팀 제거 완료.",
                            NotificationType.Success,
                            5000
                        ),
                        Collect(
                            viewTeamName_Menu,
                            {
                                Claims: If(ThisItem.is365="true","c:0o.c|federateddirectoryclaimprovider|","c:0t.c|tenant|") & ThisItem.id,
                                Department:"",
                                DisplayName: ThisItem.displayName,
                                Email:ThisItem.mail,
                                JobTitle:"",
                                Picture:Blank()
                            }
                        );
                        Notify(
                            "팀 추가 완료.",
                            NotificationType.Success,
                            5000
                        )
                    );
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =25
                X: =491
                Y: =20
                ZIndex: =4

            Label_Prefix_Group_MAMenu As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                OnSelect: =Select(Parent)
                Size: =13
                Text: =If(ThisItem.is365 = "true", "M365", " AD")
                Width: =70
                X: =40
                Y: =11
                ZIndex: =5

        Rectangle_AddGroupHeader_MAMenu As rectangle:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            DisabledFill: =RGBA(0,0,0,0)
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(0,0,0,0)
            FocusedBorderThickness: =4
            Height: =88
            HoverFill: =RGBA(0,0,0,0)
            PressedFill: =RGBA(0,0,0,0)
            Visible: =menuPopupVi
            Width: =552
            X: =859
            Y: =241
            ZIndex: =30

        Label_AddGroup_MAMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =16
            Text: ="그룹 할당"
            Visible: =menuPopupVi
            X: =858
            Y: =193
            ZIndex: =31

        TextInput_AddGroup_MAMenu As text:
            Align: =TextPosition.Left
            BorderColor: |-
                =ColorValue("#D1D1D1")
            Default: =""
            FocusedBorderThickness: =2
            HintText: ="검색"
            OnChange: |-
                =ClearCollect(
                    MAMenu_Groups,
                    ForAll(
                        Table(ParseJSON('똑실이-[Apps]오피스365그룹검색'.Run(Self.Text).output)),
                        {
                            id: ThisRecord.Value.id,
                            mail: Text(ThisRecord.Value.mail),
                            displayName: Text(ThisRecord.Value.displayName),
                            securityEnabled: Text(ThisRecord.Value.securityEnabled),
                            is365: Text(ThisRecord.Value.is365)
                        }
                    )
                )
            OnSelect: =
            PaddingLeft: =15
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =
            RadiusTopRight: =4
            Reset: =resetSearch
            Visible: =menuPopupVi
            X: =886
            Y: =262
            ZIndex: =32

        Icon_AddGroupSearch_MAMenu As icon.Search:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(105, 121, 126, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =TextInput_AddGroup_MAMenu.Height-10
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Search
            OnSelect: =
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =menuPopupVi
            Width: =Self.Height
            X: =1167
            Y: =265
            ZIndex: =33

    Group_AddUserPopUp_MAMenu As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =65

        Rectangle_ComplateUserList_MAMenu As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderThickness: =2
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =720
            Visible: =EditUserVisibleVal
            Width: =600
            X: =841
            Y: =159
            ZIndex: =17

        Button_OKComplateUser_MAMenu As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderThickness: =1
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: |-
                =ColorValue("#0F6CBD")
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: |-
                =ColorValue("#115EA3")
            OnSelect: |+
                =Patch(NewMACollect, LookUp(NewMACollect,ID=CheckedID), {Users:adminUser});
                Clear(adminUser);
                
                Set(EditUserVisibleVal, false);
                Reset(TextInput_AddUserSearch_MAMenu);
                Refresh(똑실이_GNB_MENU);
                
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: |-
                =ColorValue("#0C3B5E")
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Size: =15
            Text: ="확인"
            Visible: |
                =EditUserVisibleVal
            Width: =96
            X: =1215
            Y: =817
            ZIndex: =18

        Button_CancleComplateUser_MAMenu As button:
            BorderColor: =RGBA(224, 224, 224, 1)
            BorderThickness: =1
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: |-
                =ColorValue("#B3B3B3")
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: |-
                =ColorValue("#C7C7C7")
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: |-
                =ColorValue("#F5F5F5")
            OnSelect: |-
                =Set(EditUserVisibleVal, false);
                Clear(adminUser);
                Reset(TextInput_AddUserSearch_MAMenu);
            PressedBorderColor: |-
                =ColorValue("#B3B3B3")
            PressedColor: =RGBA(0, 0, 0, 1)
            PressedFill: |-
                =ColorValue("#E0E0E0")
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Size: =15
            Text: ="취소"
            Visible: =EditUserVisibleVal
            Width: =96
            X: =1322
            Y: =817
            ZIndex: =19

        Gallery_ComplateUserList_MAMenu As gallery.SelectedUsersTabletGallery:
            AccessibleLabel: ="사용자가 사람을 선택함"
            BorderColor: =RGBA(202, 202, 202, 1)
            BorderThickness: =1
            Fill: |-
                =ColorValue("#FAFAFA")
            Height: =488
            Items: |-
                =Search(adminUser,TextInput_AddUserPopUp_MAMenu.Text,"DisplayName")
                
                /* 나중에 이걸로 바꿔야함 2023/10/10
                Search(adminUser,TextInput_AddUserPopUp_MAMenu.Text,"DisplayName")
                */
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =58
            Visible: =MAMode = "Search" && EditUserVisibleVal = true
            Width: =552
            X: =865
            Y: =312
            ZIndex: =20

            Button_AddUser_MAMenu As button:
                BorderColor: |-
                    =If(ThisItem.IsSelected,RGBA(15, 108, 189, 1), ColorValue("#D1D1D1"))
                BorderThickness: =1
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =If(ThisItem.IsSelected,RGBA(235,243,252,1),RGBA(255, 255, 255, 1))
                FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =48
                HoverBorderColor: =RGBA(15, 108, 189, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =
                OnSelect: =
                PressedBorderColor: =RGBA(15, 108, 189, 1)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =
                RadiusBottomLeft: =8
                RadiusBottomRight: =8
                RadiusTopLeft: =8
                RadiusTopRight: =8
                Size: =15
                Text: =""
                Width: =504
                X: =24
                Y: =9
                ZIndex: =1

            Title_UserList_MAMenu As label:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(0, 0, 0, 1)
                DisabledBorderColor: =RGBA(255, 255, 255, 1)
                DisabledColor: =RGBA(0, 0, 0, 1)
                Font: =Font.'Segoe UI'
                Height: =45
                HoverBorderColor: =
                HoverFill: =
                OnSelect: =Set(selectedUser, ThisItem)
                PaddingLeft: =15
                Size: =13
                TabIndex: =If(Gallery_AddUserSearch_MAMenu.Visible, -1, 0)
                Text: =ThisItem.DisplayName & " ( " & ThisItem.Email & " ) "
                Width: =430
                Wrap: =false
                X: =24
                Y: =9
                ZIndex: =2

            Icon_UserListRemove_MAMenu As icon.Cancel:
                AccessibleLabel: =Icon_UserListRemove_MAMenu.Tooltip
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =Title_UserList_MAMenu.Color
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Height: =41
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Cancel
                OnSelect: =Remove(adminUser, ThisItem)
                PaddingBottom: =9
                PaddingLeft: =9
                PaddingRight: =9
                PaddingTop: =9
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                TabIndex: =If(Gallery_AddUserSearch_MAMenu.Visible, -1, 0)
                Tooltip: ="컬렉션에서 사용자를 제거하려면 선택"
                Width: =46
                X: =482
                Y: =13
                ZIndex: =3

        Gallery_AddUserSearch_MAMenu As gallery.PeoplePickerTabletGallery:
            AccessibleLabel: ="사용자 찾기 검색 결과"
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            Fill: |-
                =ColorValue("#FAFAFA")
            Height: =488
            Items: |
                =/*
                If(
                    !IsBlank(Trim(txtUserSearch.Text)),
                    Office365사용자.SearchUserV2(
                        {
                            searchTerm:txtUserSearch.Text,
                            top: 999
                        }
                    ).value
                )
                
                
                If(
                    IsBlank(TextInput_AddUserSearch_MAMenu_1.Text),
                    Blank(),
                    If(
                        IsBlank(
                            Find(
                                ",",
                                TextInput_AddUserSearch_MAMenu_1.Text
                            )
                        ),
                        Search(
                            Namelist,
                            TextInput_AddUserSearch_MAMenu_1.Text,
                            "DisplayName"
                        ),
                        Filter(
                            Namelist,
                            DisplayName in Substitute(
                                Split(
                                    TextInput_AddUserSearch_MAMenu_1.Text,
                                    ","
                                ),
                                " ",
                                ""
                            )
                        )
                    )
                )*/
                Office365사용자.SearchUser(
                    {
                        searchTerm: TextInput_AddUserSearch_MAMenu.Text,
                        top: 999
                    }
                )
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =60
            Visible: =MAMode = "Add" && EditUserVisibleVal = true
            Width: =552
            X: =865
            Y: =312
            ZIndex: =21

            Button_AddUserName_MAMenu As button:
                BorderColor: |-
                    =
                    If(ThisItem.IsSelected,RGBA(15, 108, 189, 1), ColorValue("#D1D1D1"))
                BorderThickness: =1
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =If(ThisItem.IsSelected,RGBA(235,243,252,1),RGBA(255, 255, 255, 1))
                FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =48
                HoverBorderColor: =RGBA(15, 108, 189, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =
                OnSelect: =
                PressedBorderColor: =RGBA(15, 108, 189, 1)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =
                RadiusBottomLeft: =8
                RadiusBottomRight: =8
                RadiusTopLeft: =8
                RadiusTopRight: =8
                Size: =15
                Text: =""
                Width: =504
                X: =24
                Y: =9
                ZIndex: =1

            Icon_ProfileImage_MAMenu As icon.Person:
                BorderColor: =RGBA(0, 0, 0, 0)
                Color: =RGBA(255, 255, 255, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                Fill: =RGBA(0,0,0,0)
                Height: =
                Icon: =Icon.Person
                OnSelect: =Select(Label_DisplayName_MAMenu)
                PaddingBottom: =12
                PaddingLeft: =12
                PaddingRight: =12
                PaddingTop: =12
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =
                X: =
                Y: =
                ZIndex: =2

            Label_DisplayName_MAMenu As label:
                BorderColor: =Self.Color
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisplayMode: =DisplayMode.View
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =52
                OnSelect: |
                    =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                    /*
                    Concurrent(
                        Set(
                            selectedUser,
                            ThisItem
                        ),
                        Reset(TextSearchBox1_1),
                        If(
                            Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName) && Not(ThisItem.UserPrincipalName in LookUp(NewMACollect, ID=CheckedID, Users).Email),
                            Collect(
                                MyPeople,
                                ThisItem
                            );
                            Update( MyPeople, First( Filter( MyPeople, UserPrincipalName=ThisItem.UserPrincipalName ) ), 
                                { 
                                    Claims:"i:0#.f|membership|"& ThisItem.UserPrincipalName,
                                    Department:ThisItem.Department,
                                    DisplayName:ThisItem.DisplayName,
                                    UserPrincipalName:ThisItem.UserPrincipalName,
                                    JobTitle:ThisItem.JobTitle 
                                } 
                            )
                        )
                    );
                    
                    //// 기존 ////
                    
                    If(
                        Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName) && Not(
                            ThisItem.UserPrincipalName in LookUp(
                                NewMACollect,
                                ID = CheckedID,
                                Users
                            ).Email
                        ),
                        Collect(
                            MyPeople,
                            ThisItem
                        );
                        Update(
                            MyPeople,
                            First(
                                Filter(
                                    MyPeople,
                                    UserPrincipalName = ThisItem.UserPrincipalName
                                )
                            ),
                            {
                                Claims: "i:0#.f|membership|" & ThisItem.UserPrincipalName,
                                Department: ThisItem.Department,
                                DisplayName: ThisItem.DisplayName,
                                UserPrincipalName: ThisItem.UserPrincipalName,
                                JobTitle: ThisItem.JobTitle
                            }
                        );
                        //Set(UserAddPopup,true);,
                       // Timer_AddUserComplete_MAMenu_1.Start = true;
                        Notify(
                            "사용자 추가 완료.",
                            NotificationType.Success,
                            0
                        ),
                       Set(UserAddPopup,false);,
                        Notify(
                            "중복된 이름입니다.",
                            NotificationType.Error,
                            0
                        )
                    );
                    
                    
                    
                    //Reset(TextSearchBox1_1);
                    //등록완료시 초기화
                    */
                PaddingLeft: =15
                Size: =12
                TabIndex: =0
                Text: =ThisItem.DisplayName & " (" & ThisItem.UserPrincipalName & ")"
                Width: =413
                Wrap: =false
                X: =24
                Y: =9
                ZIndex: =3

            Icon_AddUser_MAMenu As icon.Add:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =25
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: |-
                    =//Icon.Add
                    If(ThisItem.Mail in adminUser.Email,
                    Icon.Cancel,
                    Icon.Add)
                OnSelect: |-
                    =If(
                        ThisItem.Mail in adminUser.Email,
                        Remove(adminUser, LookUp(adminUser, Email=ThisItem.Mail));
                        Notify(
                            "사용자 제거 완료.",
                            NotificationType.Success,
                            5000
                        )
                        ,
                        Collect(
                            adminUser,
                            {
                                Claims: "i:0#.f|membership|" & ThisItem.UserPrincipalName,
                                Department: ThisItem.Department,
                                DisplayName: ThisItem.DisplayName,
                                JobTitle: ThisItem.JobTitle,
                                Email: ThisItem.Mail,
                                Picture: 'Office365사용자'.UserPhotoV2(ThisItem.Id)
                            }
                        );
                        Notify(
                            "사용자 추가 완료.",
                            NotificationType.Success,
                            5000
                        )
                    )
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =25
                X: =492
                Y: =20
                ZIndex: =5

        Label_AddUserPopUp2_MAMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =16
            Text: ="할당 인원"
            Visible: =MAMode = "Search" && EditUserVisibleVal = true
            X: =866
            Y: =174
            ZIndex: =34

        Rectangle_AddUserPopUp_MAMenu As rectangle:
            BorderColor: |-
                =ColorValue("#D1D1D1")
            BorderThickness: =1
            DisabledFill: =RGBA(0,0,0,0)
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(0,0,0,0)
            FocusedBorderThickness: =4
            Height: =88
            HoverFill: =RGBA(0,0,0,0)
            PressedFill: =RGBA(0,0,0,0)
            Visible: =MAMode = "Add" && EditUserVisibleVal = true
            Width: =552
            X: =865
            Y: =224
            ZIndex: =35

        Label_AddUserPopUp_MAMenu As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =16
            Text: ="인원 할당"
            Visible: =MAMode = "Add" && EditUserVisibleVal = true
            X: =866
            Y: =174
            ZIndex: =36

        TextInput_AddUserPopUp_MAMenu As text:
            Align: =TextPosition.Left
            BorderColor: |-
                =ColorValue("#D1D1D1")
            Default: =""
            FocusedBorderThickness: =1
            HintText: ="검색"
            OnSelect: =
            PaddingLeft: =15
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Reset: =resetSearch
            Visible: =MAMode = "Search" && EditUserVisibleVal = true
            X: =892
            Y: =247
            ZIndex: =37

        Icon_AddUserPopUpSearch_MAMenu As icon.Search:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(105, 121, 126, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =TextInput_AddGroup_MAMenu.Height-10
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Search
            OnSelect: =
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =MAMode = "Search" && EditUserVisibleVal = true
            Width: =Self.Height
            X: =1176
            Y: =253
            ZIndex: =38

        TextInput_AddUserSearch_MAMenu As text:
            Align: =TextPosition.Left
            BorderColor: |-
                =ColorValue("#D1D1D1")
            Default: =""
            FocusedBorderThickness: =2
            Height: |
                =40
            HintText: ="사용자를 검색하세요."
            PaddingLeft: =15
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Visible: =MAMode = "Add" && EditUserVisibleVal = true
            X: =892
            Y: =247
            ZIndex: =39

        Icon_AddUserSherch_MAMenu As icon.Search:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(105, 121, 126, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =TextInput_AddUserSearch_MAMenu.Height-10
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Search
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =MAMode = "Add" && EditUserVisibleVal = true
            Width: =Self.Height
            X: =1173
            Y: =252
            ZIndex: =40

