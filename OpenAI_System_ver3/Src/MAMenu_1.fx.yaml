MAMenu_1 As screen:
    BackgroundImage: =                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
    Fill: =RGBA(245, 245, 245, 1)
    LoadingSpinnerColor: =RGBA(105, 121, 126, 1)
    OnVisible: |-
        =UpdateContext({testHight:CountRows(
            ForAll(Distinct(SortByColumns(Filter(GNB_MENU, LV1<>Blank()), "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
        ) * 80});
        
        Concurrent(
        Set(ZoomLV1, "");,
        Set(testVisible, "");,
        Set(SelectedLV1, "");,
        Set(SelectedLV2, "");,
        Set(AddTeamPopup, false);,
        
        Set(EditUserVisibleVal, false);,
        ClearCollect(NewMACollect, ShowColumns(GNB_MENU,"Title","OData__x004c_V1","LV1Order","LV2Order","Users","ID","Team_ID"));,
        Clear(NewPortalCollect);
        );
        
        ClearCollect(
            Namelist,
            Filter(
                Office365사용자.SearchUser(
                    {
                        searchTerm: TextInput_AddUserSearch_MAMenu_1.Text,
                        top: 999
                    }
                ),
                AccountEnabled = true
            )
        );
        
        ClearCollect(
            Departmentlist,
            Distinct(
                ShowColumns(
                    'Office365사용자'.SearchUser(
                        {
                            searchTerm2: TextInput_ShearchTeam_MAMenu_1.Text,
                            top: 999
                        }
                    ),
                    "Department"
                ),
                Department
            )
        );

    Rectangle_MAMHeaderback_MAMenu_1 As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderThickness: =2
        DisabledFill: =RGBA(255, 255, 255, 1)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(255, 255, 255, 1)
        FocusedBorderThickness: =4
        Height: =80
        HoverFill: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(255, 255, 255, 1)
        Width: =1540
        X: =347
        Y: =114
        ZIndex: =1

    Rectangle_MAMenuHeader_MAMenu_1 As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        Fill: =RGBA(112, 112, 112, 1)
        Height: =1
        Visible: =false
        Width: =Parent.Width - New_Component_GNB_MAMenu_1.Width
        X: =New_Component_GNB_gnbMenu.Width
        Y: =100
        ZIndex: =2

    Rectangle_MAMenuBody_MAMenu_1 As rectangle:
        BorderColor: =RGBA(112, 112, 112, 1)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledFill: =RGBA(0, 0, 0, 0)
        DisplayMode: =DisplayMode.View
        Fill: =RGBA(255, 255, 255, 1)
        FocusedBorderThickness: =4
        Height: =808
        Width: =1540
        X: =340
        Y: =232
        ZIndex: =3

    Gallery_Main_MAMenu_1 As gallery.variableTemplateHeightGallery:
        BorderColor: =RGBA(166, 166, 166, 1)
        Height: |-
            =If(
                testHight >= 700,
                650,
                testHight
            )
        Items: |-
            =ForAll(Distinct(SortByColumns(GNB_MENU, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
            //SortByColumns(GNB_MENU, "LV1Order", Ascending)
        Layout: =Layout.Vertical
        OnSelect: |-
            =Set(SelectedLV2,"");
            Set(SelectedLV1, ThisItem.Result);
            
            If(ThisItem.Result=SelectedLV1, //Checkbox1.Value,
            Set(CheckedLV1, ThisItem.Result);
            Set(CheckedLV1Order, LookUp(GNB_MENU, LV1=ThisItem.Result, LV1Order));
            Set(CheckedRemarks, LookUp(GNB_MENU, LV1=ThisItem.Result, Remarks));
            Set(CheckedID, LookUp(GNB_MENU, LV1=ThisItem.Result, ID));,
            
            Set(CheckedLV1, Blank());
            Set(CheckedLV2, Blank());
            Set(CheckedLV1Order, Blank());
            Set(CheckedLV2Order, Blank());
            Set(CheckedReportURI, Blank());
            Set(CheckedRemarks, Blank());
            Set(CheckedID, Blank());
            );
            
            Set(FirstLV1Order, First(SortByColumns(GNB_MENU,"LV1Order")).LV1Order);
            Set(PrevLV1Order, CheckedLV1Order-1);
            Set(NextLV1Order, CheckedLV1Order+1);
            Set(LastLV1Order, Last(SortByColumns(GNB_MENU,"LV1Order")).LV1Order);
            Set(BlankLV1Order, LastLV1Order +1);
            If(ZoomLV1<>ThisItem.Result, Set(ZoomLV1,ThisItem.Result), Set(ZoomLV1, ""));
            If(testVisible<>ThisItem.Result ,Set(testVisible,ThisItem.Result), Set(testVisible,""));
            If(testVisible="",
            If(ThisItem.IsSelected, UpdateContext({ testHight: 
            CountRows(
                ForAll(Distinct(SortByColumns(GNB_MENU, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
            ) * 80})),
            
            UpdateContext({ testHight:
                CountRows(
                    ForAll(Distinct(SortByColumns(GNB_MENU, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                ) * 80 + 
                CountRows(
                    Filter(
                        GNB_MENU, LV1=ZoomLV1
                    )
                ) * 80 + 75}));
            //Select(TextInput4)
            Set(SelectedLV1, "");
            Set(SelectedLV2, "");
        ShowScrollbar: =false
        TemplatePadding: =0
        TemplateSize: |-
            =If(
                Gallery_Sub_MAMenu_1.Visible=true,
                CountRows(
                    Filter(
                        GNB_MENU, LV1=ZoomLV1
                    )
                ) * 75 + 72,
                500
            )
        Width: =1544
        X: =343
        Y: =301
        ZIndex: =10

        Gallery_Sub_MAMenu_1 As gallery.variableTemplateHeightGallery:
            BorderColor: =RGBA(166, 166, 166, 1)
            Height: =428
            Items: =SortByColumns(Filter(GNB_MENU, LV1=ThisItem.Result), "LV2Order", SortOrder.Ascending)
            Layout: =Layout.Vertical
            OnSelect: |
                =Set(SelectedLV2,ThisItem.제목);
                Set(SelectedLV1, "");
                
                If(ThisItem.제목=SelectedLV2, //Checkbox5.Value,
                Set(CheckedLV1, ThisItem.LV1);
                Set(CheckedLV2, ThisItem.제목);
                Set(CheckedLV1Order, ThisItem.LV1Order);
                Set(CheckedLV2Order, ThisItem.LV2Order);
                Set(CheckedReportURI, ThisItem.ReportURI);
                Set(CheckedRemarks, ThisItem.Remarks);
                Set(CheckedID, ThisItem.ID);,
                
                Set(CheckedLV1, Blank());
                Set(CheckedLV2, Blank());
                Set(CheckedLV1Order, Blank());
                Set(CheckedLV2Order, Blank());
                Set(CheckedReportURI, Blank());
                Set(CheckedRemarks, Blank());
                Set(CheckedID, Blank());
                );
                
                Set(FirstLV2Order, First(SortByColumns(Filter(GNB_MENU, LV1=CheckedLV1),"LV2Order")).LV2Order);
                Set(PrevLV2Order, CheckedLV2Order-1);
                Set(NextLV2Order, CheckedLV2Order+1);
                Set(LastLV2Order, Last(SortByColumns(Filter(GNB_MENU, LV1=CheckedLV1),"LV2Order")).LV2Order);
                Set(BlankLV2Order, LastLV2Order +1);
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: |-
                =77
                /*
                CountRows(
                    Filter(
                        GNB_MENU,
                        LV1 = ThisItem.Result
                    )
                ) * 72
                */
            Visible: =If(testVisible=ThisItem.Result, true, false)
            Width: =Parent.Width
            Y: =72
            ZIndex: =2

            Icon_SelectSubMenu_MAMenu_1 As icon.Check:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: |-
                    =If(
                        ThisItem.ID = CheckedID,
                        RGBA(184,0,0,1),
                        RGBA(0, 0, 0, 1)
                    )
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =45
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Pin
                OnSelect: =Select(Parent);
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =45
                X: =42
                Y: =Label_ComplateUsersName_MAMenu_1.Y + (Label_ComplateUsersName_MAMenu_1.Height - Self.Height)/2
                ZIndex: =2

            TextInput_SubMenuName_MAMenu_1 As text:
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                Default: |-
                    =If(
                        ThisItem.제목=LookUp(GNB_MENU, LV1=ThisItem.제목, LV1Order) || IsNumeric(ThisItem.제목),
                        Blank(),
                        ThisItem.제목
                    )
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                DisplayMode: =DisplayMode.Disabled
                FocusedBorderThickness: =4
                Height: =42
                HintText: |-
                    =If(
                        IsNumeric(ThisItem.LV1),
                        "새 메뉴",
                        ThisItem.LV1
                    )
                HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverColor: =RGBA(51, 51, 51, 1)
                HoverFill: =RGBA(255, 255, 255, 1)
                Mode: =TextMode.MultiLine
                OnChange: |-
                    =Patch(
                        NewMACollect,
                        LookUp(NewMACollect, ID=CheckedID), //ThisItem.ID = __CheckedID
                        { 
                            OData__x004c_V1:TextInput_MenuName_MAMenu_1.Text, Title:TextInput_SubMenuName_MAMenu_1.Text,
                            LV1Order: CheckedLV1Order, LV2Order: CheckedLV2Order
                        }
                    )
                OnSelect: |-
                    =//If(SelectedLV2<>ThisItem.Title, Set(SelectedLV2,ThisItem.Title), Set(SelectedLV2, ""));
                    Set(SelectedLV2,ThisItem.제목);
                    Set(SelectedLV1, "");
                    Select(Parent)
                PaddingLeft: =24
                PressedBorderColor: =RGBA(105, 121, 126, 1)
                PressedColor: =RGBA(51, 51, 51, 1)
                PressedFill: =RGBA(255, 255, 255, 1)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =15
                Width: =206
                X: =Icon_SelectSubMenu_MAMenu_1.X + Icon_SelectSubMenu_MAMenu_1.Width + 13
                Y: =Label_ComplateUsersName_MAMenu_1.Y
                ZIndex: =3

            Label_ComplateUsersName_MAMenu_1 As label:
                BorderColor: =RGBA(166, 166, 166, 1)
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Height: |-
                    =If(
                        Self.AutoHeight,
                        0,
                        45
                    )
                OnSelect: =Select(Parent)
                Overflow: =Overflow.Scroll
                PaddingLeft: =24
                Size: =18
                Text: |-
                    =//Concat(ThisItem.'Users (Users0)', DisplayName & " ( " & Email & " ) ", ",                                                  ")
                    //Concat(MyPeople, DisplayName & " ( " & Mail & " ) ", ",                                                                    ")
                    //Concat(LookUp(NewMACollect, Title=If(__CheckedLV2<>ThisItem.Title, ThisItem.Title, __CheckedLV2), Users0), DisplayName & " (" & Email & ")", ",                     ")
                    If(
                        CountRows(
                            LookUp(
                                NewMACollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Users
                            )
                        ) > 1,
                        First(
                            LookUp(
                                NewMACollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Users
                            )
                        ).DisplayName & " 외" & Int(
                            CountRows(
                                LookUp(
                                    NewMACollect,
                                    Title = If(
                                        CheckedLV2 <> ThisItem.제목,
                                        ThisItem.제목,
                                        CheckedLV2
                                    ),
                                    Users
                                )
                            )
                        ) - 1 & "명",
                        First(
                            LookUp(
                                NewMACollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Users
                            )
                        ).DisplayName
                    )
                Width: =341
                Wrap: =false
                X: =
                Y: =15
                ZIndex: =6

            Icon_ComplateUserList_MAMenu_1 As icon.Post:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =42
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Person
                OnSelect: |-
                    =Select(Parent);
                    ClearCollect(MyPeople,RenameColumns( LookUp(NewMACollect, Title=ThisItem.제목, Users), "Email", "UserPrincipalName"));
                    Set(MAMode, "Search");
                    Set(EditUserVisibleVal, true);
                    //ClearCollect(MyPeople,RenameColumns( ThisItem.'Users (Users0)', "Email", "UserPrincipalName"));
                    //ClearCollect(MyPeople, ThisItem.'Users (Users0)');
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =42
                X: =Label_ComplateUsersName_MAMenu_1.X + Label_ComplateUsersName_MAMenu_1.Width + 10
                Y: =Icon_SelectSubMenu_MAMenu_1.Y
                ZIndex: =9

            Button_SelectParent_MAMenu_1 As button:
                BorderColor: =RGBA(0, 0, 0, 0)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =44
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                PressedBorderColor: =
                PressedColor: =RGBA(0, 0, 0, 0)
                PressedFill: =
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =15
                Text: =""
                Width: =833
                X: =TextInput_SubMenuName_MAMenu_1.X
                Y: =TextInput_SubMenuName_MAMenu_1.Y
                ZIndex: =10

            Icon_AddUserButton_MAMenu_1 As icon.Post:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                DisplayMode: |-
                    =If(
                        ThisItem.ID = CheckedID,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                FocusedBorderThickness: =4
                Height: =42
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.AddUser
                OnSelect: |-
                    =Select(Parent);
                    Clear(MyPeople);
                    //ClearCollect(MyPeople,RenameColumns( LookUp(NewMACollect, Title=ThisItem.Title, Users0), "Email", "UserPrincipalName"));
                    Set(MAMode, "Add");
                    Set(EditUserVisibleVal, true);
                    //ClearCollect(MyPeople,RenameColumns( ThisItem.'Users (Users0)', "Email", "UserPrincipalName"));
                    //ClearCollect(MyPeople, ThisItem.'Users (Users0)');
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =42
                X: =Icon_ComplateUserList_MAMenu_1.X + Icon_ComplateUserList_MAMenu_1.Width + 10
                Y: =Icon_SelectSubMenu_MAMenu_1.Y +2
                ZIndex: =11

            Label_ComplateTeamName_MAMenu_1 As label:
                BorderColor: =RGBA(179, 179, 179, 1)
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Height: =42
                OnSelect: =Select(Parent)
                Overflow: =Overflow.Scroll
                PaddingLeft: =24
                Size: =18
                Text: |-
                    =If(
                        CountRows(
                            LookUp(
                                NewMACollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Distinct(
                                    Teams,
                                    Department
                                )
                            )
                        ) > 1,
                        First(
                            LookUp(
                                NewMACollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Teams
                            )
                        ).Department & " 외" & Int(
                            CountRows(
                                LookUp(
                                    NewMACollect,
                                    Title = If(
                                        CheckedLV2 <> ThisItem.제목,
                                        ThisItem.제목,
                                        CheckedLV2
                                    ),
                                    Distinct(
                                        Teams,
                                        Department
                                    )
                                )
                            )
                        ) - 1 & "개의 팀",
                        If(
                            CountRows(
                                LookUp(
                                    NewMACollect,
                                    Title = If(
                                        CheckedLV2 <> ThisItem.제목,
                                        ThisItem.제목,
                                        CheckedLV2
                                    ),
                                    Distinct(
                                        Teams,
                                        Department
                                    )
                                )
                            ) = 0,
                            "할당된 팀이 없습니다.",
                            First(
                                LookUp(
                                    NewMACollect,
                                    Title = If(
                                        CheckedLV2 <> ThisItem.제목,
                                        ThisItem.제목,
                                        CheckedLV2
                                    ),
                                    Teams
                                )
                            ).Department
                        )
                    )
                    /*
                    If(
                        CountRows(
                            LookUp(
                                NewMACollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Distinct(Teams,Department)
                            )
                        ) > 1,
                        First(
                            LookUp(
                                NewMACollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Teams
                            )
                        ).Department & " 외" & Int(
                            CountRows(
                                LookUp(
                                    NewMACollect,
                                    Title = If(
                                        CheckedLV2 <> ThisItem.제목,
                                        ThisItem.제목,
                                        CheckedLV2
                                    ),
                                    Distinct(Teams,Department)
                                )
                            )
                        ) - 1 & "개의 팀",
                        First(
                            LookUp(
                                NewMACollect,
                                Title = If(
                                    CheckedLV2 <> ThisItem.제목,
                                    ThisItem.제목,
                                    CheckedLV2
                                ),
                                Teams
                            )
                        ).Department
                    )
                    */
                Width: =535
                X: =
                Y: =Label_ComplateUsersName_MAMenu_1.Y
                ZIndex: =12

            Icon_ComplateTeamList_MAMenu_1 As icon.Post:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                Height: =42
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Person
                OnSelect: |-
                    =Select(Parent);
                    ClearCollect(MyPeople2,RenameColumns( LookUp(NewMACollect, Title=ThisItem.제목, Teams), "Email", "UserPrincipalName"));
                    Set(MAMode, "Search");
                    Set(AddTeamPopup, true);
                    Set(Ok, true);
                    //ClearCollect(MyPeople,RenameColumns( ThisItem.'Users (Users0)', "Email", "UserPrincipalName"));
                    //ClearCollect(MyPeople, ThisItem.'Users (Users0)');
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =42
                X: =925
                Y: =13
                ZIndex: =13

            Icon_AddTeamButton_MAMenu_1 As icon.Post:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                DisplayMode: |-
                    =If(
                        ThisItem.ID = CheckedID,
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                FocusedBorderThickness: =4
                Height: =42
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.AddUser
                OnSelect: |
                    =Select(Parent);
                    Set(SelectedLV1, ThisItem.LV1);
                    Set(SelectedLV2, "");
                    Set(CheckedID, LookUp(GNB_MENU, LV1=ThisItem.LV1, ID));
                    Set(MAMode , "TeamAdd");
                    Set(AddTeamPopup, true);
                    Clear(MyPeople)
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =42
                X: =977
                Y: =15
                ZIndex: =14

        Icon_OpenSubGallery_MAMenu_1 As icon.Check:
            BorderColor: =RGBA(166, 166, 166, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =40
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: |-
                =If(
                    Gallery_Sub_MAMenu_1.Visible = true,
                    Icon.ZoomOut,
                    Icon.ZoomIn
                )
            OnSelect: |-
                =If(ZoomLV1<>ThisItem.Result, Set(ZoomLV1,ThisItem.Result), Set(ZoomLV1, ""));
                If(testVisible<>ThisItem.Result ,Set(testVisible,ThisItem.Result), Set(testVisible,""));
                If(testVisible="",
                If(ThisItem.IsSelected, UpdateContext({ testHight: 
                CountRows(
                    ForAll(Distinct(SortByColumns(GNB_MENU, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                ) * 80})),
                
                UpdateContext({ testHight:
                    CountRows(
                        ForAll(Distinct(SortByColumns(GNB_MENU, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                    ) * 80 + 
                    CountRows(
                        Filter(
                            GNB_MENU, LV1=ZoomLV1
                        )
                    ) * 80 + 75}));
                //Select(TextInput4)
                Set(SelectedLV1, "");
                Set(SelectedLV2, "");
                Select(Parent);
            PaddingBottom: =5
            PaddingLeft: =5
            PaddingRight: =5
            PaddingTop: =5
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Width: =40
            X: =20
            Y: =15
            ZIndex: =4

    Label_MAMenuTitle_MAMenu_1 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        FontWeight: =FontWeight.Bold
        Height: =64
        Size: =30
        Text: ="권한관리"
        Width: =393
        X: =343
        Y: =23
        ZIndex: =11

    Label_MemberAddCompleteName_MAMenu_1 As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: =Last(Filter(MyPeople,DisplayName = DisplayName,DisplayName)).DisplayName
        Visible: |-
            =If(
                TextInput_AddUserSearch_MAMenu_1.Visible = true,
                true,
                false
            )
        Width: =81
        X: =965
        Y: =685
        ZIndex: =27

    Label_MemberAddComplete_MAMenu_1 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Size: =15
        Text: ="님 추가 완료"
        Visible: |-
            =If(
                Label_MemberAddCompleteName_MAMenu_1.Visible = true 
            && !IsBlank(Last(Filter(MyPeople, DisplayName = DisplayName, DisplayName)).DisplayName),
                true,
                false
            )
        X: =Label_MemberAddCompleteName_MAMenu_1.X + 70
        Y: =Label_MemberAddCompleteName_MAMenu_1.Y
        ZIndex: =28

    Label_CountMainMenu_MAMenu_1 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Size: =16
        Text: |+
            =//"메인 메뉴" & " : " & CountRows(Filter(GNB_MENU,LV2Order=1)) & "개"
            //"메인 메뉴 : " & CountRows(Filter(GNB_MENU, !IsBlank(LV1))) & "개"
            " 메인 메뉴 : " & CountRows(Distinct(Filter(GNB_MENU, !IsBlank(LV1)&& LV1 <> "Admin"), LV1)) & "개"
            
        Width: =218
        X: =348
        Y: =132
        ZIndex: =29

    Group_DeleteMemberSub_MAMenu_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =29

        Rectangle_DeleteMemberSub_MAMenu_1 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =396
            Visible: =DelPopUp=true
            Width: =772
            X: =680
            Y: =329
            ZIndex: =19

        Button_OKDeleteMamberSub_MAMenu_1 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |-
                =Remove(
                    GNB_MENU,
                    First(
                        Filter(
                            GNB_MENU,
                            ID=CheckedID
                        )
                    )
                );
                UpdateContext({ ShowHeight:
                    CountRows(
                    ForAll(SortByColumns(Filter(GNB_MENU, LV1<>Blank()), "LV1Order", SortOrder.Ascending), {Result: ThisRecord.LV1})
                ) * 80 + 
                    CountRows(
                        Filter(
                            GNB_MENU, LV1=ZoomLV1
                        )
                    ) * 80 + 75}
                );
                
                Set(DelPopUp,false)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="확인"
            Visible: =DelPopUp=true
            X: =864
            Y: =662
            ZIndex: =20

        Button_CencleDeleteMamberSub_MAMenu_1 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: =Set(DelPopUp,false)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="취소"
            Visible: =DelPopUp=true
            X: =1107
            Y: =Button_OKDeleteMamberSub_MAMenu_1.Y
            ZIndex: =21

        Label_DeleteMemberSub_MAMenu_1 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            FontWeight: =FontWeight.Semibold
            Height: =92
            Size: =30
            Text: ="삭제하시겠습니까?"
            Visible: =DelPopUp=true
            Width: =391
            X: =876
            Y: =447
            ZIndex: =22

    Label_CountSubMenu_MAMenu_1 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Size: =16
        Text: |-
            =/*"할당한 인원이 없는 메인메뉴 " & " : " & CountRows(Filter(GNB_MENU, LV2Order=1 && IsEmpty(Users))) & "개" &" -> " & Concat(
                Filter(GNB_MENU, LV2Order=1 && IsEmpty(Users)),
                LV1 & " "
                
            )*/
            "서브 메뉴" & " : " & CountRows(Filter(GNB_MENU,!IsBlank(LV2Order) && LV1 <> "Admin")) & "개"
        Width: =222
        X: =651
        Y: =132
        ZIndex: =30

    Label_NotMemberInSubMenu_MAMenu_1 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Size: =16
        Text: |-
            ="할당한 인원이 없는 서브메뉴 " & " : " & CountRows(Filter(GNB_MENU, !IsBlank(LV2Order) && IsEmpty(Users) && LV1 <> "Admin")) & "개"
            
            /*"할당한 인원이 없는 서브메뉴 " & " : " & CountRows(Filter(GNB_MENU, LV2Order <> 1 && IsEmpty(Users))) & "개" &" -> " & Concat(
                Filter(GNB_MENU, LV2Order <> 1 && IsEmpty(Users)),
                제목 & " "
                
            ) */
            
            /*"할당한 인원이 없는 서브메뉴 " & " : " & CountRows(Filter(GNB_MENU, !IsBlank(LV2Order) && IsEmpty(Users) && LV1 <> "Admin")) & "개" &" -> " & Concat(
                Filter(GNB_MENU, !IsBlank(LV2Order) && IsEmpty(Users) && LV1 <> "Admin"),
                제목 & " "
                
            ) */
        Width: =486
        X: =908
        Y: =132
        ZIndex: =31

    Group_DeleteMemberMain_MAMenu_1 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =33

        Rectangle_DeleteMemberMain_MAMenu_1 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =396
            Visible: =DelpopUpMain=true
            Width: =772
            X: =680
            Y: =272
            ZIndex: =23

        Button_OKDeleteMamberMain_MAMenu_1 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |-
                =ForAll(
                    Sequence(CountRows(Filter(GNB_MENU, LV1=CheckedLV1))),
                    Remove(GNB_MENU, LookUp(GNB_MENU,LV1=CheckedLV1))
                );
                
                UpdateContext({ testHight:
                    CountRows(
                    ForAll(Distinct(SortByColumns(GNB_MENU, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
                ) * 80 });
                
                Refresh(GNB_MENU);
                Set(ZoomLV1, "");
                Set(testVisible, "");
                Set(SelectedLV1, "");
                Set(SelectedLV2, "");
                Set(DelpopUpMain,false)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="확인"
            Visible: =DelpopUpMain=true
            X: =864
            Y: =605
            ZIndex: =24

        Button_CencleDeleteMamberMain_MAMenu_1 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: =Set(DelpopUpMain,false)
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="취소"
            Visible: =DelpopUpMain=true
            X: =1107
            Y: =605
            ZIndex: =25

        Label_DeleteMemberMain_MAMenu_1 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            FontWeight: =FontWeight.Semibold
            Height: =92
            Size: =30
            Text: ="삭제하시겠습니까?"
            Visible: =DelpopUpMain=true
            Width: =391
            X: =876
            Y: =390
            ZIndex: =26

    Group_AddUserPopUp_MAMenu_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =33

        Rectangle_ComplateUserList_MAMenu_1 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =580
            Visible: =EditUserVisibleVal
            Width: =494
            X: =821
            Y: =222
            ZIndex: =12

        Button_OKComplateUser_MAMenu_1 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |+
                =If(
                    MAMode = "Search",
                    Clear(
                            LookUp(
                            NewMACollect,
                            ID = CheckedID,
                            Users
                        )
                    );
                    Collect(
                        LookUp(
                            NewMACollect,
                            ID = CheckedID,
                            Users
                        ),
                        MyPeople
                    );
                    ,
                    MAMode = "Add",
                    Collect(
                        LookUp(
                            NewMACollect,
                            ID = CheckedID,
                            Users
                        ),
                        MyPeople
                    )
                );
                
                Set(
                    SelectedLV1,
                    ""
                );
                Set(
                    SelectedLV2,
                    ""
                );
                Set(
                    CheckedLV2,
                    ""
                );
                
                Set(
                    ZoomLV1,
                    "FFF"
                );
                Set(EditUserVisibleVal, false);
                Reset(TextInput_AddUserSearch_MAMenu_1);
                Refresh(GNB_MENU);
                
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="확인"
            Visible: |
                =EditUserVisibleVal
            X: =Rectangle_ComplateUserList_MAMenu_1.X + (Rectangle_ComplateUserList_MAMenu_1.Width/2 - Self.Width)/2
            Y: =Rectangle_ComplateUserList_MAMenu_1.Y + Rectangle_ComplateUserList_MAMenu_1.Height - Self.Height - 20
            ZIndex: =13

        Button_CancleComplateUser_MAMenu_1 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |-
                =Set(EditUserVisibleVal, false);
                Reset(TextInput_AddUserSearch_MAMenu_1);
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="취소"
            Visible: =EditUserVisibleVal
            X: =Rectangle_ComplateUserList_MAMenu_1.X + (Rectangle_ComplateUserList_MAMenu_1.Width + Self.Width/2)/2
            Y: =Button_OKComplateUser_MAMenu_1.Y
            ZIndex: =14

        Gallery_ComplateUserList_MAMenu_1 As gallery.SelectedUsersTabletGallery:
            AccessibleLabel: ="사용자가 사람을 선택함"
            BorderThickness: =1
            Height: |-
                =If(
                    TextInput_AddUserSearch_MAMenu_1.Visible,
                    Gallery_AddUserSearch_MAMenu_1.Height,
                    TextInput_AddUserSearch_MAMenu_1.Height + Gallery_AddUserSearch_MAMenu_1.Height + 20
                )
            Items: =MyPeople
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =47
            Visible: =EditUserVisibleVal
            Width: =TextInput_AddUserSearch_MAMenu_1.Width
            X: =Gallery_AddUserSearch_MAMenu_1.X
            Y: |-
                =If(
                    TextInput_AddUserSearch_MAMenu_1.Visible,
                    Gallery_AddUserSearch_MAMenu_1.Y,
                    TextInput_AddUserSearch_MAMenu_1.Y
                )
            ZIndex: =15

            Rectangle_UserList_MAMenu_1 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledFill: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(105, 121, 126, 1)
                FocusedBorderThickness: =4
                Height: =Parent.TemplateHeight
                HoverFill: =RGBA(105, 121, 126, 1)
                OnSelect: =Select(Parent)
                PressedFill: =RGBA(105, 121, 126, 1)
                Width: =Parent.TemplateWidth
                ZIndex: =1

            Title_UserList_MAMenu_1 As label:
                Color: =RGBA(255, 255, 255, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                Height: =Gallery_ComplateUserList_MAMenu_1.TemplateHeight
                OnSelect: =Set(selectedUser, ThisItem)
                PaddingLeft: =10
                Size: =13
                TabIndex: =If(Gallery_AddUserSearch_MAMenu_1.Visible, -1, 0)
                Text: =ThisItem.DisplayName & " ( " & ThisItem.UserPrincipalName & " ) "
                Width: =Gallery_ComplateUserList_MAMenu_1.TemplateWidth - Icon_UserListRemove_MAMenu_1.Width + 10
                Wrap: =false
                ZIndex: =2

            Icon_UserListRemove_MAMenu_1 As icon.Cancel:
                AccessibleLabel: =Icon_UserListRemove_MAMenu_1.Tooltip
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =Title_UserList_MAMenu_1.Color
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Height: =Gallery_ComplateUserList_MAMenu_1.TemplateHeight
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Cancel
                OnSelect: =Remove(MyPeople, LookUp(MyPeople, UserPrincipalName = ThisItem.UserPrincipalName))
                PaddingBottom: =9
                PaddingLeft: =9
                PaddingRight: =9
                PaddingTop: =9
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                TabIndex: =If(Gallery_AddUserSearch_MAMenu_1.Visible, -1, 0)
                Tooltip: ="컬렉션에서 사용자를 제거하려면 선택"
                Width: =Self.Height
                X: =Gallery_ComplateUserList_MAMenu_1.TemplateWidth - Self.Width
                ZIndex: =3

        Gallery_AddUserSearch_MAMenu_1 As gallery.PeoplePickerTabletGallery:
            AccessibleLabel: ="사용자 찾기 검색 결과"
            BorderColor: =RGBA(166, 166, 166, 1)
            Fill: =Parent.Fill
            Height: =376
            Items: |+
                =/*
                If(
                    !IsBlank(Trim(txtUserSearch.Text)),
                    Office365사용자.SearchUserV2(
                        {
                            searchTerm:txtUserSearch.Text,
                            top: 999
                        }
                    ).value
                )
                */
                
                If(
                    IsBlank(TextInput_AddUserSearch_MAMenu_1.Text),
                    Blank(),
                    If(
                        IsBlank(
                            Find(
                                ",",
                                TextInput_AddUserSearch_MAMenu_1.Text
                            )
                        ),
                        Search(
                            Namelist,
                            TextInput_AddUserSearch_MAMenu_1.Text,
                            "DisplayName"
                        ),
                        Filter(
                            Namelist,
                            DisplayName in Substitute(
                                Split(
                                    TextInput_AddUserSearch_MAMenu_1.Text,
                                    ","
                                ),
                                " ",
                                ""
                            )
                        )
                    )
                )
                
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =87
            Visible: |-
                =If(
                TextInput_AddUserSearch_MAMenu_1.Visible,
                true,
                false
                )
            Width: =Rectangle_ComplateUserList_MAMenu_1.X + Rectangle_ComplateUserList_MAMenu_1.Width - Self.X - 10
            X: =TextInput_AddUserSearch_MAMenu_1.X
            Y: =TextInput_AddUserSearch_MAMenu_1.Y + TextInput_AddUserSearch_MAMenu_1.Height + 20
            ZIndex: =16

            Rectangle_UserInformation_MAMenu_1 As rectangle:
                BorderColor: =Label_DisplayName_MAMenu_1.Color
                BorderThickness: =If(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName, 2, 0)
                DisabledFill: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(0,0,0,0)
                Height: =Parent.TemplateHeight - 2*Self.Y
                HoverFill: =RGBA(0,0,0,0)
                OnSelect: =Select(Label_DisplayName_MAMenu_1)
                PressedFill: =RGBA(105, 121, 126, 1)
                Width: =Parent.TemplateWidth - 2*Self.X
                X: =1
                Y: =1
                ZIndex: =1

            Icon_ProfileImage_MAMenu_1 As icon.Person:
                BorderColor: =RGBA(0, 0, 0, 0)
                Color: =RGBA(255, 255, 255, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                Fill: =RGBA(0,0,0,0)
                Height: =Image_ProfileImage_MAMenu_1.Height
                Icon: =Icon.Person
                OnSelect: =Select(Label_DisplayName_MAMenu_1)
                PaddingBottom: =12
                PaddingLeft: =12
                PaddingRight: =12
                PaddingTop: =12
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =Image_ProfileImage_MAMenu_1.Width
                X: =Image_ProfileImage_MAMenu_1.X
                Y: =Image_ProfileImage_MAMenu_1.Y
                ZIndex: =2

            Image_ProfileImage_MAMenu_1 As image:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Height: =Self.Width
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverFill: =RGBA(0, 0, 0, 0)
                Image: =If(!IsBlank(ThisItem.Id), 'Office365사용자'.UserPhotoV2(ThisItem.Id))
                OnSelect: =Select(Label_DisplayName_MAMenu_1)
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: =Gallery_AddUserSearch_MAMenu_1.TemplateHeight - 30
                X: =37
                Y: =(Gallery_AddUserSearch_MAMenu_1.TemplateHeight / 2) - (Self.Height/2)
                ZIndex: =3

            Label_DisplayName_MAMenu_1 As label:
                BorderColor: =Self.Color
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =Self.Size * 1.8
                OnSelect: |
                    =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                    /*
                    Concurrent(
                        Set(
                            selectedUser,
                            ThisItem
                        ),
                        Reset(TextSearchBox1_1),
                        If(
                            Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName) && Not(ThisItem.UserPrincipalName in LookUp(NewMACollect, ID=CheckedID, Users).Email),
                            Collect(
                                MyPeople,
                                ThisItem
                            );
                            Update( MyPeople, First( Filter( MyPeople, UserPrincipalName=ThisItem.UserPrincipalName ) ), 
                                { 
                                    Claims:"i:0#.f|membership|"& ThisItem.UserPrincipalName,
                                    Department:ThisItem.Department,
                                    DisplayName:ThisItem.DisplayName,
                                    UserPrincipalName:ThisItem.UserPrincipalName,
                                    JobTitle:ThisItem.JobTitle 
                                } 
                            )
                        )
                    );
                    */
                    If(
                        Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName) && Not(
                            ThisItem.UserPrincipalName in LookUp(
                                NewMACollect,
                                ID = CheckedID,
                                Users
                            ).Email
                        ),
                        Collect(
                            MyPeople,
                            ThisItem
                        );
                        Update(
                            MyPeople,
                            First(
                                Filter(
                                    MyPeople,
                                    UserPrincipalName = ThisItem.UserPrincipalName
                                )
                            ),
                            {
                                Claims: "i:0#.f|membership|" & ThisItem.UserPrincipalName,
                                Department: ThisItem.Department,
                                DisplayName: ThisItem.DisplayName,
                                UserPrincipalName: ThisItem.UserPrincipalName,
                                JobTitle: ThisItem.JobTitle
                            }
                        );
                        Set(UserAddPopup,true);,
                        Timer_AddUserComplete_MAMenu_1.Start = true,
                        Notify(
                            "사용자 추가 완료.",
                            NotificationType.Success,
                            800
                        ),
                       Set(UserAddPopup,false);,
                        Notify(
                            "중복된 이름입니다.",
                            NotificationType.Error,
                            800
                        )
                    );
                    
                    
                    
                    //Reset(TextSearchBox1_1);
                    //등록완료시 초기화
                Size: =12
                TabIndex: =0
                Text: =ThisItem.DisplayName
                Width: =Gallery_AddUserSearch_MAMenu_1.TemplateWidth - 232
                Wrap: =false
                X: =Image_ProfileImage_MAMenu_1.X + Image_ProfileImage_MAMenu_1.Width + 16
                Y: =16
                ZIndex: =4

            Label_UserPrincipalName_MAMenu_1 As label:
                Color: =RGBA(51, 51, 51, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                Height: =Self.Size * 1.8
                OnSelect: =Select(Label_DisplayName_MAMenu_1)
                Size: =12
                Text: =ThisItem.UserPrincipalName
                Width: =Label_DisplayName_MAMenu_1.Width
                Wrap: =false
                X: =Label_DisplayName_MAMenu_1.X
                Y: =Gallery_AddUserSearch_MAMenu_1.TemplateHeight - Self.Height - 20
                ZIndex: =5

            Separator_AdduserGallery_MAMenu_1 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                Fill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =6

            Icon_AddUser_MAMenu_1 As icon.Add:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Add
                OnSelect: =Select(Label_DisplayName_MAMenu_1)
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                X: =389
                Y: =11
                ZIndex: =7

        TextInput_AddUserSearch_MAMenu_1 As text:
            Align: =TextPosition.Left
            Default: =""
            Height: |
                =40
            HintText: ="검색"
            PaddingLeft: =70
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Visible: =If(MAMode="Add", EditUserVisibleVal, false)
            Width: =Gallery_AddUserSearch_MAMenu_1.Width
            X: =Rectangle_ComplateUserList_MAMenu_1.X + 10
            Y: =Rectangle_ComplateUserList_MAMenu_1.Y + 10
            ZIndex: =17

        Icon_AddUserSherch_MAMenu_1 As icon.Search:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(105, 121, 126, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =TextInput_AddUserSearch_MAMenu_1.Height-10
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Search
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =TextInput_AddUserSearch_MAMenu_1.Visible
            Width: =Self.Height
            X: =TextInput_AddUserSearch_MAMenu_1.X + 15
            Y: =TextInput_AddUserSearch_MAMenu_1.Y + 5
            ZIndex: =18

    Icon_OpenIncompleteSubMenuPopup_MAMenu_1 As icon.ZoomIn:
        BorderColor: =RGBA(166, 166, 166, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =40
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.ZoomIn
        OnSelect: =Set(SubMenuPopup,true);
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =36
        X: =1292
        Y: =134
        ZIndex: =36

    Group_AddUserComplete_MAMenu_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =44

        Rectangle_AddUserComplete_MAMenu_1 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =396
            Visible: =If(UserAddPopup = true,true,false)
            Width: =772
            X: =680
            Y: =252
            ZIndex: =32

        Label_AddUserCompleteName_MAMenu_1 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =172
            Size: =30
            Text: =Last(Filter(MyPeople,DisplayName = DisplayName,DisplayName)).DisplayName
            Visible: =If(UserAddPopup = true,true,false)
            Width: =192
            X: =856
            Y: =350
            ZIndex: =33

        Label_AddUserComplete_MAMenu_1 As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =172
            Size: =30
            Text: ="님 추가 완료"
            Visible: =If(UserAddPopup = true,true,false)
            Width: =359
            X: =1016
            Y: =350
            ZIndex: =34

        Timer_AddUserComplete_MAMenu_1 As timer:
            BorderColor: =RGBA(105, 121, 126, 1)
            BorderStyle: =BorderStyle.None
            DisabledBorderColor: =RGBA(244, 244, 244, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Duration: =1000
            Fill: =RGBA(105, 121, 126, 1)
            Font: =Font.'Segoe UI'
            Height: =70
            HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnTimerEnd: |-
                =Set(UserAddPopup, false); // Popup 컨트롤 숨기기
                Reset(Timer_AddUserComplete_MAMenu_1);
            OnTimerStart: =
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            Start: =If(UserAddPopup = true,true,false)
            Visible: =false
            X: =640
            Y: =10
            ZIndex: =35

    Button_ViewTeamMembers_MAMenu_1 As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(105, 121, 126, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
        OnSelect: |
            =Clear(
                        LookUp(
                        NewMACollect,
                        ID = CheckedID,
                        Teams
                    )
                );
            
            Set(Ok, false);
            Set(AddTeamPopup, false);
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =15
        Text: ="확인"
        Visible: =Ok
        X: =854
        Y: =723
        ZIndex: =48

    Button_MAMenuSAVEPatch_MAMenu_1 As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: |-
            =ColorValue("#0F6CBD")
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FocusedBorderThickness: =2
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =50
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: |-
            =ColorValue("#115EA3")
        OnSelect: |-
            =Patch(
                GNB_MENU,
                NewMACollect
            );
            Notify(
                    "저장완료.",
                    NotificationType.Success,
                    1000
                );
            ClearCollect(NewMACollect, ShowColumns(GNB_MENU,"Title","OData__x004c_V1","LV1Order","LV2Order","Users","ID","Teams"));
            ClearCollect(TeamMACollect,ShowColumns(GNB_MENU,"Title","OData__x004c_V1","LV1Order","LV2Order","Users","ID","Teams"));
            UpdateContext({ testHight:
                CountRows(
                ForAll(Distinct(SortByColumns(GNB_MENU, "LV1Order", SortOrder.Ascending), LV1), {Result: ThisRecord.Value})
            ) * 80 });
            //Select(TextInput4)
            Set(ZoomLV1, "");
            Set(testVisible, "");
            Set(SelectedLV1, "");
            Set(SelectedLV2, "");
        PaddingLeft: =40
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: |-
            =ColorValue("#0C3B5E")
        Size: =14
        Text: ="Save"
        Width: =113
        X: =1759
        Y: =26
        ZIndex: =49

    Group_IncompleteSubMenuPopup_MAMenu_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =49

        Rectangle_IncompleteSubMenuPopupMain_MAMenu_1 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            DisabledFill: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =535
            HoverFill: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            Visible: =SubMenuPopup
            Width: =506
            X: =831
            Y: =87
            ZIndex: =37

        "Gallery_IncompleteSubMenuPopup_MAMenu_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            BorderThickness: =1
            DelayItemLoading: =true
            Height: =442
            Items: =Filter(GNB_MENU, !IsBlank(LV2Order) && IsEmpty(Users) && LV1 <> "Admin")
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =Min(160, Self.Height - 60)
            Visible: =SubMenuPopup
            Width: =476
            X: =844
            Y: =163
            ZIndex: =38

            Separator_IncompleteSubMenuPopup_MAMenu_1 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                Fill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =5

            Label_IncompleteSubMenuName_MAMenu_1 As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =88
                OnSelect: =Select(Parent)
                Size: =18
                Text: |-
                    =//ThisItem.LV1& "  ===>  " & ThisItem.제목
                    ThisItem.제목
                Width: =427
                X: =24
                Y: =34
                ZIndex: =6

        Button_IncompleteSubMenuPopupCancel_MAMenu_1 As icon.Cancel:
            BorderColor: =RGBA(166, 166, 166, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =40
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Cancel
            OnSelect: =Set(SubMenuPopup, false)
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =If(SubMenuPopup = true,true,false)
            Width: =38
            X: =1282
            Y: =106
            ZIndex: =39

        Label_IncompleteSubMenuPopup_MAMenu_1 As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =30
            Size: =17
            Text: ="할당된 인원이 없는 메뉴 목록"
            Visible: =SubMenuPopup
            Width: =311
            X: =923
            Y: =111
            ZIndex: =40

    "'Image_MAMenuSave.MAMenu_1' As image":
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =30
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =IconSave
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =30
        X: =1774
        Y: =36
        ZIndex: =50

    Button_Refresh_MAMenu_1 As button:
        BorderColor: =RGBA(164, 170, 174, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: |-
            =ColorValue("#FFFFFF")
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FocusedBorderThickness: =2
        FontWeight: =FontWeight.Semibold
        Height: =50
        HoverBorderColor: |-
            =ColorValue("#C7C7C7")
        HoverColor: |-
            =ColorValue("#242424")
        HoverFill: |-
            =ColorValue("#F5F5F5")
        OnSelect: =Refresh(GNB_MENU);
        PaddingLeft: =50
        PaddingRight: =20
        PressedBorderColor: |-
            =ColorValue("#B3B3B3")
        PressedColor: =Color.Black
        PressedFill: |-
            =ColorValue("#E0E0E0")
        Size: =14
        Text: ="Refresh Table"
        Visible: |-
            =If(
                FullScreenMode,
                    false,
                Parent.Printing,
                    false,
                true
            )
        Width: =206
        X: =1502
        Y: =26
        ZIndex: =51

    Image_Refresh_MAMenu_1 As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =25
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =TokenMenuRefresh
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =25
        X: =1523
        Y: =38
        ZIndex: =52

    New_Component_GNB_MAMenu_1 As New_Component_GNB:
        ZIndex: =53

    Group_AddTeam_MAMenu_1 As group:
        Height: =5
        Width: =5
        X: =-713
        Y: =-180
        ZIndex: =56

        Rectangle_TeamPopUp_MAMenu_1 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =4
            Height: =580
            Visible: =AddTeamPopup
            Width: =494
            X: =811
            Y: =203
            ZIndex: =41

        Button_OKTeamPopUP_MAMenu_1 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |+
                =If(
                    MAMode = "Search",
                    Clear(
                            LookUp(
                            NewMACollect,
                            ID = CheckedID,
                            Users
                        )
                    );
                    Collect(
                        LookUp(
                            NewMACollect,
                            ID = CheckedID,
                            Users
                        ),
                        MyPeople
                    );
                    ,
                    MAMode = "Add",
                    Collect(
                        LookUp(
                            NewMACollect,
                            ID = CheckedID,
                            Users
                        ),
                        MyPeople
                    );
                    ,
                    MAMode = "TeamAdd",
                Collect(
                        LookUp(
                            NewMACollect,
                            ID = CheckedID,
                            Teams
                            //Users
                            
                        ),
                        MyPeople
                
                    );
                     
                
                    /*
                    UpdateContext({
                    MyColumnValue: MyPeople.UserPrincipalName // MyPeople 컬렉션의 특정한 열의 값을 변수에 저장
                });
                Collect(
                    NewMACollect,
                    {
                        ID: CheckedID,
                        Teams: MyColumnValue // 변수에 저장된 값을 NewMACollect 컬렉션의 Teams 열에 넣음
                    }
                )
                */
                );
                
                Set(
                    SelectedLV1,
                    ""
                );
                Set(
                    SelectedLV2,
                    ""
                );
                Set(
                    CheckedLV2,
                    ""
                );
                
                Set(
                    ZoomLV1,
                    "FFF"
                );
                Set(EditUserVisibleVal, false);
                Reset(TextInput_ShearchTeam_MAMenu_1);
                Set(AddTeamPopup,false);
                Refresh(GNB_MENU);
                
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="확인"
            Visible: |-
                =
                If(
                TextInput_ShearchTeam_MAMenu_1.Visible,
                true,
                false
                )
            X: =854
            Y: =723
            ZIndex: =42

        Button_CancelTeamPopUP_MAMenu_1 As button:
            BorderColor: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(244, 244, 244, 1)
            Fill: =RGBA(105, 121, 126, 1)
            FocusedBorderColor: =ColorFade(Self.Fill, -75%)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
            OnSelect: |-
                =Set(AddTeamPopup, false);
                Set(Ok, false);
                Reset(TextInput_ShearchTeam_MAMenu_1);
            PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =15
            Text: ="취소"
            Visible: =AddTeamPopup
            X: =1098
            Y: =723
            ZIndex: =43

        Gallery_ShearchTeamMembers_MAMenu_1 As gallery.SelectedUsersTabletGallery:
            AccessibleLabel: ="사용자가 사람을 선택함"
            BorderThickness: =1
            Height: =402
            Items: =MyPeople2
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =47
            Visible: =AddTeamPopup
            Width: =TextInput_ShearchTeam_MAMenu_1.Width
            X: =821
            Y: =237
            ZIndex: =44

            Rectangle_TeamMembers_MAMenu_1 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledFill: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(105, 121, 126, 1)
                FocusedBorderThickness: =4
                Height: =Parent.TemplateHeight
                HoverFill: =RGBA(105, 121, 126, 1)
                OnSelect: =Select(Parent)
                PressedFill: =RGBA(105, 121, 126, 1)
                Visible: |-
                    =If(
                    TextInput_ShearchTeam_MAMenu_1.Visible,
                    false,
                    true
                    )
                Width: =Parent.TemplateWidth
                ZIndex: =1

            Title_TeamMembers_MAMenu_1 As label:
                Color: =RGBA(255, 255, 255, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                Height: =Gallery_ShearchTeamMembers_MAMenu_1.TemplateHeight
                OnSelect: =Set(selectedUser, ThisItem)
                PaddingLeft: =10
                Size: =13
                TabIndex: =If(Gallery_ShearchTeam_MAMenu_1.Visible, -1, 0)
                Text: =ThisItem.DisplayName & " ( " & ThisItem.UserPrincipalName & " ) "
                Visible: |-
                    =If(
                    TextInput_ShearchTeam_MAMenu_1.Visible,
                    false,
                    true
                    )
                Width: =Gallery_ShearchTeamMembers_MAMenu_1.TemplateWidth - Icon_DeleteTeamMembers_MAMenu_1.Width + 10
                Wrap: =false
                ZIndex: =2

            Icon_DeleteTeamMembers_MAMenu_1 As icon.Cancel:
                AccessibleLabel: =Icon_DeleteTeamMembers_MAMenu_1.Tooltip
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =Title_TeamMembers_MAMenu_1.Color
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Height: =Gallery_ShearchTeamMembers_MAMenu_1.TemplateHeight
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Cancel
                OnSelect: =Remove(MyPeople2, LookUp(MyPeople2, UserPrincipalName = ThisItem.UserPrincipalName))
                PaddingBottom: =9
                PaddingLeft: =9
                PaddingRight: =9
                PaddingTop: =9
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                TabIndex: =If(Gallery_ShearchTeam_MAMenu_1.Visible, -1, 0)
                Tooltip: ="컬렉션에서 사용자를 제거하려면 선택"
                Visible: |-
                    =If(
                    TextInput_ShearchTeam_MAMenu_1.Visible,
                    false,
                    true
                    )
                Width: =Self.Height
                X: =Gallery_ShearchTeamMembers_MAMenu_1.TemplateWidth - Self.Width
                ZIndex: =3

        Gallery_ShearchTeam_MAMenu_1 As gallery.PeoplePickerTabletGallery:
            AccessibleLabel: ="사용자 찾기 검색 결과"
            BorderColor: =RGBA(166, 166, 166, 1)
            Fill: =Parent.Fill
            Height: =366
            Items: |+
                =Search(col_ADGroup,TextInput_ShearchTeam_MAMenu_1.Text,"description")
                
                
                
                /*If(
                    IsBlank(TextInput_ShearchTeam_MAMenu.Text),
                    Blank(),
                    If(
                        IsBlank(
                            Find(
                                ",",
                                TextInput_ShearchTeam_MAMenu.Text
                            )
                        ),
                        Search(
                            Departmentlist,
                            TextInput_ShearchTeam_MAMenu.Text,
                            "Value"
                        ),
                        Filter(
                            Departmentlist,
                            "Value" in Substitute(
                                Split(
                                    TextInput_ShearchTeam_MAMenu.Text,
                                    ","
                                ),
                                " ",
                                ""
                            )
                        )
                    )
                )*/
                
                
                
                
                
                /*
                 If(
                    IsBlank(txtUserSearch_1.Text),
                    Blank(),
                    If(
                        IsBlank(
                            Find(
                                ",",
                                txtUserSearch_1.Text
                            )
                        ),
                        Search(
                           Namelist,
                            txtUserSearch_1.Text,
                            "Department"
                        ),
                        Filter(
                            Namelist,
                            Department in Substitute(
                                Split(
                                    txtUserSearch_1.Text,
                                    ","
                                ),
                                " ",
                                ""
                            )
                        )
                    )
                )
                */
                
                
                
                
                /*
                If(
                    IsBlank(txtUserSearch_1.Text),
                    Blank(),
                    If(
                        IsBlank(
                            Find(
                                ",",
                                txtUserSearch_1.Text
                            )
                        ),
                        Search(
                           Namelist,
                            txtUserSearch_1.Text,
                            "Department"
                        ),
                        Filter(
                            Namelist,
                            Department in Substitute(
                                Split(
                                    txtUserSearch_1.Text,
                                    ","
                                ),
                                " ",
                                ""
                            )
                        )
                    )
                )
                */
                
                
                
                
                
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =87
            Visible: |-
                =If(
                TextInput_ShearchTeam_MAMenu_1.Visible,
                true,
                false
                )
            Width: =444
            X: =836
            Y: =273
            ZIndex: =45

            Rectangle_AddTeam_MAMenu_1 As rectangle:
                BorderColor: =Title_AddTeamName_MAMenu_1.Color
                BorderThickness: =//If(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName, 2, 0)
                DisabledFill: =RGBA(166, 166, 166, 1)
                Fill: =RGBA(0,0,0,0)
                Height: =Parent.TemplateHeight - 2*Self.Y
                HoverFill: =RGBA(0,0,0,0)
                OnSelect: =Select(Title_AddTeamName_MAMenu_1)
                PressedFill: =RGBA(105, 121, 126, 1)
                Width: =444
                Y: =1
                ZIndex: =1

            Title_AddTeamName_MAMenu_1 As label:
                BorderColor: =Self.Color
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =2
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =Self.Size * 1.8
                OnSelect: |
                    =If(
                        ThisItem.id in LookUp(
                            NewMACollect,
                            ID = CheckedID
                        ).Team_ID,
                        Notify(
                            "중복된 이름입니다.",
                            NotificationType.Error,
                            800
                        ),
                        Patch(
                            NewMACollect,
                            LookUp(
                                NewMACollect,
                                ID = CheckedID
                            ),
                            If(
                                IsBlank(
                                    LookUp(
                                        NewMACollect,
                                        ID = CheckedID
                                    ).Team_ID
                                ),
                                {Team_ID: ThisItem.id},
                                {
                                    Team_ID: Concat(
                                        Filter(
                                            NewMACollect,
                                            ID = CheckedID
                                        ),
                                        Team_ID & "," & ThisItem.id,
                                        ","
                                    )
                                }
                            )
                        );
                        Notify(
                            "사용자 추가 완료.",
                            NotificationType.Success,
                            800
                        )
                    )
                    
                    
                    /*If(
                        Not(ThisItem.Value in MyPeople.Department) && Not(
                            ThisItem.Value in LookUp(
                                NewMACollect,
                                ID = CheckedID,
                                Users
                            ).Email
                        ),
                        ClearCollect(
                            MatchingPeople,
                            Filter(
                                Namelist,
                                Department = ThisItem.Value
                            )
                        );
                        ForAll(
                            MatchingPeople,
                            If(
                                Not(UserPrincipalName in MyPeople.UserPrincipalName),
                                Collect(
                                    MyPeople,
                                    {
                              
                                    Claims: "i:0#.f|membership|" & UserPrincipalName,
                                    Department: Department,
                                    DisplayName: DisplayName,
                                    UserPrincipalName: UserPrincipalName,
                                    JobTitle: JobTitle
                                    }
                                );
                                //
                            )
                        );
                        //Set(UserAddPopup,true);,
                        //timerAddUser.Start = true,
                        Notify(
                            "사용자 추가 완료.",
                            NotificationType.Success,
                            800
                        ),
                       //Set(UserAddPopup,false);,
                        Notify(
                            "중복된 이름입니다.",
                            NotificationType.Error,
                            800
                        )
                    );
                    */
                Size: =12
                TabIndex: =0
                Text: =ThisItem.description
                Width: =Gallery_ShearchTeam_MAMenu_1.TemplateWidth - 232
                Wrap: =false
                X: =
                Y: =16
                ZIndex: =4

            Separator_AddTeam_MAMenu_1 As rectangle:
                BorderColor: =RGBA(0, 0, 0, 0)
                Fill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =6

            Icon_AddTeam_MAMenu_1 As icon.Add:
                BorderColor: =RGBA(166, 166, 166, 1)
                Color: =RGBA(105, 121, 126, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(220, 220, 220, 1)
                DisabledFill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =4
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                HoverFill: =RGBA(0, 0, 0, 0)
                Icon: =Icon.Add
                OnSelect: =Select(Title_AddTeamName_MAMenu_1)
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                PressedFill: =RGBA(0, 0, 0, 0)
                X: =357
                Y: =1
                ZIndex: =7

        TextInput_ShearchTeam_MAMenu_1 As text:
            Align: =TextPosition.Left
            Default: =""
            Height: =35
            HintText: ="검색"
            PaddingLeft: =70
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Visible: =If(MAMode="TeamAdd", AddTeamPopup, false)
            Width: =466
            X: =821
            Y: =213
            ZIndex: =46

        Icon_ShearchTeam_MAMenu_1 As icon.Search:
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =RGBA(105, 121, 126, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =TextInput_ShearchTeam_MAMenu_1.Height-10
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Search
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            Visible: =TextInput_ShearchTeam_MAMenu_1.Visible
            Width: =Self.Height
            X: =836
            Y: =218
            ZIndex: =47

