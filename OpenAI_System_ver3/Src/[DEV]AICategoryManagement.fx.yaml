"'[DEV]AICategoryManagement' As screen":
    BackgroundImage: =                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
    Fill: =RGBA(245, 245, 245, 1)
    LoadingSpinner: =LoadingSpinner.Data
    LoadingSpinnerColor: =RGBA(105, 121, 126, 1)
    OnVisible: |-
        =Concurrent(
        Set(AddPopUpBackground,false);,
        UpdateContext({ AddPopUp:false });,
        UpdateContext({lookUserVi:false});,
        UpdateContext({AddTeamPopUpVi: false});,
        UpdateContext({lookTeamVi:false});,
        UpdateContext({testV:""}),
        UpdateContext({AddMianCategory: false}),
        UpdateContext({HisVi:false}),
        Set(CategoryPopup, false);
        );
        
        ClearCollect(
            CategoryTable,
            ShowColumns(
                똑실이_Category_table,
                "Title",
                "Category_LV1",
                "Category_LV2",
                "LV1Order",
                "LV2Order",
                "Users",
                "ID",
                "History",
                "Teams",
                "FileCount",
                "DocumentLanguage",
                "Author"
            )
        );
        Clear(delCate);
        
        ClearCollect(
            Groups,
            ForAll(
                Table(ParseJSON('똑실이-[Apps]오피스365그룹검색'.Run("").output)),
                {
                    id: ThisRecord.Value.id,
                    mail: Text(ThisRecord.Value.mail),
                    displayName: Text(ThisRecord.Value.displayName),
                    securityEnabled: Text(ThisRecord.Value.securityEnabled)
                }
            )
        );

    Component_Container_AICM As Component_Container:
        Height: =870
        Width: =1549
        X: =348
        Y: =198

    Button_Refresh_CategoryMenu_AICM As button:
        BorderColor: |-
            =ColorValue("#D1D1D1")
        BorderThickness: =1
        Color: =RGBA(0, 0, 0, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: |-
            =ColorValue("#FFFFFF")
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FocusedBorderThickness: =2
        FontWeight: =FontWeight.Semibold
        HoverBorderColor: |-
            =ColorValue("#C7C7C7")
        HoverColor: |-
            =ColorValue("#242424")
        HoverFill: |-
            =ColorValue("#F5F5F5")
        OnSelect: |-
            =Refresh(똑실이_Category_table);
            
            ClearCollect(
                CategoryTable,
                ShowColumns(
                    똑실이_Category_table,
                    "Title",
                    "Category_LV1",
                    "Category_LV2",
                    "LV1Order",
                    "LV2Order",
                    "Users",
                    "ID",
                    "History",
                    "Teams",
                    "FileCount",
                    "DocumentLanguage"
                )
            );
        PaddingLeft: =30
        PressedBorderColor: |-
            =ColorValue("#B3B3B3")
        PressedColor: =Color.Black
        PressedFill: |-
            =ColorValue("#E0E0E0")
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Size: =11
        Text: ="새로고침"
        Width: =121
        X: =1735
        Y: =35
        ZIndex: =3

    Label_CategoryMenuTitle_CategoryMenu_AICM As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        FontWeight: =FontWeight.Bold
        Height: =64
        Size: =30
        Text: ="AI 카테고리 관리"
        Width: =393
        X: =343
        Y: =23
        ZIndex: =4

    Button_CategoryMenuSAVEPatch_CategoryMenu_AICM As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: |-
            =ColorValue("#0F6CBD")
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FocusedBorderThickness: =2
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: |-
            =ColorValue("#115EA3")
        OnSelect: |-
            =ClearCollect(CategoryTable_Update,
                ForAll(CategoryTable,
                    {   Title:".",
                        ID: If(ID in 똑실이_Category_table.ID, ThisRecord.ID, Blank()),
                        History: ThisRecord.History,
                        LV1Order:ThisRecord.LV1Order,
                        LV2Order:ThisRecord.LV2Order,
                        Category_LV1:Trim(ThisRecord.Category_LV1),
                        Category_LV2:Trim(ThisRecord.Category_LV2),
                        Users:ThisRecord.Users,
                        Teams:ThisRecord.Teams,
                        DocumentLanguage:ThisRecord.DocumentLanguage
                        //Author:ThisRecord.Author
                    }
                )
            );
            
            //Filter(CategoryTable,Not(ID in Category_table.ID), Patch(CategoryTable, Defaults(CategoryTable), {ID:Blank()}));
            If(
                CountRows(
                    Filter(
                        CategoryTable,
                        Category_LV2 = "" || Category_LV2 = Blank()
                    )
                ) > 0,
                Notify(
                    "이름을 지정하지 않은 하위 메뉴가 있습니다.",
                    NotificationType.Error,
                    5000
                ),
                Patch(
                    똑실이_Category_table,
                    CategoryTable_Update
                );
                RemoveIf(똑실이_Category_table, ID in delCate.ID);
                Notify(
                    "저장하였습니다.",
                    NotificationType.Success,
                    5000
                );
            );
            Clear(delCate);
            ClearCollect(
                CategoryTable,
                ShowColumns(
                    똑실이_Category_table,
                    "Title",
                    "Category_LV2",
                    "Category_LV1",
                    "LV1Order",
                    "LV2Order",
                    "Users",
                    "ID",
                    "History",
                    "Teams",
                    "DocumentLanguage",
                    "Author"
                )
            );
            //Patch(Category_table,CategoryTable)
        PaddingLeft: =40
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: |-
            =ColorValue("#0C3B5E")
        Size: =14
        Text: ="Save"
        Visible: =false
        Width: =121
        X: =1751
        Y: =36
        ZIndex: =5

    Image_CategoryMenuSAVEPatch_CategoryMenu_AICM As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =25
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =IconSave
        OnSelect: =Select(Button_CategoryMenuSAVEPatch_CategoryMenu_AICM)
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Visible: =false
        Width: =25
        X: =1774
        Y: =44
        ZIndex: =6

    New_Component_GNB_CategoryMenu_AICM As New_Component_GNB:
        ZIndex: =7

    Image_Refresh_CategoryMenu_AICM As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =20
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: =TokenMenuRefresh
        OnSelect: =Select(Button_Refresh_CategoryMenu_AICM)
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =20
        X: =1752
        Y: =46
        ZIndex: =35

    Component_Container_Search_AICM As Component_Container:
        Height: =108
        Width: =1549
        X: =348
        Y: =104
        ZIndex: =76

    Label_SearchCategory_AICM As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =33
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Text: ="카테고리"
        Width: =90
        X: =403
        Y: =142
        ZIndex: =79

    Dropdown_SearchCategoryLV1_AICM As dropdown:
        BorderColor: =RGBA(166, 166, 166, 1)
        ChevronBackground: =RGBA(255, 255, 255, 1)
        ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
        ChevronDisabledFill: =RGBA(166, 166, 166, 1)
        ChevronFill: =RGBA(33, 33, 33, 1)
        ChevronHoverBackground: =RGBA(212, 212, 212, 1)
        ChevronHoverFill: =RGBA(33, 33, 33, 1)
        Color: =RGBA(51, 51, 51, 1)
        Default: =DEFAULT_CATEGORY_VALUE
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Font: =Font.'Segoe UI'
        Height: =32
        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        HoverColor: =RGBA(51, 51, 51, 1)
        HoverFill: =RGBA(212, 212, 212, 1)
        Items: |-
            =Distinct(
                    SortByColumns(
                        똑실이_Category_table,
                        "LV1Order",
                        SortOrder.Ascending
                    ),
                    Category_LV1
                )
        PaddingBottom: =5
        PaddingLeft: =12
        PaddingRight: =5
        PaddingTop: =5
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(105, 121, 126, 1)
        SelectionFill: =RGBA(105, 121, 126, 1)
        Size: =13
        Width: =240
        X: =493
        Y: =142
        ZIndex: =80

    Dropdown_SearchCategoryLV2_AICM As dropdown:
        BorderColor: =RGBA(166, 166, 166, 1)
        ChevronBackground: =RGBA(255, 255, 255, 1)
        ChevronDisabledBackground: =RGBA(244, 244, 244, 1)
        ChevronDisabledFill: =RGBA(166, 166, 166, 1)
        ChevronFill: =RGBA(33, 33, 33, 1)
        ChevronHoverBackground: =RGBA(212, 212, 212, 1)
        ChevronHoverFill: =RGBA(33, 33, 33, 1)
        Color: =RGBA(51, 51, 51, 1)
        Default: =DEFAULT_CATEGORY_VALUE
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Font: =Font.'Segoe UI'
        Height: =32
        HoverBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        HoverColor: =RGBA(51, 51, 51, 1)
        HoverFill: =RGBA(212, 212, 212, 1)
        Items: |-
            =If(
                Dropdown_SearchCategoryLV1_AICM.Selected.Value = DEFAULT_CATEGORY_VALUE,
                Distinct(
                    SortByColumns(
                        똑실이_Category_table,
                        "LV2Order",
                        SortOrder.Ascending
                    ),
                    Category_LV2
                )
                ,
                Distinct(
                    SortByColumns(
                        Filter(
                            똑실이_Category_table,
                            Dropdown_SearchCategoryLV1_AICM.Selected.Value = Category_LV1 Or DEFAULT_CATEGORY_VALUE = Category_LV1
                        ),
                        "LV2Order",
                        SortOrder.Ascending
                    ),
                    Category_LV2
                )
            )
        PaddingBottom: =5
        PaddingLeft: =12
        PaddingRight: =5
        PaddingTop: =5
        PressedBorderColor: =ColorFade(RGBA(105, 121, 126, 1), -30%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(105, 121, 126, 1)
        SelectionFill: =RGBA(105, 121, 126, 1)
        Size: =13
        Width: =240
        X: =776
        Y: =142
        ZIndex: =81

    Label_SearchCategoryArrow_AICM As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 18, 107, 1)
        Color: =RGBA(0, 0, 0, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Font: =Font.'Segoe UI'
        Height: =47
        PaddingLeft: =0
        PaddingRight: =0
        Text: =">"
        Width: =43
        X: =733
        Y: =132
        ZIndex: =82

    Gallery_AICategory_TopSystem_AICM As gallery.galleryVertical:
        BorderColor: =RGBA(166, 166, 166, 1)
        DelayItemLoading: =true
        Height: =834
        Items: |-
            =//Sort(Distinct(Filter(똑실이_Category_table, CategoryType = "system"), Category_LV1),Value)
            Distinct(
                Sort(
                    똑실이_Category_table,
                    LV1Order,
                    SortOrder.Ascending
                ),
                Category_LV1
            )
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        ShowScrollbar: =false
        TemplateSize: =206
        Width: =1490
        X: =375
        Y: =217
        ZIndex: =84

        lbl_TitleType_AICategory_AICM As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =42
            OnSelect: =Select(Parent)
            Size: =15
            Text: =ThisItem.Value
            Width: =500
            X: =57
            Y: =18
            ZIndex: =1

        lbl_TitleAnswerModel_AICategory_AICM As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            OnSelect: =Select(Parent)
            Size: =15
            Text: ="답변모델"
            X: =626
            Y: =18
            ZIndex: =2

        lbl_TitleAnswerMode_AICategory_AICM As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            OnSelect: =Select(Parent)
            Size: =15
            Text: ="답변방식"
            X: =893
            Y: =18
            ZIndex: =3

        lbl_TitleChatMode_AICategory_AICM As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            OnSelect: =Select(Parent)
            Size: =15
            Text: ="지원기능"
            Visible: =If(lbl_TitleType_AICategory_AICM.Text = "AI Worker", true, false)
            X: =1150
            Y: =18
            ZIndex: =4

        lbl_TitleValue_DocumentLanguage_AICategory_AICM_1 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            OnSelect: =Select(Parent)
            Size: =15
            Text: ="원본지원언어"
            Visible: =If(lbl_TitleType_AICategory_AICM.Text <> "AI Worker", true, false)
            X: =1150
            Y: =18
            ZIndex: =5

        Gallery_AICategory_SubSystem_AICM As gallery.galleryVertical:
            BorderColor: =RGBA(166, 166, 166, 1)
            DelayItemLoading: =true
            Height: =148
            Items: =Filter(똑실이_Category_table, CategoryType = "system")
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplateSize: =60
            Width: =1376
            X: =24
            Y: =58
            ZIndex: =6

            btn_Background_Color_AnswerModel_AICM As button:
                BorderColor: =RGBA(0, 0, 0, 0)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =RGBA(249, 194, 255, 1)
                FocusedBorderColor: =ColorFade(Self.Fill, -75%)
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =lbl_SubSystem_AnswerModel_AICategory_AICM.Height
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =ColorFade(RGBA(105, 121, 126, 1), -10%)
                OnSelect: =
                PressedBorderColor: =
                PressedColor: =
                PressedFill: =
                Size: =15
                Text: =""
                Width: =lbl_SubSystem_AnswerModel_AICategory_AICM.Width
                X: =lbl_SubSystem_AnswerModel_AICategory_AICM.X
                Y: =lbl_SubSystem_AnswerModel_AICategory_AICM.Y
                ZIndex: =1

            lbl_SubSystem_ChatMode_AICategory_AICM As label:
                Align: =Align.Center
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =56
                OnSelect: =Select(Parent)
                Size: =13
                Text: |-
                    =Substitute(
                        Substitute(
                            Substitute(
                                ThisItem.ChatMode,
                                "openai_answer",
                                "OpenAI"
                            ),
                            "bing_search",
                            "Bing"
                        ),
                        "document_answer",
                        "내부문서"
                    )
                Visible: =If(lbl_TitleType_AICategory_AICM.Text = "AI Worker", true, false)
                Width: =171
                X: =1112
                Y: =3
                ZIndex: =2

            lbl_SubSystem_LV2_AICategory_AICM As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =56
                OnSelect: =Select(Parent)
                Size: =13
                Text: =ThisItem.Category_LV2
                Width: =500
                X: =31
                Y: =3
                ZIndex: =3

            lbl_SubSystem_AnswerModel_AICategory_AICM As label:
                Align: =Align.Center
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =56
                OnSelect: =Select(Parent)
                Size: =13
                Text: |
                    =Substitute(
                        Substitute(
                            ThisItem.AnswerModel, 
                            "chat_gpt4", 
                            "GPT-4"
                        ),
                        "chat", 
                        "GPT-3.5"
                    )
                X: =594
                Y: =4
                ZIndex: =4

            lbl_SubSystem_AnswerMode_AICategory_AICM As label:
                Align: =Align.Center
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =56
                OnSelect: =Select(Parent)
                Size: =13
                Text: |-
                    =Substitute(
                        Substitute(
                            ThisItem.AnswerMode, 
                            "generative", 
                            "생성형"
                        ),
                        "retrieval", 
                        "정해진답변"
                    )
                Width: =143
                X: =865
                Y: =4
                ZIndex: =5

            lbl_SubSystem_DocumentLanguage_AICategory_AICM As label:
                Align: =Align.Center
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(51, 51, 51, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                Height: =56
                OnSelect: =Select(Parent)
                Size: =13
                Text: |-
                    =Substitute(
                        Substitute(
                            Substitute(
                                Substitute(
                                    ThisItem.DocumentLanguage,
                                    "ko",
                                    "한국어"
                                ),
                                "en",
                                "English"
                            ),
                            "ja",
                            "日本語"
                        ),
                        "vector",
                        "다국어"
                    )
                Visible: =If(lbl_TitleType_AICategory_AICM.Text <> "AI Worker", true, false)
                Width: =171
                X: =1112
                Y: =4
                ZIndex: =6

